\documentclass[12pt,a4paper,openany,aps,pra]{book}
\usepackage{graphicx}
\usepackage{gensymb}
\usepackage{longtable}
\usepackage{epsfig}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{anysize}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
%\usepackage[polish]{babel}
\usepackage{amsmath}
\usepackage[urlcolor=blue,colorlinks=true,citecolor=blue,linkcolor=blue,pdfstartview={FitH},bookmarks=false]{hyperref}
\def\mb{\bm}
\usepackage[left=2cm,right=2cm,top=3cm,bottom=3cm]{geometry}
\DeclareMathOperator{\Tr}{Tr}


\begin{document}


\begin{titlepage}
	\centering
	{\Large\scshape Przemys\l{}aw Piekarz\par}
    \vspace{4cm}
	{\scshape\bfseries\Huge Ab initio methods\par}
	\vspace{1cm}
	{\scshape\bfseries\Huge in solid state physics\par}	
	\vfill
	{\scshape\large Department of Computational Materials Science \\ Institute of Nuclear Physics \\ Polish Academy of Sciences\par}
\end{titlepage}

\newpage
\thispagestyle{empty}
%\thispagestyle{plain} % empty
\mbox{}

\tableofcontents


\chapter*{Introduction}
\addcontentsline{toc}{chapter}{Introduction}  

First principles calculation methods, also called {\it ab initio} methods, are based on the laws of quantum mechanics.
The application of the Schr\"{o}dinger equation~\cite{Schrodinger} to atoms and molecules enabled to explain the basis properties of orbitals and chemical bonds~\cite{HL,hartree28,mulliken,JC}. 
Many-electron systems, such as atoms, molecules and solids, are subject to Fermi-Dirac statistics~\cite{fermi26,Dirac26}, which is a direct consequence of the Pauli exclusion principle~\cite{Pauli25}.
Application of quantum statistics to a homogeneous electron gas, which is the simplest model of the metallic state,
made it possible to explain the problems of the classical Drude-Lorentz theory of conductivity.
The band theory of periodic systems, which arose thanks to the works of Bloch~\cite{Bloch}, Peierls~\cite{peierls} and Wilson~\cite{Wilson},
explained the significant differences in the electrical conductivity of materials and created the basis for dividing all crystals into metals, insulators and semiconductors.

Due to many-body interactions occurring in electronic systems, the Schr\"{o}dinger equation
cannot be solved accurately, and therefore approximate methods are needed.
One of the first approaches to quantitative calculations was the Hartree \cite{hartree28} approximation,
where the wave function is given as a product of single-particle functions.
In the single-particle model, the interaction of electrons is replaced by an effective potential,
in which each electron moves. This potential is composed of the attractive interaction generated by atomic nuclei
and from the repulsive part coming from the remaining electrons.
Since the electronic part of the potential depends on the wave functions we want to obtain,
the Schr\"{o}dinger equation must be solved in a self-consistent manner.
Taking into account the Pauli exclusion principle for the multi-electron wave function, which in its simplest form is written
is in the form of the Slater determinant, the Hartree-Fock equation can be derived~\cite{fock30,slater30,slater51}.
In this equation, in addition to the usual Coulomb interaction, there is a non-local
exchange interaction. This is an interaction that occurs only between electrons with parallel spins,
effectively reducing the Coulomb repulsion between them.
The Hartree-Fock approach describes electron systems approximately because it does not properly take into account correlations,
which occur in the many-electron quantum state \cite{wigner34,GB}.
This is also related to improper screening of Coulomb interactions,
which leads to significantly overestimated values of the energy gap in solids.
Methods based on the Hartree-Fock approach, the so-called multi-determinant methods, correctly take into account electronic correlations, but require time-consuming computer calculations. They are mainly used in quantum chemistry to study molecular systems.

The first calculations of the electronic structure of metals used methods in which independent electrons interact
with periodic atomic potential.
In the cell method, proposed by Wigner and Seitz~\cite{wigner33}, the crystal potential is the sum of
spherically symmetric potentials generated by each atom.
Using Bloch's theorem, all we need to do is find solutions to the Schr\"{o}dinger equation
in a single primitive cell, with appropriate boundary conditions at the cell boundary.
In 1937, Slater introduced the augmented plane wave (APW) method. In this approach, the entire crystal is divided
to the areas around the atomic positions (defined by the radius of the atomic sphere) and the remaining interstitial part.
In each of these areas, a different form of the wave function is used. Inside the atomic spheres, the potential changes rapidly and
wave functions, which behave similarly to atomic orbitals, are calculated in the basis of spherical harmonics.
However, in the interstitial area, both the potential and wave functions are slowly changing, and the natural basis are plane waves.
Additionally, the condition of continuity at the border of areas must be met.
In another approach, proposed by Korring~\cite{K47} and Kohn and Rostoker~\cite{KR54},
Green's functions 
and scattering theory are used to determine electronic states in the crystal.
The main drawback of these methods was the approximate nature of the electronic potential.
The most frequently used potential was the {\it muffin-tin} type, which has spherical symmetry in the area of the atomic core,
and outside it takes a constant value.
A step forward was the orthogonalized plane wave (OPW) approach proposed by Herring~\cite{herring40}, which became
the basis of the pseudopotential method~\cite{Antoncik,KP}.
In this approach, the exact atomic potential is replaced by an approximate pseudopotential, having a finite value in the region of the atomic core,
which allows the calculation of an approximate wave function (pseudo wave function) in the basis of plane waves in the entire crystal region.
 
The real breakthrough was the formulation of density functional theory (DFT) by Hohenberg, Kohn and Sham~\cite{kohn64,kohn65}.
The basic theorem of this theory says that the total energy of a given system,
taking into account exchange and correlation interactions, is a functional
of electron density, which can be determined by minimizing the ground state energy.
In practical applications, the electron density is determined from single-particle wave functions, calculated as
self-consistent by solving the Kohn-Sham equation.
The exact values of the exchange-correlation potential are not known and must be determined within known approximations.
The basic approach is the local density approximation (LDA),
in which the exchange and correlation energies are obtained from accurate calculations for a homogeneous electron gas \cite{CeperleyAlder80,PZ,VWN}.
The next step was to account for non-local effects within the generalized gradient approximation
(GGA) \cite{Langreth83,Pardew86,Becke88}.
Since the formulation of DFT, many methods have been proposed to solve the Kohn-Sham equations, such as
the method of associated plane waves \cite{Andersen75}, or approaches based on pseudopotentials \cite{HSC,BHS,Vanderbilt90}.
Thanks to these improvements, density functional theory became the basis for calculating electronic structure~\cite{jones}, determining crystal parameters~\cite{payne}, studying lattice dynamics~\cite{parlinski, baroni} and many other material properties~\cite {martin}.
For its formulation, Walter Kohn received the Nobel Prize in Chemistry in 1998.

% **[REVIEW NEEDED]**: Technical terminology for DFT approximations and strongly correlated systems
However, there are systems in which the approximations used in DFT break down and fail to correctly
describe the electronic structure. According to classical band theory, many transition metal oxides, such as NiO or MnO,
should be in a metallic state, due to the partial filling of $3d$ states.
These materials are actually insulators, because the strong Coulomb interaction in the $3d$ states
prevents the free movement of electrons and leads to their localization \cite{peierls}.
In contrast to band insulators, these materials are called Mott insulators \cite{mott}.
Such local electron interaction, described within the Hubbard model by the parameter $U$ \cite{hubbard},
is much stronger in $d$ and $f$ states than in the more extended (delocalized) $s$ and $p$ states.
The electronic structure of transition metal oxides, determined within LDA or GGA calculations,
either has no gap (CoO) or the gap is significantly underestimated (NiO) \cite{terakura}.
Too small an energy gap is also a problem in calculations for classical semiconductors,
such as silicon or germanium, which means that the exchange-correlation potential is not
well described in these materials either.

% **[REVIEW NEEDED]**: Self-interaction correction terminology and hybrid functional description
The basic approximations used to determine the exchange-correlation energy are a source of errors that effectively lead to electron self-interaction.
This effect is particularly strong for $d$ or $f$ states and leads to an unfavorable increase in energy upon electron localization.
This is the main reason for the incorrect metallic state or too small energy gap obtained
in calculations for transition metal oxides.  
One method for correcting this effect (SIC) \cite{PZ} consists of directly calculating
the self-interaction energy and subtracting it from the total energy functional.
This method enables improvement of the electronic structure, but is not easy to implement in self-consistent calculations.
The electronic state can also be improved by using hybrid functionals, in which the approximate exchange energy is partially
replaced by the exact value obtained within the Hartree-Fock method \cite{becke93}.
This stems from the fact that in the Hartree-Fock approximation there is no self-interaction effect.
  
% **[REVIEW NEEDED]**: LDA+U method description and advanced many-body methods  
The electronic potential for localized states can also be improved by adding to the DFT functional
an additional term proportional to the interaction energy $U$. This can be done in the mean-field
approximation within the LDA+U method \cite{anisimov}. Application of this method to transition metal oxides \cite{anisimov}
or high-temperature superconductors \cite{czyzyk} has significantly improved their electronic structure 
and magnetic properties compared to standard DFT calculations.
Also in the case of other complex materials, in which interactions between spin, orbital,
and lattice degrees of freedom occur, this approach gives qualitatively better results \cite{orbital1,orbital2,orbital3}.
In strongly correlated metals, such as rare earths and actinides,
the LDA+U method allows only partial inclusion of effects related to electron localization.
A good example is plutonium crystal, where the very large discrepancy between the theoretically calculated
volume and the experimental value (about 35\%) can be corrected using
a realistic value of the parameter $U$\cite{Pu-LDAU}.
Unfortunately, dynamic effects such as fluctuation of magnetic moments in the paramagnetic state, or the Kondo effect
cannot be correctly described at the level of mean-field theory.
In the more advanced dynamical mean-field theory (DMFT) method, many-body effects
are included by solving the Anderson impurity model using exact diagonalization
or quantum Monte Carlo \cite{Georges}. The solutions contain information about the self-energy and lifetime
of electronic states, which are not available within DFT calculations.
The quantum Monte Carlo method itself is currently being developed very intensively and is used for calculations
of the electronic structure of molecules and crystalline systems.


\chapter{Electron interactions}

\section{Basic properties}

% **[REVIEW NEEDED]**: Fundamental quantum mechanics terminology - electromagnetic interactions and Hamiltonian description
Among all interactions that occur in nature, the decisive factors for the physical and chemical properties of atomic systems
are electromagnetic interactions. 
Interatomic bonds, which give rise to molecules and solids, 
are the result of mutual electrostatic interactions in the system of electrons and atomic nuclei.
The Hamiltonian, which describes an arbitrary system of atoms, has the form
%
\begin{equation}
H=-\frac{\hbar^2}{2m}\sum_{i}\nabla_i^2-\sum_{i,j} \frac{Z_{j}e^2}{|\bm{r}_i-\bm{R}_j|}+\frac{1}{2}\sum_{i\neq j}\frac{e^2}{|\bm{r}_i-\bm{r}_j|}
-\sum_j \frac{\hbar^2}{2M_j}\nabla_j^2 -\frac{1}{2}\sum_{i\neq j} \frac{Z_iZ_je^2}{|\bm{R}_i-\bm{R}_j|},
\label{hamiltonian}
\end{equation}
%
where $\bm{r}_i$ denote the positions of electrons, $\bm{R_j}$ the positions of atomic nuclei, $Z_j$ the nuclear charges, $M_j$ the nuclear masses, and $m$ is the electron mass.
The first three terms describe respectively the kinetic energy of electrons, the interaction of electrons with nuclei, and the interactions
between electrons. The last two terms are the kinetic energy of atomic nuclei and the interaction between
nuclear charges. The complete wave function of the complex system of electrons and atomic nuclei $\Psi(\bm{r}_i,\bm{R}_j)$ satisfies the Schr\"{o}dinger equation
%
\begin{equation}
H\Psi(\bm{r}_i,\bm{R}_j) = E\Psi(\bm{r}_i,\bm{R}_j),
\label{Sch}
\end{equation}
%
where $E$ is the total energy of the system.

% **[REVIEW NEEDED]**: Born-Oppenheimer approximation description and adiabatic treatment
The quantum-mechanical description of a crystal can be simplified by exploiting the large ratio of the atomic nuclear mass to the electron mass,
which for the lightest nucleus, hydrogen, equals $m_p/m_e=1836$.
This causes the dynamics of electrons to be much faster than that of atomic nuclei, and electronic states adjust very quickly (adiabatically)
to the current positions of atoms. Typical energies associated with electron motion are on the order of 1 eV, whereas average atomic vibration energies
in crystals are at the level of 10 meV. 
Thus, in the first approximation, we can solve the Schr\"{o}dinger equation for the electronic subsystem at fixed atomic positions and
neglect the influence of quantum features of atomic dynamics on electronic wave functions.
This approach is called the adiabatic approximation or the Born-Oppenheimer approximation \cite{BO}.
Introducing the wave function of the entire system as a product of the electronic function $\Phi(\bm{r_i},\bm{R_j})$ and the nuclear function $\chi(\bm{R}_j)$
%
\begin{equation}
\Psi(\bm{r}_i,\bm{R}_j) = \Phi(\bm{r}_i,\bm{R}_j)\chi(\bm{R}_j)
\label{wave}
\end{equation}
%
one can separate (\ref{Sch}) into two equations 
%
\begin{equation}
(-\frac{\hbar^2}{2m}\sum_{i=1}^N \nabla_i^2-\sum_{i,j} \frac{Z_{j}e^2}{|\bm{r}_i-\bm{R}_j|}+\frac{1}{2}\sum_{i\neq j}
\frac{e^2}{|\bm{r}_i-\bm{r}_j|})\Phi(\bm{r}_i,\bm{R}_j)=E_n(\bm{R}_j)\Phi(\bm{r}_i,\bm{R}_j),
\label{Sch-el}
\end{equation}
%
\begin{equation}
(-\sum_j \frac{\hbar^2}{2M_j} \nabla_j^2 -\sum_{i,j} \frac{Z_iZ_je^2}{|\bm{R}_i-\bm{R}_j|}+E_n(\bm{R}_j))\chi_{n\alpha}(\bm{R}_j)=\varepsilon_{n\alpha}\chi_{n\alpha}(\bm{R}_j).
\end{equation}
%
The first equation describes the wave functions and eigenvalues $E_n(\bm{R}_j)$ of the electronic system at fixed positions of atomic nuclei, where $n$ denotes a defined set of quantum numbers of the electronic state. From the second equation we can obtain the wave functions and eigenvalues $\varepsilon_{n\alpha}$ associated with the motion of atomic nuclei,
where $\alpha$ is a quantum number that characterizes these quantities. The potential energy in the equation describing the motion of atomic nuclei depends on the mutual interaction between nuclei and on the energy of the electronic subsystem $E_n(\bm{R}_j)$. Both quantities are functions of the current positions of all atomic nuclei.  

Let us write the wave function of a system of $N$ electrons, at fixed positions of atomic nuclei, in the form $\Phi(\bm{r}_1,\bm{r}_2,...,\bm{r}_N)$. 
Knowledge of the wave function allows us to determine many basic physical quantities for a given system. In particular, the electron density at point $\bm{r}$
is given by the formula
%
\begin{equation}
n(\bm{r})=N\int d\bm{r}_2...d\bm{r}_N \Phi^*(\bm{r},\bm{r}_2,...,\bm{r}_N) \Phi(\bm{r},\bm{r}_2,...,\bm{r}_N).
\end{equation}
%
% **[REVIEW NEEDED]**: Pauli exclusion principle and fermion antisymmetry
The fundamental property of the electronic wave function is its antisymmetry. This means that exchanging the positions of two electrons causes a sign change
%
\begin{equation}
\Phi(\bm{r}_1,\bm{r}_2,...,\bm{r}_i,...,\bm{r}_j,...,\bm{r}_N)=-\Phi(\bm{r}_1,\bm{r}_2,...,\bm{r}_j,...,\bm{r}_i,...,\bm{r}_N).
\label{anty}
\end{equation}
%
This property follows from the Pauli exclusion principle, which states that two fermions (i.e., particles with half-integer spin) cannot occupy the same quantum state - a state described by the same set of quantum numbers.

% **[REVIEW NEEDED]**: Hydrogen molecule example - Heitler-London method terminology
The Schr\"{o}dinger equation (\ref{Sch-el}) contains many-body interactions and has no exact analytical solutions, except for the hydrogen atom or other one-electron systems. Exact numerical solutions of the Schr\"{o}dinger equation can be obtained only for individual atoms and small molecules.
As an example, let us consider a simple system with two electrons, which is the hydrogen molecule H$_2$.
The Hamiltonian of this system, after including the Born-Oppenheimer approximation, takes the form
%
\begin{equation}
H=-\frac{\hbar^2}{2m}\nabla_1^2-\frac{\hbar^2}{2m}\nabla_2^2-\frac{e^2}{r_{1A}}-\frac{e^2}{r_{1B}}-\frac{e^2}{r_{2A}}-\frac{e^2}{r_{2B}}+\frac{e^2}{r_{12}}+\frac{e^2}{r_{AB}},
\end{equation}
%  
where $r_{1A}$, $r_{1B}$, $r_{2A}$, $r_{2B}$ denote the distances of electrons (1 and 2) from the two protons ($A$ and $B$), $r_{12}$ is the distance between electrons,
and $r_{AB}$ is the distance between protons. 
In 1927, Heitler and London proposed a wave function in the form \cite{HL}
%
\begin{equation}
\Phi(\bm{r}_1,\bm{r}_2)=N_{\pm}[\psi_A(\bm{r}_1)\psi_B(\bm{r}_2)\pm \psi_B(\bm{r}_1)\psi_A(\bm{r}_2)]\chi_{\sigma},
\end{equation}
%
where $N_{\pm}$ is the normalization factor, $\chi_{\sigma}$ is the spin part of the wave function, and the four functions $\psi_{\alpha}(\bm{r})$
are $1s$ orbitals for the ground state of the hydrogen atom
%
\begin{equation}
\psi_{\alpha}(\bm{r})=\frac{1}{\sqrt{\pi a_0^3}}e^{-\frac{|\bm{r}-\bm{r}_{\alpha}|}{a_0}},
\end{equation}
where $a_0$ is the Bohr radius, and $\bm{r}_{\alpha}$ is the position of proton $\alpha=A$ or $B$.
Taking into account the antisymmetry condition (\ref{anty}), the wave function takes one of the allowed forms
%
\begin{equation}
\Phi_S(\bm{r}_1,\bm{r}_2)=N_{+}[\psi_A(\bm{r}_1)\psi_B(\bm{r}_2)+\psi_B(\bm{r}_1)\psi_A(\bm{r}_2)]\frac{1}{\sqrt{2}}(|\uparrow\downarrow\rangle-|\downarrow\uparrow\rangle),
\end{equation}
%
for total spin $S=0$ (singlet state), and
%
\begin{equation}
\Phi_T(\bm{r}_1,\bm{r}_2)=\begin{cases}
N_{-}[\psi_A(\bm{r}_1)\psi_B(\bm{r}_2)-\psi_B(\bm{r}_1)\psi_A(\bm{r}_2)]|\uparrow\uparrow\rangle, \\
N_{-}[\psi_A(\bm{r}_1)\psi_B(\bm{r}_2)-\psi_B(\bm{r}_1)\psi_A(\bm{r}_2)]\frac{1}{\sqrt{2}}(|\uparrow\downarrow\rangle+|\downarrow\uparrow\rangle), \\
N_{-}[\psi_A(\bm{r}_1)\phi_B(\bm{r}_2)-\psi_B(\bm{r}_1)\psi_A(\bm{r}_2)]|\downarrow\downarrow\rangle, 
\end{cases}
\end{equation}
%
for spin $S=1$ (triplet state). The ground state of the hydrogen molecule is the singlet state, whose energy
$E_S$ is lower than the energy of the triplet state $E_T$ for any distance between protons $r_{AB}$.
The bound state corresponds to the energy minimum $E_S=\langle\Phi_S|H|\Phi_S\rangle$, which we obtain for $r_{AB}=0.87$ \AA. This distance is larger than the experimental value of 0.74 \AA. Meanwhile, the calculated dissociation energy of the molecule into two hydrogen atoms is $E_d=3.14$ eV and is smaller than the measured energy of 4.75 eV. This is an example of a covalent bond, in which two electrons with opposite spins become shared, which leads
to a lowering of the energy of the entire system compared to the sum of energies of two separate atoms.  
In contrast to the singlet state, the triplet state does not form a bound state of two hydrogen atoms.
More accurate values $r_{AB}=0.74$ \AA\ and $E_d=3.63$ eV are obtained in the Hartree-Fock approximation, which will be the subject of the next chapter.
The best results are obtained by the variational method, in which the wave function is written in the general form of a product of a symmetric spatial function and an antisymmetric spin function \cite{JC}
%
\begin{equation}
\Phi_S(\bm{r}_1,\bm{r}_2)=\Psi(\bm{r}_1,\bm{r}_2)\chi_0.
\end{equation} 
%
The spatial part of the wave function depends on $M$ variational parameters, $p_1$, $p_2$,..., $p_M$.
Minimizing the system energy for $M=13$ yields values $E_d=4.70$ eV and $r_{AB}=4.74$ \AA, in very good agreement with experimental data \cite{JC}.   
For most studied molecular systems and solids, it is not possible to calculate exact solutions of the Schr\"{o}dinger equation. 
Therefore, it is necessary to use approximate methods, mainly numerical, which allow us to determine the best possible wave functions and energies of electronic states
in a reasonable computational time. 

\section{Hartree-Fock equation}
\label{sec:HF}

% **[REVIEW NEEDED]**: Slater determinant and Hartree-Fock approximation terminology
One of the first methods used to describe molecular systems is the Hartree-Fock approximation \cite{hartree28,fock30,slater30}. In this approach, the wave function of a system of $N$ electrons has the form of a Slater determinant
%
\begin{equation}
\Phi = \frac{1}{\sqrt{N!}} 
\begin{vmatrix}
\phi_1(\bm{r}_1,\sigma_1) &  \phi_2(\bm{r}_1,\sigma_1)  & \dots & \phi_N(\bm{r}_1,\sigma_1) \\ 
\phi_1(\bm{r}_2,\sigma_2) &  \phi_2(\bm{r}_2,\sigma_2)  & \dots & \phi_N(\bm{r}_2,\sigma_2) \\
\dots                &  \dots                 &       &\dots \\
\phi_1(\bm{r}_N,\sigma_N) &  \phi_2(\bm{r_N},\sigma_N)  & \dots & \phi_N(\bm{r}_N,\sigma_N) \\
\end{vmatrix},
\label{slater}
\end{equation}
%
where the single-electron functions are products of the part depending on position $\bm{r}_i$
and on spin $\sigma_i$
%
\begin{equation}
\phi_i(\bm{r}_i,\sigma_i)=\psi_i^{\sigma_i}(\bm{r}_i)\xi_i(\sigma_i).
\end{equation}
%
The wave function written in the form of a Slater determinant satisfies the basic
properties of a system of indistinguishable particles.
Exchanging two electrons corresponds to exchanging two columns in the determinant, which causes
a sign change of the wave function in accordance with the antisymmetry condition.
If two electrons are in the same quantum state, then two columns
are identical and the entire determinant vanishes, which is consistent with the Pauli exclusion principle. 

The solution of the Schr\"{o}dinger equation corresponds to a wave function for which the average
of the Hamiltonian takes a minimum value. Assuming orthonormality of the function $\Phi$,
this corresponds to the variational principle in the form
%
\begin{equation}
\delta(\langle\Phi|H|\Phi\rangle - E\langle\Phi|\Phi\rangle)=0,
\label{var}
\end{equation}
%
where the symbol $\delta$ denotes the variational derivative.
Calculating the average of the Hamiltonian for the electronic subsystem (\ref{Sch-el}) in the state described by the wave function (\ref{slater}), we obtain
%
\begin{equation}
\langle\Phi|H|\Phi\rangle=\sum_{i,\sigma}\int d\mb{r} \psi_i^{\sigma*}(\mb{r})[-\frac{\hbar^2}{2m}\nabla_i^2+V_Z(\mb{r})]\psi_i^{\sigma}(\mb{r}) 
+E_H+E_x,
\label{E_HF}
\end{equation}
%
% **[REVIEW NEEDED]**: Hartree energy and exchange energy terminology
where $V_Z$ is the electrostatic potential generated by atomic nuclei, and $E_H$ is called the Hartree energy 
%
\begin{equation}
E_H=\frac{e^2}{2}\sum_{i,j,\sigma,\sigma'}
\int d\mb{r} \int d\mb{r}' \frac{\psi_i^{\sigma*}(\mb{r})\psi_j^{\sigma'*}(\mb{r}')\psi_i^{\sigma}(\mb{r})\psi_j^{\sigma'}(\mb{r}')}{|\mb{r}-\mb{r}'|}.
\end{equation}
%
Introducing the charge density at point $\mb{r}$
%
\begin{equation}
n(\mb{r})=e\sum_{i,\sigma} |\psi_i^{\sigma}(\mb{r})|^2,
\label{dens}
\end{equation}
%
we can write the Hartree energy in a simpler form
%
\begin{equation}
E_H=\frac{1}{2} \int d\mb{r} \int d\mb{r}' \frac{n(\mb{r})n(\mb{r}')}{|\mb{r}-\mb{r}'|}, 
\label{Hartree}
\end{equation}
%
which corresponds to the classical Coulomb interaction energy for a given distribution of electric charge density. 
%
$E_x$ is called the exchange energy and equals
%
\begin{equation}
E_x=-\frac{e^2}{2}\sum_{i,j,\sigma}
\int d\mb{r} \int d\mb{r}' \frac{\psi_i^{\sigma*}(\mb{r})\psi_j^{\sigma*}(\mb{r}')\psi_i^{\sigma}(\mb{r}')\psi_j^{\sigma}(\mb{r})}{|\mb{r}-\mb{r}'|}.
\label{exc}
\end{equation}
%
% **[REVIEW NEEDED]**: Exchange interaction and exchange hole concept
The exchange energy is a quantum quantity that has no counterpart in classical physics. 
The exchange interaction is characterized by two important features that are closely related to each other. 
First of all, this interaction concerns only electrons with parallel spins. 
According to the Pauli exclusion principle, two electrons with parallel spins cannot have the same
remaining quantum numbers, which would be associated with occupying the same quantum state. 
Effectively, this leads to an increase in the distance between such electrons and
a reduction of the Coulomb interaction energy. From this follows the second feature
of the exchange interaction: the negative value of this interaction energy. One can interpret the exchange interaction
as the Coulomb interaction of an electron with a positive charge called the {\it exchange hole},
which causes a reduction of the negative charge density around each electron. 

After applying the variational method to (\ref{E_HF}), we obtain the Hartree-Fock equation
%
\begin{equation}
[-\frac{\hbar^2}{2m}\nabla_i^2+V_Z(\mb{r})+V_H(\mb{r})]\psi_i^{\sigma}(\mb{r})
-\frac{e^2}{2}\sum_{j,\sigma}\int d\mb{r}' \frac{\psi_j^{\sigma*}(\mb{r}')\psi_i^{\sigma}(\mb{r}')}{|\mb{r}-\mb{r}'|}\psi_j^{\sigma}(\mb{r})=E_i\psi_i^{\sigma}(\mb{r}),
\label{HF}
\end{equation} 
%
where $V_H$ denotes the Hartree potential
%
\begin{equation}
V_H(\mb{r})=\int d\mb{r}' \frac{n(\mb{r}')}{|\mb{r}-\mb{r}'|}.
\end{equation}
%
The Hartree-Fock equation is a nonlinear equation because the last term of the Hamiltonian contains the wave function we are looking for.
Slater proposed a different form of equations (\ref{HF}), which
allows better understanding of the nature of the exchange interaction \cite{slater51}.
Multiplying and dividing the exchange term by $\psi_i^{\sigma}(r)$, we obtain
%
\begin{equation}
[-\frac{\hbar^2}{2m}\nabla_i^2+V_Z(\mb{r})+V_H(\mb{r})
-\frac{e}{2}\int d\mb{r}' \frac{n(\mb{r},\mb{r}')}{|\mb{r}-\mb{r}'|}]\psi_i^{\sigma}(\mb{r})=E_i\psi_i^{\sigma}(\mb{r}),
\label{HFS}
\end{equation}
%
where $n(\mb{r},\mb{r}')$ can be interpreted as the exchange charge density 
%
\begin{equation}
n(\mb{r},\mb{r}')= e\sum_{j,\sigma}\frac{\psi_j^{\sigma*}(\mb{r}')\psi_i^{\sigma}(\mb{r}')\psi_j^{\sigma}(\mb{r})\psi_i^{\sigma*}(\mb{r})}{\psi_i^{\sigma*}(\mb{r})\psi_i^{\sigma}(\mb{r})},
\label{EC}
\end{equation}
%
which is a function of two positions $\mb{r}$ and $\mb{r}'$ and depends on the quantum state $i$. The total exchange charge
equals the charge of a single electron, which can be easily shown by integrating over $\mb{r}'$ and using the orthogonality 
of wave functions
%
\begin{equation}
q=e\sum_{j,\sigma}[\int d\mb{r}'\psi_j^{\sigma*}(\mb{r}')\psi_i^{\sigma}(\mb{r}')]\frac{\psi_j^{\sigma}(\mb{r})}{\psi_i^{\sigma}(\mb{r})}=
e\sum_{j,\sigma}\delta_{ij}\frac{\psi_j^{\sigma}(\mb{r})}{\psi_i^{\sigma}(\mb{r})}=e.
\end{equation}
%
% **[REVIEW NEEDED]**: Self-interaction cancellation and Koopmans' theorem
Taking into account the case when both positions are the same $\bm{r}=\bm{r'}$, we obtain the exchange charge density consistent with formula (\ref{dens}).
This causes the term describing the interaction of an electron with its own exchange field to have the same form as the Hartree potential, but with the opposite sign.
Due to this property, both terms cancel each other out, and in the Hartree-Fock approximation there is no problem of an electron interacting with its own field ({\it self-interaction}). 
In the form (\ref{HFS}), the Hartree-Fock equation has the form of a one-electron Schr\"{o}dinger equation with an exchange potential generated
at the location of the electron by the exchange charge.
According to Koopmans' theorem, the eigenvalues $E_i$ correspond to the energies required to remove an electron from the orbital 
$\psi_i^{\sigma}(\mb{r})$~\cite{Koopman}.


\section{Self-consistent field method}

The Hartree-Fock equations are most often solved numerically using the self-consistent field method, also called the mean-field approximation.
For fixed atomic positions, we choose initial wave functions $\psi_{i0}^{\sigma}$, 
which can be, for example, orbitals of isolated atoms.
For these wave functions, we calculate the electron density $n(\mb{r})$ and potential $V(\mb{r})$ 
at each point in space of the studied system. 
For the potential calculated in this way, we solve equation (\ref{HF}) determining the set of one-electron wave functions and energies 
of electronic states. We use the determined wave functions to recalculate the electron density
and effective potential. We repeat the procedure until the energies and wave functions obtained in successive steps
are the same or differ by a small specified amount. Most often, the parameter used to test convergence
of the calculation is the total energy of the system. The self-consistent field method was first applied
to solve the Hartree equation, which we can obtain from the Hartree-Fock equation by removing
the exchange interaction. The Hartree equation corresponds to a wave function in the form of
a product of independent single-particle functions, i.e., it describes a set of independent electrons
in an effective electrostatic field. The self-consistent field method is currently used in most 
computational methods for the electronic structure of solids. 

\section{Electronic correlations}

% **[REVIEW NEEDED]**: Correlation energy definition and strongly correlated systems
The Hartree-Fock approach is an approximate method, so the calculated energy
and wave functions differ from exact quantities, which correspond to solutions of the Schr\"{o}dinger equation
for the many-electron wave function.
Taking into account all effects of many-body interactions in the electronic system enables
an additional lowering of the total energy compared to the Hartree-Fock energy.
The difference between the exact energy value ($E_{\rm{exact}}$) and the energy calculated in the 
Hartree-Fock approximation ($E_{\rm{HF}}$) is called the correlation energy
%
\begin{equation}
E_c=E_{\rm{\text{exact}}}-E_{\rm{\text{HF}}}.
\end{equation}
%
The source of electronic correlations are Coulomb interactions, which tend to spatially separate 
electrons. An electron located at position $\bm{r}$ causes other electrons to avoid this position.
That is, the probability of finding an electron at a given point depends on the positions of all the remaining $N-1$
electrons. Materials in which local Coulomb interactions have a decisive influence on the electronic structure
and transport properties are called strongly correlated systems. 

% **[REVIEW NEEDED]**: Configuration interaction and multi-determinant methods
The Hartree-Fock method is the starting point for more advanced methods used mainly in quantum chemistry.
One can generally write the wave function of a system of $N$ electrons as an expansion in a finite number of Slater determinants
%
\begin{equation}
\Phi(\bm{r}_1,...,\bm{r}_N)=c_0\Phi_0(\bm{r}_1,...,\bm{r}_N)+\sum_{i=1}^{N_\text{det}} c_i\Phi_i(\bm{r}_1,...,\bm{r}_N),
\end{equation}
%
where $\Phi_0$ is the ground state wave function in the Hartree-Fock approximation,
and the determinants $\Phi_i$ correspond to excited states. The larger the number of these determinants $N_{\text{det}}$, the more accurately
the electronic correlations are described. The functions $\Phi_i$ are constructed using single-electron orbitals that are not occupied
in the ground state and can be occupied by excited electrons. The determinants can describe single transitions of electrons to unoccupied orbitals ($\Phi_i^{\text{S}}$),
double electron excitations ($\Phi_i^{\text{D}}$), triple excitations ($\Phi_i^{\text{T}}$), and so on.
The total number of all possible excited configurations grows very rapidly with the number of electrons $N$ and orbitals $M$ (occupied and empty)
according to the formula 
%
\begin{equation}
N_{\text{det}}=\frac{(M+1)!}{N!(M+1-N)!}
\end{equation}
%
In the simplest approach called the configuration interaction (CI) method \cite{GTO},
the determinants are constructed from occupied and empty single-electron orbitals of the Hartree-Fock Hamiltonian.
The wave function takes the form of a series of determinants with an increasing number of excited electrons
%
\begin{equation}
\Phi_{\text{CI}}=c_0\Phi_0+\sum_{i=1}^{N_\text{S}} c^\text{S}_i \Phi_i^{\text{S}}+\sum_{i=1}^{N_\text{D}} c^\text{D}_i \Phi_i^{\text{D}}+\sum_{i=1}^{N_\text{T}} c^\text{T}_i \Phi_i^{\text{T}}+...,
\label{phiCT}
\end{equation}
% 
where $N_\text{S}$, $N_\text{D}$, $N_\text{T}$ determine the number of determinants for a given number of excited orbitals.
The ground state is found by determining the coefficients $c_i$ that minimize the energy
%
\begin{equation}
E_\text{CI}=\int \Phi^*(\bm{r}_1,...,\bm{r}_N)H\Phi(\bm{r}_1,...,\bm{r}_N)d\bm{r}_1d\bm{r}_2...d\bm{r}_N,
\end{equation}
%
where $H$ is the Hamiltonian of the electronic system (\ref{Sch-el}).
The minimization is carried out under the condition of wave function normalization, which translates into a condition for all expansion coefficients
$\sum_ic_i^2=1$.
In the limit of an infinite number of determinants, the wave function obtained in this way corresponds to the exact many-electron wave function.
In practice, expansions are used up to a few largest terms of the series (\ref{phiCT}), which
include double, triple, or quadruple excitations.  
The next step is to enable optimization of single-electron orbitals as well, in combination with
optimization of expansion coefficients within the multi-configuration self-consistent field (MCSCF) method. 
Multi-determinant methods allow very accurate determination of wave functions and energies of electronic states, 
however, the computational time scales exponentially with the system size,
so it is used only for small molecular systems.

\section{Electron gas}

% **[REVIEW NEEDED]**: Free electron gas model and Fermi energy
A homogeneous electron gas is a good approximation of the actual electronic structure
of simple metals and is often used in many fundamental
computational methods (e.g., in the local density approximation).
The simplest model of an electron gas consists of non-interacting particles
confined in a cube of volume $V=L^3$. The length of the electronic de Broglie wave
propagating in each direction must satisfy the periodicity condition ($n\lambda=L$),
which leads to quantization of the wave vector in the $x$, $y$, and $z$ directions
%
\begin{equation}
\mb{k}=(\frac{2\pi n_x}{L},\frac{2\pi n_y}{L},\frac{2\pi n_z}{L}),
\end{equation}
%
where $n_x$, $n_y$, $n_z$ are integers.
The energies and wave functions of discrete electronic states are given by the formulas
%
\begin{equation}
E_k=\frac{\hbar^2 k^2}{2m},
\end{equation}
%
\begin{equation}
\psi_k(\mb{r})=\frac{1}{\sqrt{V}}e^{i\mb{kr}},
\label{pw}
\end{equation}
%
We assume that the system is not magnetically polarized and the number of electrons with spins pointing 
up and down is the same, $N_{\uparrow}=N_{\downarrow}=\frac{1}{2}N$.
According to the Pauli exclusion principle, in a quantum state with a given wave vector $\mb{k}$, there can be
a maximum of two electrons with opposite spins.
At temperature $T=0$ K, electrons occupy consecutive states from the lowest to
the maximum value $E_F$ called the Fermi energy. 
The total energy of a system of $N$ electrons is
%
\begin{equation}
E=2\sum_{k<k_F} E_k = \frac{2V}{(2\pi)^3}\int d\bm{k} \frac{\hbar^2 k^2}{2m} = \frac{V}{(2\pi)^3}\frac{4\pi\hbar^2}{5m} k_F^5, 
\label{E}
\end{equation}
%
where $(2\pi)^3/V$ is the volume in reciprocal space per one electronic state, 
and $k_F$ is the Fermi wave vector, which is the radius of a sphere in reciprocal space
containing the occupied electronic states. In the general case, the surface encompassing occupied electronic states,
called the Fermi surface, can have any shape and consist of many separate parts.
The number of electrons in volume $V$ is expressed by the formula
%
\begin{equation}
N=\frac{2V}{(2\pi)^3}\int d\bm{k}=\frac{2V}{(2\pi)^3}\frac{4\pi}{3} k_F^3.  
\label{N}
\end{equation}
%
Dividing (\ref{E}) by (\ref{N}), we obtain the average energy per
single electron, expressed through the Fermi energy
%
\begin{equation}
\frac{E}{N}=\frac{3}{5} \frac{\hbar^2 k_F^2}{2m} = \frac{3}{5} E_F.
\label{EN}
\end{equation}  
%
In the case of a homogeneous gas, the electron density is given by the expression
%
\begin{equation}
n = \frac{N}{V} = \frac{k_F^3}{3\pi^2}.
\label{nkf}
\end{equation}
%
A commonly used quantity is the volume of a sphere in real space per one electron 
%
\begin{equation}
V_s=\frac{4\pi}{3}r_{s}^3=\frac{1}{n},
\end{equation}
%
where $r_s$ is its radius
%
\begin{equation}
r_s=(\frac{3}{4\pi n})^{1/3}.
\end{equation}
%
% **[REVIEW NEEDED]**: Hartree-Fock treatment of electron gas and exchange energy derivation
We will now calculate the energy of the electron gas in the Hartree-Fock approximation.
We assume that the positive charge is distributed uniformly throughout the entire volume $V$
and has the same density as the electron gas. The interaction energy
of electrons with such a field cancels with the Hartree energy, and the total energy
of an electron consists only of the kinetic part and the exchange interaction.
The exchange energy can be easily calculated by representing the Coulomb potential
in the form of a Fourier transform
%
\begin{equation}
\frac{1}{|\mb{r}-\mb{r}'|}=4\pi\int \frac{d\mb{q}}{(2\pi)^3}\frac{e^{i\mb{q}(\mb{r}-\mb{r}')}}{q^2},
\end{equation}
%
Inserting the wave function in the form (\ref{pw}) into the expression for the exchange energy 
and performing integration, we obtain the energies of single-electron states
%
\begin{equation}
E_k=\frac{\hbar^2 k^2}{2m} - \int_{\mb{k'}<\mb{k_F}} \frac{d\bm{k'}}{(2\pi)^3} \frac{4\pi}{|\mb{k}-\mb{k'}|^2}
=\frac{\hbar^2 k^2}{2m} - \frac{k_F}{\pi}(1+\frac{k_F^2-k^2}{2kk_F}ln|\frac{k_F+k}{k_F-k}|).
\end{equation}
%
The total energy of the electron system is obtained by summing this expression over the wave vector    
%
\begin{equation}
E=\sum_{k<k_F}[\frac{\hbar^2 k^2}{2m} - \frac{k_F}{\pi}(1+\frac{k_F^2-k^2}{2kk_F}ln|\frac{k_F+k}{k_F-k}|)].
\end{equation}
%
Using (\ref{EN}) and converting the summation in the second term to an integral, we obtain
%
\begin{equation}
E=N(\frac{3}{5}E_F - \frac{3k_F}{4\pi})=N(\frac{3}{5}E_F - \frac{3(3\pi^2n)^{\frac{1}{3}}}{4\pi}),
\end{equation}
where we used the relation (\ref{nkf}). The exchange energy per electron is 
%
\begin{equation}
\varepsilon_x=\frac{E_x}{N}=-\frac{3}{4}\Big(\frac{3}{\pi}\Big)^{\frac{1}{3}}n^\frac{1}{3}.
\label{exchange}
\end{equation}
%
% **[REVIEW NEEDED]**: Exchange energy formula and local density approximation
This formula determining the dependence of exchange energy on electron density
is used in density functional theory within the local density approximation.

For an electron gas, one can derive an expression describing the distribution of exchange hole charge (\ref{EC}),
which depends only on distance $r$
%
\begin{equation}
g^{\sigma}_x(r)=1 - [3\frac{sin(rk_F)-rk_Fcos(rk_F)}{(rk_F)^3}]^2.
\end{equation}
%
% **[REVIEW NEEDED]**: Correlation energy approximations - Wigner, Gell-Mann-Brueckner, and QMC
It is not possible to express the correlation energy for a free electron gas in the form of 
an analytical function of density $n$. The first approximate formula was proposed by Wigner \cite{wigner34}
%
\begin{equation}
\varepsilon(r_s)=-\frac{0.44}{r_s+7.8}.
\end{equation}
%
In the limit of low densities ($r_s\rightarrow \infty$), electrons form the so-called Wigner crystal, whose correlation energy 
coincides with the electrostatic energy of localized point charges.
In the limit of high density ($r_s\rightarrow 0$), Gell-Mann and Brueckner
derived a formula for the correlation energy density of a magnetically unpolarized
electron gas \cite{GB}
%
\begin{equation}
\varepsilon_c (r_s)=0.311\ln(r_s)+r_s(A\ln(r_s)+C)-0.048+... .
\end{equation}
%
The correlation energy of the electron gas was most accurately determined numerically
by the quantum Monte Carlo (QMC) method \cite{CeperleyAlder80}. 


\chapter{Electronic states in crystals}

\section{Crystal lattice}

Crystals are built from atoms or molecules arranged in a periodic lattice.
A three-dimensional crystal lattice is defined as a set of points whose
positions are given by the translation vector
%
\begin{equation}
\bm{R}_n=n_1\bm{a}_1+n_2\bm{a}_2+n_3\bm{a}_3,
\label{trans}
\end{equation}
%
where the vectors $\bm{a}_i$ are called the fundamental or primitive translation vectors, and $n_i$ are integers.
The set of points defined by this formula is called a Bravais lattice. Similarly, a Bravais lattice
can be defined for any dimension $d$ by choosing an appropriate number of basis vectors: $\bm{a}_1,\bm{a}_2,...,\bm{a}_d$. 
With each Bravais lattice point, one can associate a set of atoms called the basis. The smallest region of the crystal
that, when translated by all lattice translations, fills the entire space is called the primitive cell. 
The primitive cell contains exactly one Bravais lattice point and is usually built on the primitive translation vectors of the lattice.
There exists a special type of primitive cell called the Wigner-Seitz cell, which is the region containing all points in space 
that are closer to a given lattice point than to any other. 
Often, instead of the primitive cell, the conventional cell is used, which is built on different basis vectors
and whose symmetry is the same as the symmetry of the entire crystal.
The volume of the conventional cell is an integer multiple of the volume of the primitive cell.
In simple structures (without face-centering or body-centering), the conventional cell coincides
with the primitive cell. The differences between various types of cells can be illustrated using the example
of a two-dimensional lattice. Figure \ref{fig:bravais} shows a centered rectangular structure with two primitive vectors $\bm{a}_p$
and $\bm{b}_p$ marked, which define the primitive cell, shown in the figure in two variants. The Wigner-Seitz cell is shown
on the right side. The conventional cell is determined by two basis vectors $\bm{a}_e$ and $\bm{b}_e$.
In two dimensions, there are five types of Bravais lattices in total: oblique, rectangular, centered rectangular, hexagonal, and square.

\begin{figure}[h]
\centering
\includegraphics[scale=0.4]{lattice.pdf}
\caption{Two-dimensional periodic lattice.}\label{fig:bravais}
\end{figure}

In the case of three-dimensional lattices, all possible structures can be divided into seven crystal systems: 
cubic, tetragonal, orthorhombic, hexagonal, trigonal, monoclinic, and triclinic, corresponding to fourteen possible Bravais lattices,
which are divided into simple (P), face-centered (F), base-centered (C), and body-centered (I). 
All crystal systems with their corresponding Bravais lattices are presented in Table \ref{lattice}.
For each system, the relationship between the lattice constants ($a$, $b$, $c$) and the angles between directions ($\alpha$, $\beta$, $\gamma$)
that define the edges of the conventional cells is shown. 

\begin{table}[h!]
\caption{Crystal systems.}\label{lattice}
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
System & Lattice constants & Angles & Bravais lattices\\
\hline
cubic & $a=b=c$ & $\alpha=\beta=\gamma=90^{\degree}$ &  P, F, I \\ 
tetragonal & $a=b\ne c$ & $\alpha=\beta=\gamma=90^{\degree}$ &  P, I \\  
orthorhombic & $a\ne b\ne c$ & $\alpha=\beta=\gamma=90^{\degree}$ &  P, F, C, I \\ 
hexagonal &  $a=b\ne c$ & $\alpha=\beta=90^{\degree}$, $\gamma=120^{\degree}$ &  P  \\
trigonal & $a=b\ne c$ & $\alpha=\beta=90^{\degree}$, $\gamma=120^{\degree}$ &  P \\
monoclinic & $a=b\ne c$ & $\alpha=\gamma=90^{\degree}$, $\beta\ne 90^{\degree}$ & P, C \\ 
triclinic & $a\ne b\ne c$ & $\alpha\ne \beta\ne \gamma\ne 90^{\degree}$ & P \\ \hline
\end{tabular}
\end{center}
\end{table}

The set of operations that leaves a given crystal unchanged forms a space group.
It consists of crystal lattice translations described by formula (\ref{trans}) and point symmetries: inversion, rotations, and reflections.
Additionally, there are nonsymmorphic operations, which are combinations of point operations and fractional translations.
There are 230 space groups in total, of which 73 are symmorphic and 157 are nonsymmorphic.

\section{Reciprocal space}

The electronic structure of a material is most often analyzed using the space of wave vectors $\bm{k}$,
which is called reciprocal space. Each Bravais lattice in real space corresponds to a lattice of points
in reciprocal space defined by vectors
%
\begin{equation}
\bm{G}_m=m_1\bm{b}_1+m_2\bm{b}_2+m_3\bm{b}_3,
\end{equation}
%
where $m_j$ are integers, and $\bm{b}_j$ are vectors reciprocal to the basis vectors $\bm{a}_i$,
that is, they satisfy the condition
%
\begin{equation}
\bm{a}_i \cdot \bm{b}_j = 2\pi \delta_{ij}.
\label{orto}
\end{equation}
%
The reciprocal lattice vectors can be determined from the following relations
%
\begin{eqnarray}
\bm{b}_1=\frac{2\pi}{\Omega}\bm{a}_2\times \bm{a}_3, \\
\bm{b}_2=\frac{2\pi}{\Omega}\bm{a}_3\times \bm{a}_1, \\
\bm{b}_3=\frac{2\pi}{\Omega}\bm{a}_1\times \bm{a}_2, 
\end{eqnarray}
%
where $\Omega=\bm{a}_1\cdot(\bm{a}_2\times \bm{a}_3)$ is the volume of the primitive cell.

In reciprocal space, we also define a primitive cell, which most often has the shape
of a Wigner-Seitz cell and is called the Brillouin zone (BZ).  
The cell that includes the point $\bm{K}=0$, called the $\Gamma$ point, is called the first Brillouin zone.
Figure \ref{fig:lattice} shows example Brillouin zones for three cubic lattices. 

\begin{figure}[h]
\centering
\includegraphics[scale=1.2]{brillouin.pdf}
\caption{Brillouin zones for cubic lattices: simple (P), body-centered (I), and face-centered (F).}
\label{fig:lattice}
\end{figure}


\section{Bloch's theorem}

In the simplest description of electrons in the periodic potential of a crystal $V(\bm{r})$, electronic states are described by independent single-particle wave functions, which are solutions of the Schr\"{o}dinger equation in the form
%
\begin{equation}
[-\frac{\hbar^2\nabla^2}{2m}+V(\bm{r})]\psi^{\sigma}_{\bm{k}j}(\bm{r})=\varepsilon_{j\sigma}(\bm{k})\psi^{\sigma}_{\bm{k}j}(\bm{r}),
\label{RS}
\end{equation}
%
where $\bm{k}$ is the wave vector, $\sigma$ specifies the electron spin, and the index $j$ numbers the eigenstates of the Hamiltonian corresponding to energies $\varepsilon_{j\sigma}(\bm{k})$.
According to Bloch's theorem, the wave function of electrons in a periodic potential has the form
%
\begin{equation}
\psi^{\sigma}_{\bm{k}j}(\bm{r})=e^{i\bm{k}\bm{r}}u^{\sigma}_{\bm{k}j}(\bm{r}),
\end{equation}
%
where $u^{\sigma}_{\bm{k}j}(\bm{r})$ is a periodic function satisfying the condition $u^{\sigma}_{\bm{k}j}(\bm{r})=u^{\sigma}_{\bm{k}j}(\bm{r}+\bm{R}_n)$ for
each translation vector $\bm{R}_n$. It can be shown that Bloch functions are eigenvectors
of the translation operator
%
\begin{equation}
\hat{T}_n\psi^{\sigma}_{\bm{k}j}(\bm{r})=\psi^{\sigma}_{\bm{k}j}(\bm{r}+\bm{R}_n)=e^{i\bm{k}(\bm{r}+\bm{R}_n)}u^{\sigma}_{\bm{k}j}(\bm{r}+\bm{R}_n)=e^{i\bm{k}\bm{R}_n}\psi^{\sigma}_{\bm{k}j}(\bm{r}).
\end{equation}
%
The Hamiltonian is invariant under the action of the translation operator,
which means that both operators commute. Bloch functions are therefore also eigenstates of the Hamiltonian,
which proves the validity of Bloch's theorem. 

A Bloch function is defined for the wave vector $\bm{k}$, which in periodic systems is a well-defined quantum number.
The wave vector is related to the quasimomentum of an electron in state $\psi_{\bm{k}j}$
%
\begin{equation}
\bm{p}=\hbar\bm{k}.
\end{equation}
%
Since all properties of the electronic structure are translationally invariant 
with respect to translation by any reciprocal lattice vector, the quasimomentum also does not depend on such translation.

\section{Plane waves}

Computational methods for band structure differ in the representations of the wave function they employ.
In general, we can write the wave function in the form
%
\begin{equation}
\psi^{\sigma}_{\bm{k}j}(\bm{r})=\sum_mc^{\sigma}_{jm}(\bm{k})\phi_{\bm{k}m}(\bm{r}),
\end{equation}
% 
where $\phi_{\bm{k}m}(\bm{r})$ are basis functions, and $c^{\sigma}_{jm}(\bm{k})$ are expansion coefficients.
In a crystal, due to the periodic potential, plane waves form a natural basis. If we expand the periodic part of the
Bloch function in this basis, the wave function takes the form
%
\begin{equation}
\psi^{\sigma}_{\bm{k}j}(\bm{r})=e^{i\bm{k}\bm{r}}\sum_{m} c^{\sigma}_{jm}(\bm{k})e^{i\bm{G_m}\bm{r}}=\sum_{m} c^{\sigma}_{jm}(\bm{k})e^{i(\bm{k}+\bm{G_m})\bm{r}},
\end{equation}
% 
where $\bm{G_m}$ are reciprocal lattice vectors. The Schr\"{o}dinger equation (\ref{RS}) transformed to reciprocal space in the plane wave basis
takes the form
%
\begin{equation}
\sum_{n}H_{mn} c^{\sigma}_{jn}(\bm{k})=\varepsilon_{j\sigma}(\bm{k}) c^{\sigma}_{jm},
\label{ham_rec}
\end{equation}
%
where the matrix elements of the Hamiltonian are given by the expression
%
\begin{equation}
H_{mn}=\frac{\hbar^2}{2m}|\bm{k}+\bm{G_m}|^2\delta_{mm'}+V(\bm{G_m}-\bm{G_n}).
\end{equation}
%
The second term is the Fourier transform of the electronic potential
%
\begin{equation}
V(\bm{G})=\frac{1}{\Omega}\int_{\Omega}\bm{dr}V(\bm{r})e^{-i\bm{Gr}},
\end{equation}
%
where the integration is performed over the primitive cell.

\section{Periodic boundary conditions}

Similarly to the electron gas enclosed in a container, we can also introduce periodic boundary conditions (Born-Karman conditions) for a finite crystal. 
Let us assume that the size of the crystal
is determined by the number of primitive cells in each direction of the crystal $(N_1,N_2,N_3)$.
Thus, the integers that define the lattice translation vectors (\ref{trans})
vary in the range $n_i=0,1,2,...,N_i$, where $i=1,2,3$.
Assuming that the wave function on two opposite edges of the system (in each of the three directions) takes
the same values and using Bloch's theorem, we obtain the condition
%
\begin{equation}
\psi^{\sigma}_{\bm{k}j}(\bm{r})=\psi^{\sigma}_{\bm{k}j}(\bm{r}+N_i\bm{a}_i)=e^{i\bm{k}N_i\bm{a}_i}\psi^{\sigma}_{\bm{k}j}(\bm{r}),
\label{pwb}
\end{equation} 
%
which is satisfied when 
%
\begin{equation}
\bm{k}N_i\bm{a}_i=2\pi n_i.
\end{equation}
%
Using the basis of primitive vectors of the reciprocal lattice ($\bm{b}_1,\bm{b}_2,\bm{b}_3$) and taking into account relation (\ref{orto}), we obtain the set of allowed wave vectors
%
\begin{equation}
\bm{k}=\frac{n_1}{N_1}\bm{b}_1+\frac{n_2}{N_2}\bm{b}_2+\frac{n_3}{N_3}\bm{b}_3.
\label{vectk}
\end{equation}
%
These vectors determine the Bloch wave functions $\psi_{i,\bm{k}}$ and state energies $\varepsilon_i(\bm{k})$.
The finite number of available states therefore results from the limited size of the crystal and equals the number of primitive cells in the system: $N=N_1N_2N_3$.  
From formula (\ref{vectk}) it also follows that the allowed wave vectors of electronic states belong to a single primitive cell in reciprocal space.
Most often, vectors belonging to the first Brillouin zone are chosen for the analysis of electronic states.

\section{Summation in reciprocal space}

Many physical quantities are determined as sums over points in reciprocal space. 
The analysis presented above shows that it is sufficient to restrict
oneself to wave vectors belonging to the first Brillouin zone.
Additionally, one can use the symmetry of the crystal to reduce the number of points necessary
to determine a given physical quantity. 
Let us denote point operations (symmorphic) by $O_i$, and the fractional translation vectors associated with a given symmetry $O_i$
by $\bm{t}_i$. In reciprocal space, we consider only symmorphic symmetry operations because fractional translations
have no effect on reciprocal space. The Hamiltonian describing the crystal is invariant
with respect to point operations: $\bm{r}\rightarrow O_i\bm{r}+\bm{t}_i$ and $\bm{k}\rightarrow O_i\bm{k}$.
This means that the wave functions obtained after these transformations 
%
\begin{equation}
\psi^{\sigma}_{O_i\bm{k}j}(O_i\bm{r}+\bm{t}_i)=\psi^{\sigma}_{\bm{k}j}(\bm{r}),
\end{equation}  
%
are also eigenfunctions of the Hamiltonian with the same eigenvalue $\varepsilon_{j\sigma}(\bm{k})$.
This means that one can restrict the summation of a given physical quantity $f(\bm{k})$ to vectors $\bm{k}$ belonging to a smaller region,
which is called the irreducible part of the Brillouin zone (IBZ). 
This region is formed by vectors $\bm{k}$ that are inequivalent, that is, they cannot be mutually connected by a point symmetry operation. 
Values at the remaining points are obtained by applying the appropriate symmetry operations $f(O_i\bm{k})=f(\bm{k})$.
For summation, we use weights $w_{\bm{k}}$, which are defined as the number of vectors $\bm{k}$ related by point symmetry 
to a vector belonging to the IBZ (including this vector), divided by the total number of vectors $N_{\bm{k}}$.
For example, the average value of quantity $f$ can be calculated by summing over points belonging to the IBZ
%
\begin{equation}
\bar{f}=\frac{1}{N_{\bm{k}}}\sum_{\bm{k}}^{BZ}f(\bm{k})=\sum_{\bm{k}}^{IBZ}w_{\bm{k}}f(\bm{k}).
\end{equation}
%

When summing over reciprocal space, one can in principle choose any points belonging to the IBZ.
However, using the properties of periodic functions, one can choose vectors $\bm{k}$ in such a way
as to minimize errors when calculating sums or integrals.
Any periodic function can be expanded using the Fourier transform
%
\begin{equation}
f(\bm{k})=\sum_n f(\bm{R}_n)e^{i\bm{k}\bm{R}_n},
\end{equation} 
%
where $\bm{R}_n$ are crystal lattice translation vectors.
The set of points that is optimal for calculating sums in reciprocal space 
is called the Monkhorst-Pack mesh \cite{MP}. It is determined from the formula
%
\begin{equation}
\bm{k}(n_1,n_2,n_3)=\sum_i^3 \frac{2n_i-N_i-1}{2N_i}\bm{b}_i,
\end{equation}
%
where the numbers $N_1$, $N_2$, and $N_3$ specify the number of $\bm{k}$ points in each direction: $n_i=1,2,...,N_i$.
Points defined in this way form a uniform mesh in reciprocal space and are characterized by
the fact that the sum of values of a periodic function, which has Fourier components limited in each direction to $\bm{R}_n=N_i\bm{a}_i$,
equals the exact integral of this function.  

\section{Fermi energy}

Physical quantities related to the ground state are usually calculated for occupied electronic states.
That is, the summation in reciprocal space includes only occupied states.
The energy of the highest occupied state determines the Fermi energy ($E_F$).
In metals, electronic bands cross $E_F$, and when summing over discrete $\bm{k}$ points, discontinuities appear
in state occupations. This causes slower convergence with respect to the number of $\bm{k}$ points. 
This problem can be easily solved by introducing a continuous occupation function for states near $E_F$.
A natural choice is to use the Fermi-Dirac distribution function for finite temperature
%
\begin{equation}
F(\varepsilon,E_F,T)=[\exp(\frac{\varepsilon-E_F}{kT})+1]^{-1}.
\end{equation}   
%
For $T=0$, we obtain a step function that corresponds to the distribution in the ground state.
To determine $E_F$ for any temperature, we use the condition
%
\begin{equation}
\sum_{\bm{k},j} w_{\bm{k}}F(\varepsilon,E_F,T)=n_{el},
\end{equation}   
%
where $n_{el}$ is the number of electrons, and the summation is performed over all occupied states
taking into account spin polarization.



\section{Band structure}

The set of all electronic states $\varepsilon_{\bm{k}j}^{\sigma}$ obtained by diagonalization of the Hamiltonian 
for wave vectors $\bm{k}$ forms the band structure of a given material.
The available energies of electronic states corresponding to the eigenfunction with index $j$ are grouped into intervals called energy bands. 
Solutions of equation (\ref{ham_rec}) as a function of the wave vector $\bm{k}$ are periodic with respect to translation by 
a reciprocal lattice vector
%
\begin{equation}
\varepsilon_{\bm{k}j}^{\sigma}=\varepsilon_{\bm{k}+\bm{G_m}j}^{\sigma}.
\end{equation}   
%
Therefore, when presenting the band structure, one can restrict oneself to the first Brillouin zone. Usually, only electronic states for wave vectors $\bm{k}$ belonging to selected directions and high-symmetry points in reciprocal space are presented. If the band energies take different values for the two spin directions,
$\varepsilon_{\bm{k}j}^{\uparrow}\ne \varepsilon_{\bm{k}j}^{\downarrow}$, we are dealing with spin (exchange) splitting, which is associated with magnetic ordering.

An important quantity that characterizes the band structure is the density of electronic states for a given spin direction $\rho_{\sigma}(E)$,
which is calculated as a sum over the first Brillouin zone
%
\begin{equation}
\rho_{\sigma}(E)=\frac{1}{N_k}\sum_{j,\bm{k}}\delta[\varepsilon_{\bm{k}j}^{\sigma}-E],
\end{equation}
%
where $N_k$ is the number of $\bm{k}$ vectors in the first Brillouin zone.
The total density of states is the sum of both spin components, $\rho(E)=\rho_{\uparrow}(E)+\rho_{\downarrow}(E)$.
When calculating the density of states, instead of the Monkhorst-Pack mesh, the tetrahedron method is often used.
It consists of dividing the entire Brillouin zone into tetrahedra and calculating the energies of states at points $\bm{k}$ that
correspond to the vertices of the tetrahedra. Energies between these points are determined using linear interpolation.

The band structure determines the basic properties of a given material and is its distinguishing feature, allowing it to be classified into a specific group of materials. 
The three basic types of crystalline materials are metals, semiconductors, and insulators.
The band structure of metals is characterized by the presence of a Fermi surface, which separates occupied electronic states from empty states.
Thus, in typical metals, the density of states at the Fermi level is nonzero, $\rho(E_F)>0$.
Just above the Fermi energy ($E_F$), there are states to which electrons excited thermally or as a result of interaction with other
electrons transition. In semiconductors and insulators, above the last occupied electronic state, there is a gap covering
a range of energetically forbidden states.
The band that is located just below the energy gap is called the valence band, and the one above it
is the conduction band.
Semiconductors are usually characterized by a smaller energy gap ($\sim$1-2 eV) than insulators.
There are also materials called semimetals, in which the energy gap and $\rho(E_F)$ are both zero (e.g., graphene).
A separate group of materials are Mott insulators, in which the energy gap results from strong electronic
interactions.  



\chapter{Density Functional Theory}

\section{Hohenberg-Kohn Theorems}

Most modern computational methods used to study material properties are based on density functional theory (DFT), which was formulated in the works of Hohenberg and Kohn \cite{kohn64}
and Kohn and Sham \cite{kohn65}. Currently, DFT is widely used for calculating electronic structure,
optimizing crystal lattices, studying elastic properties and lattice dynamics, and many other material properties.
It is practically the only method enabling quantum-mechanical calculations for systems containing hundreds,
or even thousands of atoms.
Similarly to the description of exchange interactions proposed by Slater~\cite{slater51}
and in Thomas-Fermi theory~\cite{thomas,fermi1927,dirac}, the fundamental quantity here is the electron density defined at each point in the material $n(\bm{r})$.
The main idea of this approach is the possibility of replacing the exact wave function with a system of single-particle states in an effective electronic potential, which
gives the same electron density as the many-electron description.
This approach enables the use of exact information about exchange and correlation interactions
obtained for the homogeneous electron gas to study inhomogeneous atomic systems.

The work of Hohenberg and Kohn \cite{kohn64} contains two fundamental theorems that
concern the relationship between the electron density $n(\bm{r})$, external potential $V_{ext}(\bm{r})$,
and total energy $E[n]$, which is a functional of the electron density. A functional dependence means that for any distribution
of electrons in the entire space $n(\bm{r})$, one can uniquely determine the total energy
of the system $E[n]$. Let us write the Hamiltonian of the system of interacting electrons
in general form

\begin{equation}
H=-\frac{\hbar^2}{2m}\sum_{i}\nabla_i^2+V_\text{ext}(\bm{r})+\frac{1}{2}\sum_{i\neq j}\frac{e^2}{|\bm{r}_i-\bm{r}_j|}.
\label{hamil}
\end{equation}
%
The Hohenberg-Kohn theorems can be formulated as follows:

{\bf Theorem I:}
The external potential of a system of interacting electrons $V_\text{ext}$ is uniquely determined (up to an additive constant)
by the ground state electron density $n_0(\mb{r})$.

{\bf Theorem II:}
For a fixed external potential $V_\text{ext}(\bm{r})$, the energy functional $E[n]$ reaches
its minimum value $E_0$ for the ground state electron density $n_0(\bm{r})$.

From these theorems follow the following conclusions. Since the Hamiltonian is uniquely determined (up to a constant)
by $n_0(\bm{r})$, the wave functions of all electronic states,
as well as all properties of the system are completely determined by the ground state electron density.
Knowledge of the energy functional $E[n]$ is sufficient to determine the energy and electron density
of the ground state. 

\section{Kohn-Sham Equation}

The Kohn-Sham theorems allow us to rigorously relate the ground state electron density
to the Schr\"{o}dinger equation for a system of interacting electrons, described by the Hamiltonian (\ref{hamil}).
In practice, it is not possible to directly solve the Schr\"{o}dinger equation and determine many-body wave functions.
Density functional theory allows us to replace the many-body equation with a new equation, called the Kohn-Sham equation, which has
the form of an equation for non-interacting particles in an effective field $V_{eff}$.
Knowing the single-electron solutions of the Kohn-Sham equation $\psi_i^{\sigma}(\bm{r})$, dependent on position and spin,
we can determine the electron density at each point
%
\begin{equation}
n(\bm{r})=\sum_{i,\sigma} f_{i\sigma}|\psi_i^{\sigma}(\bm{r})|^2,
\label{density}
\end{equation}
%
where for simplicity the index $i$ determines both the state number $j$ and the wave vector $\bm{k}$, and $f_{i\sigma}$ are occupation numbers
of states, which in the general case may take fractional values, e.g., according to the Fermi-Dirac distribution.
We also assume that the elementary charge $e=1$, which means that the charge density is identical to the electron density.
The Kohn-Sham theorems ensure that the effective potential $V_{eff}$ is uniquely
determined by the electron density, as well as that the total energy functional reaches
a minimum for the ground state electron density.
Therefore, we can determine the ground state of the system if we know the energy functional and can
find its minimum. In general, we can write this functional in the form
%
\begin{equation}
E[n]=T[n] + E_\text{ext}[n] + E_\text{H}[n] + E_\text{xc}[n],
\label{EKS}
\end{equation}
%
where $T[n]$ is the kinetic energy of non-interacting electrons
%
\begin{equation}
T[n]=-\frac{\hbar^2}{2m}\sum_{i,\sigma} \int d\bm{r} \psi^{\sigma *}_i(\bm{r})\nabla_i^2 \psi^{\sigma}_i(\bm{r}),
\end{equation}
%
$E_\text{ext}[n]$ is the interaction energy with the external potential
%
\begin{equation}
E_\text{ext}[n]=\int d\bm{r} V_\text{ext}(\bm{r}) n(\bm{r}),
\end{equation}
%
$E_\text{H}[n]$ is the Hartree energy given by formula (\ref{Hartree}), and $E_\text{xc}[n]$ contains all remaining interactions,
i.e., exchange interaction and electron correlations, as well as the difference between the kinetic energy of the system
of interacting and non-interacting electrons. In short, this term is called the exchange-correlation functional.

We can now apply the variational approach taking into account the orthonormality condition
of Kohn-Sham orbitals: $\langle\psi_i^{\sigma *}|\psi_j^{\sigma'}\rangle = \delta_{ij}\delta_{\sigma\sigma'}$
and introducing Lagrange multipliers
%
\begin{equation}
\frac{\delta}{\delta\psi_i^{\sigma *}}(E[n]-\sum_{i,\sigma}\varepsilon_{i\sigma}[\int d\bm{r} \psi_i^{\sigma *}(\bm {r})\psi_i^{\sigma}(\bm{r})-1]) = 0.
\label{delta}
\end{equation}
%
Substituting the energy functional in the form (\ref{EKS}) into (\ref{delta}), we obtain
%
\begin{equation}
\frac{\delta T[n]}{\delta \psi_i^{\sigma *}}+\frac{\delta}{\delta n}(\int d\bm{r} V_{ext}(\bm{r}) n(\bm{r}) + E_H[n] + E_{xc}[n])\frac{\delta n}{\delta \psi_i^{\sigma *}}-\varepsilon_{i\sigma} \frac{\delta}{\delta\psi_i^{\sigma *}}\sum_{j,\sigma'}\int d\bm{r} \psi_j^{\sigma' *}\psi_j^{\sigma}=0,
\end{equation}
%
where we applied the formula for the derivative of a composite function:
%
\begin{equation}
\frac{\delta}{\delta \psi_i^{\sigma *}}=\frac{\delta}{\delta n}\frac{\delta n}{\delta \psi_i^{\sigma *}}.
\end{equation}
%
Performing the variational derivatives, we obtain the Kohn-Sham equation
%
\begin{equation}
[-\frac{\hbar^2\nabla_i^2}{2m}+V_{KS}(\bm{r})]\psi_i^{\sigma}(\bm{r})=\varepsilon_{i\sigma}\psi_i^{\sigma}(\bm{r}),
\end{equation}
%
which has the form of a single-particle Schr\"{o}dinger equation with the Kohn-Sham potential composed of three terms
%
\begin{equation}
V_{KS}(\bm{r})=V_{ext}(\bm{r})+V_H(\bm{r})+V_{xc}(\bm{r})=V_{ext}(\bm{r})+\int d\bm{r'} \frac{n(\mb{r}')}{|\bm{r}-\bm{r'}|}+\frac{\delta E_{xc}[n]}{\delta n}.
\label{VKS}
\end{equation}
%
In this potential, the exchange-correlation energy is not known exactly and must be approximated
by appropriate methods, which will be discussed in subsequent chapters.
Knowing the energy spectrum of solutions to the Kohn-Sham equation, the ground state energy can be expressed in the form
%
\begin{equation}
E[n,f_i]=\sum_{i\sigma}f_{i\sigma} \varepsilon_{i\sigma} - \int d\bm{r} n(\bm{r})V_{KS}(\bm{r}) + \int d\bm{r} V_{ext}(\bm{r}) n(\bm{r}) + E_H[n] + E_{xc}[n].
\end{equation}
%
The single-electron functions and energies of Kohn-Sham states $\varepsilon_{i\sigma}$ do not have an unambiguous physical interpretation.
However, they can be related to the change in total energy upon changing the occupation of states
%
\begin{equation}
\frac{\partial E}{\partial f_{i\sigma}}=\Big(\frac{\partial E}{\partial f_{i\sigma}}\Big)_n+\int d\bm{r} \frac{\delta E}{\delta n}\frac{\partial n}{\partial f_{i\sigma}}.
\label{janak}
\end{equation}
%
The second term on the right side of the equation vanishes for the ground state ($\delta E/\delta n=0$),
which leads to the formula
%
\begin{equation}
\varepsilon_{i\sigma}=\frac{\partial E}{\partial f_{i\sigma}},
\end{equation}
%
which is called Janak's theorem \cite{janak}.
Application of this formula to the highest occupied electronic state gives the ionization energy, i.e., the energy required to remove a single electron
from a given atomic system. 


\section{Exchange-Correlation Functional}

\subsection{Local Density Approximation (LDA)}

The exchange-correlation functional $E_{xc}$ and the corresponding potential $V_{xc}$ are not known exactly and within the framework of density functional theory must be described in an approximate manner.
The simplest approach is the local density approximation (LDA).
In the LDA approximation, we assume that the exchange-correlation energy at each point in space, where the electron density is $n(\mb{r})$,
is equal to the exchange-correlation energy of a homogeneous electron gas with the same density, $n=n(\mb{r})$.
The exchange-correlation functional can then be written in the form
%
\begin{equation}
E_{xc}[n]=\int d\mb{r} n(\mb{r}) \varepsilon_{xc}(n),
\end{equation}
%
where $\varepsilon_{xc}(n)$ is the exchange-correlation energy per electron in a homogeneous electron gas with density $n$.
It can be written as the sum of exchange and correlation parts, $\varepsilon_{xc}(n)=\varepsilon_x(n)+\varepsilon_c(n)$.
The LDA approximation is exact in the limit of slowly varying density, which corresponds to the condition
%
\begin{equation}
\frac{q}{k_F}\ll 1,
\end{equation}
%
where $q$ is a measure of the system's inhomogeneity
%
\begin{equation}
q=\frac{|\nabla k_F|}{2k_F},
\end{equation}
%
and $k_F$ corresponds to the Fermi wave vector for a homogeneous gas, which at a point with local density $n(\bm{r})$ is given by the formula
%
\begin{equation}
k_F=[3\pi^2n(\bm{r})]^{1/3}.
\end{equation}
%

This approximation can be easily generalized to systems with spin polarization. Then the exchange-correlation energy is a functional
of the spin-up density $n_{\uparrow}$ and spin-down density $n_{\downarrow}$
%
\begin{equation}
E_{xc}[n^{\uparrow},n^{\downarrow}]=\int d\bm{r} n(\mb{r}) \varepsilon_{xc}(n_{\uparrow},n_{\downarrow}).
\label{xclda}
\end{equation}
%
This generalization is sometimes called the local spin density (LSD) approximation.
The spin-dependent exchange-correlation potential for spin $\sigma$ in this approximation is determined by the relation
%
\begin{equation}
V^{\sigma}_{xc}=\frac{\delta E_{xc}}{\delta n_{\sigma}}=\varepsilon_{xc}+n_{\sigma}\frac{\partial \varepsilon_{xc}}{\partial n_{\sigma}}.
\end{equation}
%
According to formula (\ref{exchange}), the exchange part is given by the formula
%
\begin{equation}
\varepsilon_x(n_{\sigma})=-\frac{3}{4}\Big(\frac{3}{\pi}\Big)^{\frac{1}{3}}n_{\sigma}^\frac{1}{3},
\end{equation}
%
which leads to the exchange potential in the form
%
\begin{equation}
V^{\sigma}_x=-\Big(\frac{3}{\pi}\Big)^{\frac{1}{3}}n_{\sigma}^\frac{1}{3}.
\label{Vex}
\end{equation}
%
The correlation part can be determined very accurately numerically using the quantum Monte Carlo method \cite{CeperleyAlder80}.
In practice, appropriate analytical expressions are used that are fitted to numerical results, which determine the dependence of correlation energy
on electron density \cite{PZ,VWN}.
For example, the correlation energy in the Perdew-Zunger parametrization \cite{PZ} has the form
%
\begin{eqnarray}
\varepsilon_c(r_s)&=&-0.048+0.031 \ln(r_s) -0.0116 r_s+0.002r_s \ln(r_s), \quad r_s<1  \\
             &=&-0.1423/(1+1.0529\sqrt{r_s}+0.3334 r_s), \quad r_s>1.
\end{eqnarray}
%

\subsection{Generalized Gradient Approximation (GGA)}
\label{sec:GGA}

Including local density changes through expansion of the exchange-correlation energy in a series of density gradients
was already proposed in the 1965 work of Kohn and Sham \cite{kohn65}. However, this approach does not satisfy sum rules and breaks down for most atomic systems,
in which electron density changes are usually very large.
A new approach called the generalized gradient approximation (GGA) was proposed,
where the exchange-correlation energy is a functional of the electron density and its gradients \cite{Langreth83,Pardew86,Becke88}.
In the general form for a spin-polarized system, it can be written as
%
\begin{equation}
E_{xc}[n_{\uparrow},n_{\downarrow}]=\int d\mb{r} f(n_{\uparrow},n_{\downarrow},\nabla n_{\uparrow},\nabla n_{\downarrow})
\label{xcgga}
\end{equation}
%
The exchange part of this functional for a system without spin polarization can be written as
%
\begin{equation}
E_x[n]=\int d\mb{r} n \varepsilon_x(n) F_x(s),
\end{equation}
%
where $s=|\nabla n|/2k_Fn$ is the scaled (dimensionless) gradient of the electron density. Extension to systems with spin polarization is obtained using the following formula,
which is satisfied for the exact exchange energy
%
\begin{equation}
E_x[n^{\uparrow},n^{\downarrow}]=\frac{1}{2}(E_x[2n^{\uparrow}]+E_x[2n^{\downarrow}]).
\end{equation}
%
Many forms of the function $F_x(s)$ have been proposed, including the most commonly used ones, which are described in the works: A. D. Becke (Becke88) \cite{Becke88},
J. P. Perdew and Y. Wang (PW91) \cite{PW91}, and J. P. Perdew, K. Burke, and M. Ernzerhof (PBE) \cite{PBE}.
As an example, I will discuss the PBE functional, which has a simple form and well-defined boundary conditions
that the function $F_x(s)$ must satisfy:

\begin{enumerate}

\item{In the limit of small gradient values ($s\rightarrow0$),
the condition is satisfied
%
\begin{equation}
F_x(s)\rightarrow 1+\mu s^2,
\end{equation}
%
where $\mu =0.219$. This condition ensures the proper behavior of the linear response of the homogeneous electron gas (linear contributions from exchange and correlation energies cancel).}

\item{For large gradient values ($s\rightarrow\infty$), the function is bounded from above $F_x(s)\leq 1.804$.}

The function that satisfies these conditions has the form
%
\begin{equation}
F_x(s)=1+\kappa-\frac{\kappa}{1+\frac{\mu s^2}{\kappa}},
\end{equation}
%
where $\kappa=0.804$.
\end{enumerate}

The correlation part can be written in the general form
%
\begin{equation}
E_c[n^{\uparrow},n^{\downarrow}]=\int d\mb{r} n [\epsilon_c(r_s,\zeta)+H(r_s,\zeta,t)],
\end{equation}
%
where $\zeta=(n^{\uparrow}-n^{\downarrow})/n$ is the relative spin polarization, $t=|\nabla n|/2\phi k_s n$ is the dimensionless gradient,
$\phi=\sqrt{(1+\zeta)^{2/3}+(1-\zeta)^{2/3})}/2$ is the spin scaling function, and $k_s=\sqrt{4k_F/\pi a_0}$ is the Thomas-Fermi screening vector.
The function $H$ satisfies the following conditions:

\begin{enumerate}
\item{For small gradients ($t\rightarrow 0$), the function is given by the second-order expansion term
%
\begin{equation}
H\rightarrow \frac{e^2}{a_0}\beta\phi^3 t^2,
\end{equation}
%
where $\beta=0.067$.}
\item{For rapidly varying densities ($t\rightarrow \infty$), the correlation energy vanishes,
which is satisfied by the condition
%
\begin{equation}
H\rightarrow -\epsilon_c.
\end{equation}}
%
\item{In the limit of high densities ($r_s\rightarrow 0$), the correlation energy approaches a constant value.
The function $H$ must cancel the logarithmic singularity in $\epsilon_c$
%
\begin{equation}
H\rightarrow \frac{e^2}{a_0}\gamma\phi^3 \ln t^2,
\end{equation}
%
where $\gamma=0.031$.}
\end{enumerate}

These conditions are satisfied by the function in the form
%
\begin{equation}
H=\frac{e^2}{a_0}\gamma\phi^3\ln[1+\frac{\beta}{\gamma}t^2\frac{1+At^2}{1+At^2+A^2t^4}],
\end{equation}
%
where
%
\begin{equation}
A=\frac{\beta}{\gamma}[\exp\{-\epsilon_c/(\gamma\phi^3e^2/a_0)\}-1]^{-1}.
\end{equation}


Table \ref{EXC} compares the values of exchange and correlation energies in the LDA and PBE approximations
with exact values determined for several selected atoms. The absolute values of exchange energy are greater
by about an order of magnitude than the correlation energy. In LDA, the exchange energy is underestimated on average by $10\%$, and the correlation energy is significantly overestimated,
even above $100\%$, compared to exact values. Due to the opposite signs of deviations from exact values, the errors of exchange
and correlation energies in the LDA approximation partially cancel.

\begin{table}[h!]
\caption{Comparison of exchange and correlation energies obtained in several approximations with exact values for several selected atoms.}
\label{EXC}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
 & \multicolumn{2}{c|}{LDA} & \multicolumn{2}{c|}{PBE} & \multicolumn{2}{c|}{Exact value} \\ \hline
Atom& $E_x$ & $E_c$ & $E_x$ & $E_c$  & $E_x$  & $E_c$ \\
\hline
  H & -0.2680 & -0.0222 &  -0.3059 & -0.0060 & -0.3125 & 0.0000\\
  He & -0.8840 & -0.1125 &  -1.0136 & -0.0420 & -1.0258 & -0.0420\\
  Be & -2.3124 & -0.2240 &  -2.6358 & -0.0856 & -2.6658 & -0.0950\\
  N &  -5.9080 & -0.4268 &  -6.5521 & -0.1799 & -6.6044 & -0.1858\\
  Ne & -11.0335 & -0.7428 &  -12.0667 & -0.3513 & -12.1050 & -0.3939\\ \hline
\end{tabular}
\end{center}
\end{table}

These large differences in exchange and correlation energies result from neglecting the influence of local changes
in electron density, which are characteristic of atoms and molecules \cite{Pardew92}.
In the GGA approximation, the values of both energies improve. The exchange energy is still underestimated, but only
at the level of $\sim 1\%$. The correlation energy in the hydrogen atom is significantly reduced compared to LDA,
and for the helium atom it is very well reproduced. In the other cases shown in Table \ref{EXC}, it is smaller
than the exact value by a few percent.

The GGA functional in the limit of zero gradients, i.e., for a homogeneous electron gas, is equivalent to the LDA approximation.
This means that for inhomogeneous systems it should always give better results than LDA. However, this is not the case, which results
from the fact that for some systems the partial cancellation of exchange and correlation energy errors is greater in LDA than in GGA.
Examples are noble metals (Ag, Au, Pt), for which lattice constants determined in LDA agree very well
with experiment, while in GGA they are overestimated. Larger lattice constant values in the GGA approximation result from underestimated cohesive energies of crystals.
LDA usually gives overestimated values of cohesive energies and underestimated values of lattice constants.
For magnetic systems, i.e., those with open $d$ or $f$ shells, the GGA approximation usually gives better results than LDA.
A classic example is iron, for which the ground state in the LDA approximation is a face-centered cubic ($fcc$) structure
with antiferromagnetic ordering, while GGA gives the correct result, i.e., a body-centered cubic ($bcc$) structure with ferromagnetic ordering.

\section{Iterative Procedure}

The Kohn-Sham (KS) equations are solved by an iterative method, whose successive steps are shown in Figure \ref{fig:diagram}.
Generally used procedures allow minimization of the total energy functional for given atomic positions,
as well as determination of atomic positions and crystal lattice parameters that correspond to the minimum of the total energy
of the system. First, we establish initial atomic positions, which can be taken, for example, from
diffraction experiment data. With fixed atomic positions, an initial
electron density distribution $n_0(\bm{r})$ is assumed, for which the potential is calculated from formula (\ref{VKS}).
For this potential, the KS equations are solved and single-electron wave functions are determined
in an appropriately chosen functional basis.

\begin{figure}[h]
\centering
\includegraphics[scale=0.45]{diagram.pdf}
\caption{Schematic of the iterative procedure for solving the Kohn-Sham equations.}
\label{fig:diagram}
\end{figure}

Solving the KS equations for atoms in a solid is a complex problem and will be discussed in subsequent chapters.
Knowing the wave functions and eigenvalues of the KS equation, the electron density at each point in space is determined
from relation (\ref{density}) and the total energy of the system.
The new density distribution allows us to recalculate the KS potential and solve the KS equations. We obtain a new density distribution and modified
total energy. If this energy coincides with the energy in the previous
step or these energies differ by a small amount (defined at the beginning of the calculations), it means that
we have obtained a properly converged density distribution. This completes the electronic loop,
which gives the solution of the KS equations and the minimum total energy for given atomic positions.

The minimization procedure can be accelerated by appropriately using electron densities
at each iterative step. In the simplest approach, the initial value of the electron density $n^p_{i+1}$ in step $i+1$
can be determined as a linear correction to the density from the previous step
%
\begin{equation}
n^p_{i+1}=n^p_i+\alpha(n^k_i-n^p_i),
\label{mixing}
\end{equation}
%
where $\alpha$ is a linear coefficient, $n^p_i$ and $n^k_i$ are the initial and final values of density in step $i$.
A constant value of the coefficient $\alpha$ does not give optimal convergence speed.
In the most commonly used Broyden method, the linear coefficient is determined from the Jacobian of the system $J_i$,
which is optimized at each iteration step, $\alpha=-J^{-1}_i$.

To optimize the system with respect to atomic positions, atoms should be appropriately moved
to new positions so that the total energy decreases in subsequent steps.
The very effective conjugate gradient method is used for this,
which is also an iterative method (ionic loop).
In each step of this procedure, a complete electronic optimization is performed to determine the electron density distribution
and the system energy for the current atomic positions. The determined final density is used to determine
the starting density in the next step of the ionic loop according to formula (\ref{mixing}).
The convergence condition is reaching a state of minimum energy with respect to atomic positions
and crystal lattice parameters. According to the most commonly adopted criterion, convergence is achieved if the difference in total energy
in two consecutive ionic steps is less than the value specified at the beginning.

The ground state obtained as a result of the minimization procedure should satisfy the equilibrium conditions of the studied material.
These conditions are as follows:

\begin{enumerate}
{\item
The total force acting on each atom vanishes.
Forces acting on atoms can be determined using the Hellmann-Feynman theorem \cite{Hellmann,Feynman},
which states that the force acting on atom $i$ is equal to the derivative of the total energy with respect to the position
of that atom taken with the opposite sign
%
\begin{equation}
\bm{F_i}=-\frac{\partial E_{tot}}{\partial\bm{R_i}}.
\end{equation}
%
According to this formula, in the ground state, which corresponds to an energy minimum, all forces $\bm{F_i}$ are equal to zero.
The values of forces often constitute an additional convergence criterion of the system in the optimization procedure:
convergence is achieved if the largest force acting on atoms is less than a specified value.}

{\item The macroscopic stress in the system is equal to the stress caused by external pressure.
The average stress tensor is determined by the derivative of the total energy with respect to the strain tensor
%
\begin{equation}
\sigma_{\alpha\beta}=-\frac{1}{V}\frac{\partial E}{\partial u_{\alpha\beta}}.
\end{equation}
where $V$ is the volume of the system. The strain tensor is a symmetric tensor of derivatives of the displacement vector
$\bm{u}=\bm{r}-\bm{r'}$ with respect to position $\bm{r}$.
Under hydrostatic compression, the pressure is related to the stress tensor by $P=-\frac{1}{2}\sum_{\alpha}\sigma_{\alpha\alpha}$.}
\end{enumerate}



\chapter{Methods for determining electronic structure}

\section{General characteristics}

The most important methods for calculating band structure are based on DFT theory and rely on
determining single-particle wave functions by solving the Kohn-Sham equations
or similar equations containing an effective electronic potential.  
The fundamental element distinguishing different methods is the choice of basis functions, 
which are used to expand the wave functions throughout the entire crystal volume or in its individual parts. 
The most natural basis in a periodic crystal consists of plane waves, and calculations in this basis are very efficient and easy to implement. 
Unfortunately, they are not suitable for describing electrons throughout the entire crystal volume and all electronic states.
Electrons that are located closest to atomic nuclei and occupy the lowest energy states 
are part of the atomic core.
In the region of atomic cores, the electric potential is strongly attractive and similar to the atomic potential.
As a result, electronic states located close to the atomic nucleus behave similarly to atomic orbitals, that is 
they strongly oscillate and change sign. This also means that the kinetic energy of electrons in this region is large.
The wave functions of core states are strongly localized and decay rapidly with distance. 
In this case, much better convergence is achieved using a basis of localized functions, such as spherical harmonics.
The wave function of valence electrons behaves differently in the region of atomic cores and in the interstitial region.
The periodic potential and wave function of valence electrons are shown schematically in Figure \ref{fig:bloch}.
In the core regions, marked by circles with radius $r_c$, the wave function, similarly to core states,
changes very rapidly.
In the interstitial region ($r>r_c$), the potential and electron density vary slowly as a function of position. 
The wave function of valence electrons in this region is also slowly varying, and 
in this case rapid convergence can be achieved in the expansion in plane waves. 


\begin{figure}[h!]
\centering
\includegraphics[scale=0.5]{crystal.pdf}
\caption{Periodic potential and wave function of valence electrons.}
\label{fig:bloch}
\end{figure}

\newpage

The most important methods for determining band structure can be divided into three main groups:


\begin{enumerate}
\item{{\bf Pseudopotentials.} This is a group of methods that limits the number of electrons and solutions of the Kohn-Sham equation to valence states only. 
This is justified by the nature of core states, which are strongly localized near the atomic nucleus and do not participate in atomic bonding.
Therefore, the most important properties of materials are determined by the behavior of valence electrons. 
In the pseudopotential method, the wave function is expanded in a basis of plane waves. To maintain a uniform description of the wave function throughout the entire crystal volume, these methods use an approximate potential acting on valence electrons in the atomic core region, which is called the pseudopotential. 
For valence electrons, a pseudo-wave function is determined, which is a solution of the single-particle Schr\"{o}dinger equation with an appropriate pseudopotential. In the interstitial region it is equal to the exact wave function, while in the core region it is a slowly varying function without oscillations and zero
crossings. The most accurate calculations in this group of methods use ultrasoft pseudopotentials and PAW-type potentials.}
\item{{\bf Localized orbitals.} In this approach, the electronic wave function is written in a basis of orbitals localized on individual
atoms. In the simplest tight-binding approximation, the only significant parameters are the Hamiltonian matrix elements that
describe the overlap of local orbitals or Wannier functions. In more accurate calculations, Gaussian functions
or Slater orbitals are used as the basis.}
\item{{\bf Augmented waves and atomic spheres}. This group includes computational methods that are based on the general principle of dividing
the crystal into two regions. The first region contains atomic cores, in which wave functions retain the characteristics of atomic orbitals, and the second region between atoms,
where valence electrons are described by a slowly varying wave function. In each of the two characteristic regions,
expansions of the wave function in different functional bases are used. The atomic core region defines the value of radius $r_c$. Wave functions
obtained for distances smaller and larger than $r_c$ must satisfy appropriate continuity conditions at the boundary of the atomic core.}

\end{enumerate}

In the following sections, computational methods belonging to these three groups will be described.
  
\section{Pseudopotentials}

The main idea of the pseudopotential is illustrated in Figure \ref{fig:pseudopot}. In the atomic core region ($r<r_c$), the exact potential $V$ is approximated
by the pseudopotential $\tilde{V}$, which has a finite value at $r=0$. The corresponding pseudo-wave function $\tilde{\psi}$
has smooth behavior (without oscillations and zero crossings) in this region. For $r>r_c$, the pseudopotential coincides with the exact potential,
and the pseudo-wave function corresponds to the exact wave function $\psi$. Thanks to this approximation, the pseudo-wave function can be expanded
in plane waves throughout the entire crystal volume.   

  
\begin{figure}[h!]
\centering
\includegraphics[scale=0.1]{pseudopots-new.pdf}
\caption{Pseudopotential and pseudo-wave function.}
\label{fig:pseudopot}
\end{figure}  
  
The pseudopotential method developed from the orthogonalized plane waves (OPW) approach
proposed by Herring in 1940 \cite{herring40}. 
One can define a transformation that leads from the exact potential to the pseudopotential, while introducing the pseudo-wave function to describe valence electrons \cite{Antoncik,KP}.
We introduce separate notations for valence states $|\psi_v\rangle$ and core states $|\psi_c\rangle$, which are eigenstates
of the Hamiltonian $H$ with corresponding eigenvalues $\varepsilon_v$ and $\varepsilon_c$.
We assume that the exact wave function of valence electrons can be expressed through a smooth function $\tilde{\psi}_v$ (pseudo-wave function),
which is orthogonal to the core states
%
\begin{equation}
|\psi_v\rangle =|\tilde{\psi}_v\rangle +\sum_{\alpha,c} a_{\alpha} |\psi_{\alpha c}\rangle,
\label{OPW}
\end{equation}
%
where the summation runs over atoms $\alpha$ and core states $c$. 
For simplicity of notation, the indices $v$ and $c$ denote both the state number and the electron spin direction.
The expansion coefficients are obtained from the orthogonality condition  
%
\begin{equation}
a_{\alpha}=-\langle \psi_{\alpha c}|\tilde{\psi}_v\rangle.
\label{a_alpha}
\end{equation}
% 
In the interstitial region, the exact wave function is equal to the pseudo-wave function, which can be expressed in a plane wave basis.
Inserting (\ref{OPW}) into the equation $H|\psi_v\rangle=\varepsilon_v|\psi_v\rangle$, we obtain
%
\begin{equation}
H|\tilde{\psi}_v\rangle +\sum_{\alpha,c} a_{\alpha} \varepsilon_{\alpha c} |\psi_{\alpha c}\rangle =
\varepsilon_v|\tilde{\psi}_v\rangle + \sum_{\alpha c} a_{\alpha} \varepsilon_v|\psi_{\alpha c}\rangle.
\end{equation}
%
Moving the second term to the right side and using (\ref{a_alpha}), we obtain
%
\begin{equation}
(H +\sum_{\alpha,c}(\varepsilon_v - \varepsilon_{\alpha c})|\psi_{\alpha c}\rangle \langle \psi_{\alpha c}|)|\tilde{\psi}_v\rangle =
\varepsilon_v|\tilde{\psi}_v\rangle.
\end{equation}
%
We have obtained a Schr\"{o}dinger-type equation with an additional potential 
%
\begin{equation}
V^{R}=\sum_{\alpha,c}(\varepsilon_v - \varepsilon_{\alpha c})|\psi_{\alpha c}\rangle \langle \psi_{\alpha c}|.
\end{equation}
%
If we add this expression to the original potential $V$, we obtain a quantity called the pseudopotential $\tilde{V}=V+V^{R}$.
In the valence region, the pseudopotential $\tilde{V}$ coincides with the potential $V$.  
The strongly attractive atomic potential in the core region is significantly weakened by the positive value of $V^R$.
This enables convergence of the pseudo-wave function in the plane wave basis. 


\subsection{Norm-conserving pseudopotentials}

Good pseudopotentials have a universal character. Generated in a specific atomic configuration,
they should behave equally well in any other atomic arrangement. 
In 1979, Hamann, Schl\"{u}ter, and Chiang \cite{HSC} proposed norm-conserving pseudopotentials 
that satisfied the following conditions:

\begin{enumerate}
{\item The true wave function and pseudo-wave function are equal, $\psi_i(r)=\tilde{\psi}_i(r)$, for $r\geq r_c$.}
{\item Their eigenvalues for valence electrons should be equal.}
{\item The true charge and pseudo-charge contained in a region with radius $r\geq r_c$ should coincide (norm conservation)
%
\begin{equation}
\int_0^r dr r^2 |\psi_i(r)|^2=\int_0^r dr r^2 |\tilde{\psi}_i(r)|^2.
\end{equation}}
%
{\item The logarithmic derivative of the true wave function and pseudo-wave function are equal for $r\geq r_c$ 
%
\begin{equation}
\frac{1}{\psi_i(r)}\frac{d\psi_i(r)}{dr}=\frac{1}{\tilde{\psi}_i(r)}\frac{d\tilde{\psi}_i(r)}{dr}.
\end{equation}}

\end{enumerate} 
%
From these properties also follows the condition of equal energy derivatives of the exact wave function and pseudo-wave function for $r\geq r_c$,
which additionally reinforces the transferable character of these pseudopotentials.
Methods for generating norm-conserving pseudopotentials have been described in detail in many works \cite{HSC,BHS}.

Since pseudopotentials in the core region depend on the orbital quantum number $l$, their character is not local.
The value of the characteristic radius $r_c$ also depends on $l$.
In general, the entire pseudopotential can be divided into a local and nonlocal part
%
\begin{equation}
V_l(r)=V_{lok}(r)+\delta V_l(r).
\end{equation}
%
The nonlocal character concerns only the core region, so $\delta V_l(r)=0$ for $r>r_c$
and all long-range effects depend only on $V_{lok}(r)$.
The possibility of choosing the radius $r_c$ gives some freedom in the construction of pseudopotentials.
More accurate and more universal pseudopotentials are characterized by smaller values
of $r_c$. However, greater accuracy requires including a larger number of plane waves
in the expansion of the pseudo-wave function. Such pseudopotentials are called hard. Soft pseudopotentials are characterized by
larger values of $r_c$, a smaller number of plane waves, and a smoother character of the pseudo-wave function. 

\subsection{Ultrasoft pseudopotentials}

In 1990, Vanderbilt proposed a new type of pseudopotentials, called ultrasoft pseudopotentials (US-PP), which do not conserve the norm \cite{Vanderbilt90}. In this approach, the pseudo-wave functions satisfy a generalized eigenvalue equation in the form
%
\begin{equation}
H|\tilde{\psi}_i\rangle=\varepsilon_iS|\tilde{\psi}_i\rangle,
\end{equation}
%
where the Hamiltonian has the general form 
%
\begin{equation}
H=-\frac{\hbar^2}{2m}\nabla^2+V_{lok}+\delta V_{NL}, 
\end{equation}
and $S$ is the overlap operator
%
\begin{equation}
S=1+\sum_{i,j} Q_{ij}|\beta_i\rangle\langle\beta_j|,
\end{equation}
%
which determines the generalized normalization condition for the pseudo-wave functions $\langle\tilde{\psi}_i|S|\tilde{\psi}_j\rangle=\delta_{ij}$.
The matrix $Q_{ij}$ describes the difference in normalization of the wave functions and pseudo-wave functions
%
\begin{equation}
Q_{ij}=\int_0^{r_c} dr Q_{ij}(\bm{r})=\int_0^{r_c} dr r^2[\psi_i^*(\bm{r})\psi_j(\bm{r})-\tilde{\psi}_i^*(\bm{r})\tilde{\psi}_j(\bm{r})].
\end{equation}
%
The set of local wave functions
%
\begin{equation}
|\beta_i\rangle=\sum_j (B^{-1})_{ij}|\chi_j\rangle,
\end{equation}
%
where the functions 
%
\begin{equation}
|\chi_j\rangle=(\varepsilon_i+\frac{\hbar^2}{2m}\nabla^2-V_{loc})|\tilde{\psi}_j\rangle
\end{equation}
%
vanish in the region for $r>r_c$. 
The nonlocal part of the pseudopotential is obtained from the formula
%
\begin{equation}
\delta V_{NL}=\sum_{ij}D_{ij}|\beta_i\rangle\langle\beta_j|,
\end{equation}
%
where $D_{ij}=B_{ij}+\varepsilon_j Q_{ij}$. The total valence electron density
at a given point in space is obtained from the formula 
%
\begin{equation}
n_v(\bm{r})=\sum_i \tilde{\psi}_i^*(\bm{r})\tilde{\psi}_i(\bm{r})+\sum_{i,j}\sum_k\langle\beta_i|\tilde{\psi}_k\rangle\langle\tilde{\psi}_k|\beta_j\rangle Q_{ij}(\bm{r}),
\end{equation}
% 
where the second term is a correction resulting from the non-conservation of the norm by the pseudo-wave functions.


\begin{figure}[h]
\centering
\includegraphics[scale=1]{usp.pdf}
\caption{Comparison of the exact $2p$ wave function for oxygen (solid line) with a norm-conserving pseudo-wave function (dotted line)
and a pseudo-wave function obtained for an ultrasoft pseudopotential (dashed line). Figure from \cite{Vanderbilt90}.}
\label{fig:ups}
\end{figure}

Figure \ref{fig:ups} shows the exact wave function for the $2p$ orbital in oxygen and two pseudo-wave functions obtained for a norm-conserving pseudopotential and an ultrasoft pseudopotential. The cutoff radius is clearly larger for the ultrasoft pseudopotential ($r_c\approx1.5$ a.u.) than for the norm-conserving one ($r_c\approx0.5$ a.u.).

\subsection{PAW method}

The discussed pseudopotential methods allow efficient calculation of many physical quantities based on pseudo-wave functions.
In many cases, more accurate calculations require knowledge of the wave functions of valence electrons
also in the atomic core region.
In 1994, Bl\"{o}chl proposed a new method, PAW (projector augmented-wave),
which combines the efficiency of pseudopotentials with calculation accuracy comparable to all-electron methods \cite{Blochl}. 
To describe valence electrons, this approach also uses pseudo-wave functions $\tilde{\psi}_v$, which are expanded in plane waves and 
in the interstitial region coincide with the exact functions $\psi_v$.
The main advantage of this method is the possibility of determining the exact wave function through a linear transformation of the pseudo-wave function
%
\begin{equation}
|\psi_v\rangle=\mathcal{T}|\tilde{\psi}_v\rangle.
\end{equation}
% 
The linear operator $\mathcal{T}$ acts in regions enclosed by a sphere of radius $r_c$ around atoms at positions $\bm{R}_m$
%
\begin{equation}
\mathcal{T}=1+\sum_m \mathcal{T}_m.
\label{operator}
\end{equation}
% 
The exact wave function and pseudo-wave function are expanded in the atomic region into partial waves $|\phi_m\rangle$ and $|\tilde{\phi}_m\rangle$
%
\begin{eqnarray}
|\psi_v\rangle=\sum_m c_m |\phi_m\rangle, \label{eq1}\\
|\tilde{\psi_v}\rangle=\sum_m c_m |\tilde{\phi}_m\rangle,
\label{eq2}
\end{eqnarray}
%
where the same expansion coefficients $c_m$ appear in both sums. Therefore, these local functions are related by the same
transformation
%
\begin{equation}
|\phi_m\rangle=(1+\sum_m \mathcal{T}_m)|\tilde{\phi}_m\rangle.
\end{equation}
%
The functions $|\phi_m\rangle$ are solutions of the Schr\"{o}dinger equation for the exact atomic potential, corresponding to energies $\varepsilon_m$
and orthogonal to core states. The index $m$ simultaneously determines the positions of atoms $\bm{R}$ and the set of quantum numbers of atomic orbitals.
Each exact partial wave corresponds to one pseudo-wave function $|\tilde{\phi}_m\rangle$, with which it coincides outside a sphere of radius $r_c$.
Both types of partial functions are radial functions, defined on a logarithmic radial grid, multiplied by
spherical harmonics. 

Subtracting (\ref{eq1}) and (\ref{eq2}) term by term, we obtain
%
\begin{equation}
|\psi_v\rangle=|\tilde{\psi}_v\rangle-\sum_m c_m |\tilde{\phi}_m\rangle + \sum_m c_m |\phi_m\rangle.
\label{psiv}
\end{equation}
% 
For the operator $\mathcal{T}$ to be linear, the coefficients $c_m$ must be linear functionals of the pseudo-wave function $|\tilde{\psi}_v\rangle$
%
\begin{equation}
c_m=\langle\tilde{p}_m|\tilde{\psi}_v\rangle,
\label{coef}
\end{equation}
%
where $\langle\tilde{p}_m|$ are projector functions dual to the partial waves 
$\langle\tilde{p}_m|\tilde{\phi}_n\rangle=\delta_{m,n}$.
For each function $|\tilde{\phi}_m\rangle$ we have one projector function $\langle\tilde{p}_m|$
and for them the condition $\sum_m |\tilde{\phi}_m\rangle\langle\tilde{p}_m|=1$ is satisfied.
The projector functions are radial functions multiplied by spherical harmonics, and then transformed to the plane wave basis.
They are assigned to atomic positions but do not depend on the atomic potential.
%
Inserting (\ref{coef}) into (\ref{psiv}) we obtain
%
\begin{equation}
|\psi_v\rangle=|\tilde{\psi}_v\rangle+\sum_m (|\phi_m\rangle-|\tilde{\phi}_m\rangle)\langle\tilde{p}_m|)\tilde{\psi}_v\rangle
=[1+\sum_m (|\phi_m\rangle-|\tilde{\phi}_m\rangle)\langle\tilde{p}_m|]|\tilde{\psi}_v\rangle,
\label{psiv2}
\end{equation}
%
where the expression in square brackets is the linear operator introduced earlier
%
\begin{equation}
\mathcal{T}=1+\sum_m \mathcal{T}_m=1+\sum_m (|\phi_m\rangle-|\tilde{\phi}_m\rangle)\langle\tilde{p}_m|.
\end{equation}
%

The core wave functions $|\psi_c\rangle$, similarly to valence functions, are decomposed into three components
%
\begin{equation}
|\psi_c\rangle=|\tilde{\psi}_c\rangle+|\phi_c\rangle-|\tilde{\phi}_c\rangle,
\end{equation}
%
where the successive terms correspond to the pseudo-wave function of core electrons, which coincides with the exact function for $r>r_c$,
the local (partial) core function, and the local core pseudo-wave function. Both local functions are expressed as radial functions
multiplied by spherical harmonics.

The expectation value of operator $A$ can be determined using exact functions or pseudo-wave functions
%
\begin{equation}
\langle A \rangle = \sum_n f_n \langle \psi_n|A|\psi_n\rangle = \sum_n f_n \langle \tilde{\psi}_n|\tilde{A}|\tilde{\psi}_n\rangle,
\end{equation}
% 
where $f_n$ determines the occupation of state $n$, and $\tilde{A}$ is a pseudo-operator that can be obtained by transforming operator $A$
%
\begin{equation}
\tilde{A}=\mathcal{T}^{\dagger} A \mathcal{T}= A +\sum_{i,j} |\tilde{p}_i\rangle (\langle \phi_i |A|\phi_j\rangle - \langle \tilde{\phi}_i |A|\tilde{\phi}_j\rangle ) \langle\tilde{p}_j|.
\end{equation}
%
For example, applying these expressions to the density operator $n=|\bm{r}\rangle\langle\bm{r}|$,
we can express the electron density with the following expression
%
\begin{equation}
n(\bm{r})=\tilde{n}(\bm{r})+n^1(\bm{r})-\tilde{n}^1(\bm{r}),
\end{equation}
%
where
%
\begin{equation}
\tilde{n}(\bm{r})=\sum_n f_n \langle \tilde{\psi}_n|\bm{r}\rangle\langle \bm{r}| \tilde{\psi}_n\rangle=\sum_n f_n |\tilde{\psi_n}(\bm{r})|^2,
\end{equation}
%
\begin{equation}
n^1(\bm{r})=\sum_{n,i,j} f_n \langle \tilde{\psi}_n|\tilde{p}_i\rangle\langle\phi_i|\bm{r}\rangle\langle \bm{r}|\phi_j\rangle\langle\tilde{p}_j |\tilde{\psi}_n\rangle,
\end{equation}
%
\begin{equation}
\tilde{n}^1(\bm{r})=\sum_{n,i,j} f_n \langle \tilde{\psi}_n|\tilde{p}_i\rangle\langle\tilde{\phi}_i|\bm{r}\rangle\langle \bm{r}|\tilde{\phi}_j\rangle\langle\tilde{p}_j |\tilde{\psi}_n\rangle.
\end{equation}
%
In the above formulas, the summation includes both valence states and core states. 

The PAW method is currently one of the most accurate and efficient methods. It has been implemented
in programs such as the Vienna Ab Initio Simulation Package (VASP) \cite{Vasp,PawVasp} and Quantum Espresso \cite{QE}.


\section{Localized orbitals}

\subsection{Tight-binding method}

In contrast to pseudopotential methods, which use a plane wave basis, the methods described in this section
employ local orbitals that are associated with given atoms or centered at atomic positions.
The description using local orbitals is well suited to systems where localized electronic
states occur, but electron motion is possible through hops to neighboring atoms.
The simplest description of such systems is the tight-binding model.
Local atomic orbitals can be written as $\phi_{\alpha}(\bm{r}-\bm{R}_{\alpha})$, 
where the vector $\bm{R}_{\alpha}$ denotes the position of a given atom. The index $\alpha$ here denotes all quantum numbers 
that characterize a given orbital ($\alpha=n,l,m$). For simplicity, we assume that only
one orbital is associated with a given atom, but the tight-binding model can easily be generalized to any number of orbitals.
The Hamiltonian can be written as
%
\begin{equation}
H=-\frac{\hbar^2}{2m}\nabla^2+\sum_{\alpha}V_{\alpha}(\bm{r}-\bm{R}_{\alpha}),
\end{equation}
%
where $V_{\alpha}$ is the atomic potential around position $\bm{R}_{\alpha}$.
The matrix elements of the Hamiltonian can be determined from the formula
%
\begin{equation}
H_{\alpha\beta}=\int d\bm{r} \phi_{\alpha}^*(\bm{r}-\bm{R}_{\alpha})H\phi_{\beta}(\bm{r}-\bm{R}_{\beta}).
\label{matrix}
\end{equation}
% 
Since atomic orbitals belonging to different atoms are not mutually orthogonal,
an overlap matrix is also introduced
%
\begin{equation}
S_{\alpha\beta}=\int d\bm{r} \phi_{\alpha}^*(\bm{r}-\bm{R}_{\alpha})\phi_{\beta}(\bm{r}-\bm{R}_{\beta}).
\end{equation}
%
The diagonal elements of the Hamiltonian $\varepsilon_{\alpha}=H_{\alpha\alpha}$ determine the local energy of the electron in a given orbital $\alpha$.
The off-diagonal elements $t_{\alpha\beta}=H_{\alpha\beta}$ are called hopping integrals and determine the probability
of electron hopping between two atoms.

To transform the matrix elements of the Hamiltonian and matrix $S$ to reciprocal space,
we introduce a basis that corresponds to wave vectors $\bm{k}$
%
\begin{equation}
\phi_{\bm{k}\alpha}(\bm{r})=A_{\alpha\bm{k}}\sum_n e^{i\bm{k}\bm{T}_n}\phi_{\alpha}[\bm{r}-(\bm{R}_{\alpha}+\bm{T}_n)],
\end{equation}
%
where $A_{\bm{k}\alpha}$ are normalization factors, and $\bm{T}_n$ are translation vectors of the crystal lattice.
In this basis, we can write the wave function that satisfies Bloch's theorem
%
\begin{equation}
\psi_{\bm{k}i}=\sum_{\alpha} c_{i\alpha} \phi_{\bm{k}\alpha}(\bm{r}),
\end{equation}
%
as well as matrix elements of the Hamiltonian and matrix $S$
%
\begin{equation}
H_{\alpha\beta}(\bm{k})=\int d\bm{r} \phi_{\alpha\bm{k}}^*(\bm{r})H\phi_{\beta\bm{k}}(\bm{r})=\sum_n e^{i\bm{k}\bm{T}_n} H_{\alpha\beta},
\end{equation}
%
\begin{equation}
S_{\alpha\beta}(\bm{k})=\int d\bm{r} \phi_{\alpha\bm{k}}^*(\bm{r})\phi_{\beta\bm{k}}(\bm{r})=\sum_n e^{i\bm{k}\bm{T}_n} S_{\alpha\beta}.
\end{equation}
%
The equation for eigenvalues $\varepsilon_i(\bm{k})$ and expansion coefficients of the wave function $c_{i,\alpha}(\bm{k})$ takes the form
%
\begin{equation}
\sum_{\beta}[H_{\alpha\beta}(\bm{k})-\varepsilon_i(\bm{k})S_{\alpha\beta}(\bm{k})]c_{i\beta}(\bm{k})=0.
\label{ham_loc} 
\end{equation}
%
For mutually orthogonal orbitals, we have $S_{\alpha\beta}=\delta_{\alpha\beta}$ and equation (\ref{ham_loc})
takes the same form as the equation in the plane wave basis (\ref{ham_rec}).

\subsection{Wannier functions}
\label{sec:wannier}

In the tight-binding method, a basis of Wannier functions is often used, which are localized functions 
centered at atomic positions $\bm{R}_n$. 
The Wannier function is defined as the Fourier transform of the Bloch function associated with a given band $j$
%
\begin{equation}
w_j(\bm{r}-\bm{R}_n)=\frac{1}{\sqrt{N}}\sum_{\bm{k}}e^{-i\bm{k}\bm{R}_n}\psi_{\bm{k}j}(\bm{r}). 
\end{equation}
%
The inverse transform is also satisfied, which allows expressing Bloch functions through Wannier
functions
%
\begin{equation}
\psi_{\bm{k}j}(\bm{r})=\frac{1}{\sqrt{N}}\sum_n e^{i\bm{k}\bm{R}_n} w_j(\bm{r}-\bm{R}_n).
\end{equation}
%
Wannier functions for different atomic positions are orthogonal
%
\begin{multline}
\int d\bm{r} w_j^*(\bm{r}-\bm{R}_n)w_j(\bm{r}-\bm{R}_m)=\frac{1}{N}\sum_{\bm{k},\bm{k}'}\int d\bm{r}e^{i(\bm{k}\bm{R}_n-\bm{k}'\bm{R}_m)}\psi_{\bm{k}j}(\bm{r})\psi_{\bm{k}'j}(\bm{r}) \\
=\frac{1}{N}\sum_{\bm{k}}e^{i\bm{k}(\bm{R}_n-\bm{R}_m)}=\delta_{mn},
\end{multline}
%
where we used the orthogonality of Bloch functions. The completeness condition is also satisfied
%
\begin{equation}
\sum_n w_j^*(\bm{r}-\bm{R}_n)w_j(\bm{r}'-\bm{R}_n)=\delta^3(\bm{r}-\bm{r}').
\end{equation}
Thus, Wannier functions form a set of localized basis functions.
The energy of band $j$ for Bloch functions in this basis can be determined from the formula
%
\begin{equation}
\varepsilon_{\bm{k}j}=\int d\bm{r} \psi_{\bm{k}j}^*(\bm{r})H\psi_{\bm{k}j}(\bm{r})
=\frac{1}{N}\int d\bm{r}\sum_n w_j^*(\bm{r}-\bm{R}_n)e^{-i\bm{k}\bm{R}_n}H\sum_m w_j(\bm{r}-\bm{R}_m)e^{i\bm{k}\bm{R}_m}.
\end{equation}
%
The summation over indices $n$ and $m$ can be separated into two terms for $n=m$ and $n\neq m$
%
\begin{multline}
\varepsilon_{\bm{k}j}=\frac{1}{N}\sum_n\int d\bm{r} w_j^*(\bm{r}-\bm{R}_n)Hw_j(\bm{r}-\bm{R}_n)
\\ +\frac{1}{N}\sum_{n\neq m}e^{i\bm{k}(\bm{R}_m-\bm{R}_n)}\int d\bm{r} w_j^*(\bm{r}-\bm{R}_n)Hw_j(\bm{r}-\bm{R}_m).
\end{multline}
%
Using the notation we introduced for the Hamiltonian matrix elements (\ref{matrix})
we obtain
%
\begin{equation}
\varepsilon_{\bm{k}j}=\frac{1}{N}\sum_n \varepsilon_n+\frac{1}{N}\sum_{n\neq m}e^{i\bm{k}(\bm{R}_m-\bm{R}_n)}t_{nm}.
\end{equation}
%
This formula allows determining the band structure within the tight-binding method.
If we limit ourselves to a single-band model and to hops only between nearest neighbors,
we can obtain a simplified model with a single hopping parameter $t$.
For a simple cubic structure, we obtain
%
\begin{equation}
\varepsilon_{\bm{k}j}=\varepsilon_0+\frac{t}{N}\sum_{n}e^{i\bm{k}(\bm{R}_{n+1}-\bm{R}_n)}=\varepsilon_0+2t(cosk_xa+cosk_ya+cosk_za).
\label{band}
\end{equation}
%
where $a$ is the lattice constant, and $\varepsilon_0$ is the energy of an electron localized in an atomic state.
The bandwidth in this approximation is given by the formula $w=2z|t|$, where $z$ is the number of nearest neighbors.  

The tight-binding method, which uses a basis of atomic orbitals or Wannier functions,
is often used in model calculations. Within this approach, local Coulomb
interactions or pairing interactions in high-temperature superconductor models can easily be included.
Local energies and hopping integrals can be determined by fitting the electronic structure
from the tight-binding model to experimental results or to the band structure determined from DFT calculations.
In the latter case, a basis of maximally localized Wannier functions is most often used.
The freedom to choose the phase for Bloch functions is utilized, which can be multiplied by a factor $e^{i\theta(\bm{k})}$,
where $\theta(\bm{k})$ is an arbitrary real function, without affecting the energies of electronic states. 
However, such a factor affects the shape of Wannier functions, particularly their spatial extent. 
The phase factor can be chosen so that the Wannier function $w_i(\bm{r}-\bm{R}_n)$ is localized
around point $\bm{R}_n$ and decays rapidly with distance. 

\begin{figure}[h]
\centering
\includegraphics[scale=1]{FeSe.pdf}
\caption{Comparison of band structures obtained within the tight-binding model and DFT calculations for {\bf a.} CeCoIn$_5$ and {\bf b.} FeSe.
Figure from \cite{FeSe}.}
\label{fig:fese}
\end{figure}

Figure \ref{fig:fese} shows examples of band structures for two compounds, CeCoIn$_5$ and FeSe, calculated in the tight-binding model with a basis
of maximally localized Wannier functions. 
The model parameters were determined by fitting the electronic state energies, for each wave vector $\bm{k}$, 
to the band structures obtained from DFT calculations \cite{FeSe}.
The calculations were performed with the Quantum Espresso program \cite{QE}, using the GGA functional \cite{PW91} within the PAW method \cite{Blochl}.  
The determined tight-binding models were then used to calculate the susceptibility to Cooper pair formation
and investigate the superconducting properties of both materials \cite{FeSe}.
 

\subsection{Gaussian functions}

Local orbitals can also be used as a basis for expanding the wave function within the self-consistent procedure for solving the Kohn-Sham equations.
If the basis functions are atomic orbitals, we speak of the linear combination of atomic orbitals (LCAO) method. Usually, however, atom-like orbitals are used, whose functional form facilitates implementation
and speeds up calculations. The most commonly used are Slater-type orbitals \cite{STO1,STO2} and Gaussian-type functions (Gaussians) \cite{GTO}.
The latter are particularly convenient because integrals of Gaussian functions can be calculated analytically.
The natural representation for Gaussians is the polar coordinate system, but more convenient for determining Hamiltonian matrix elements is the Cartesian system, in which these functions have the form
%
\begin{equation}
G_{ijk}(\bm{r},\alpha,\bm{R}_n)=N(x-x_n)^i(y-y_n)^j(z-z_n)^ke^{-\alpha (\bm{r}-\bm{R}_n)^2},
\end{equation}
%
where $\alpha$ is a variational parameter that enables basis optimization for specific atoms, $\bm{R}_n=(x_n,y_n,z_n)$ is a vector determining the center of a given function, and $N$ is a normalization factor.
Additionally, the relation $l=i+j+k$ is satisfied, where $l$ is the orbital quantum number.
The product of two functions of type $s$ ($l=0$) centered at points $\bm{R}_n$ and $\bm{R}_m$ gives
%
\begin{equation}
G_s(\bm{r},\alpha,\bm{R}_n)G_s(\bm{r},\beta,\bm{R}_m)=e^{-\gamma(\bm{R}_n-\bm{R}_m)^2}G_s(\bm{r},\kappa,\bm{R}_p),
\end{equation}
%
where 
%
\begin{equation}
\kappa=\alpha+\beta, \quad \gamma=\frac{\alpha\beta}{\alpha+\beta}, \quad \bm{R}_p=\frac{\alpha\bm{R}_n+\beta\bm{R}_m}{\alpha+\beta},
\end{equation}
%
where $\bm{R}_p$ is the center vector of the resulting Gaussian function.
In the general case, the product of two Gaussians can be written in the form
%
\begin{multline}
G_{i_1j_1k_1}(\bm{r},\alpha,\bm{R}_n)G_{i_2j_2k_2}(\bm{r},\beta,\bm{R}_m) = Ne^{-\gamma(\bm{R}_n-\bm{R}_m)^2}e^{-\kappa(\bm{r}-\bm{R}_p)^2} \\
\times (x-x_n)^{i_1}(x-x_m)^{i_2}(y-y_n)^{j_1}(y-y_m)^{j_2}(z-z_n)^{k_1}(z-z_m)^{k_2}.
\end{multline}
%
These formulas show that the product of Gaussian functions is also a Gaussian function. This is the main advantage of this basis, enabling
analytical calculation of complex integrals containing several basis functions and thus significant acceleration of calculations.
In contrast to methods using plane waves, the Gaussian function method requires appropriate selection of basis functions
for a given atomic system. This method is used mainly by chemists, and the most popular program is GAUSSIAN.
The main creator of this program is John Pople, who in 1998 received the Nobel Prize in Chemistry together with Walter Kohn.

\section{Augmented waves and atomic spheres}

The last group of computational methods combines the main features of the two previous ones: pseudopotentials and local orbitals. 
Two different bases are used for expanding wave functions depending on the position in the crystal.
Around atomic cores, the natural choice is local functions, which can be obtained from solving
the Schr\"{o}dinger equation in a spherically symmetric potential. In the interstitial region,
an expansion in a basis of functions that enables rapid convergence of calculations is used (e.g., plane waves).
The central problem becomes appropriate boundary conditions that ensure continuity of the wave function and its derivative 
at the boundary between these regions.
All methods discussed in this section initially used a simplified muffin-tin potential, which in the core region
has the character of an atomic potential, while in the interstitial region its value is constant.
Currently, these approaches have been implemented within the self-consistent procedure and are classified as all-electron methods. 

\subsection{KKR method}

In two works, Korringa \cite{K47} and Kohn and Rostoker \cite{KR54} (KKR) proposed a method that is also called the Green's function method
or the multiple scattering method.
The first calculations of lattice constants and elastic moduli were performed using this method \cite{Moruzzi77}. This was a groundbreaking work that 
showed the possibility of applying DFT to study material properties.  

The basic quantity used here is the Green's function $G(E,\bm{r},\bm{r}')$, which describes the propagation of an electron with energy $E$ between points $\bm{r}$ and $\bm{r}'$. The process of electron movement can be divided into free motion in the interstitial region and scattering on atomic spheres
as a result of electron interaction with the atomic core potential.
For an electron described by the single-particle Schr\"{o}dinger equation
%
\begin{equation}
[-\frac{\hbar^2}{2m}\nabla^2+V(\bm{r})]\psi_i(\bm{r})=\varepsilon_i\psi_i(\bm{r}),
\end{equation}
%
the Green's function satisfies the equation
%
\begin{equation}
[-\frac{\hbar^2}{2m}\nabla^2+V(\bm{r})-E]G(E,\bm{r}-\bm{r}')=\delta(\bm{r}-\bm{r}'),
\end{equation}
%
which has a solution in the form
%
\begin{equation}
G(E,\bm{r},\bm{r}')=\sum_i\frac{\psi_i(\bm{r})\psi_i^*(\bm{r}')}{E-\varepsilon_i}.
\end{equation}
%
For non-interacting electrons, we have $V(\bm{r})=0$ and the Green's function has the form
%
\begin{equation}
G_0(E,|\bm{r}-\bm{r}'|)= \frac{m}{2\pi\hbar^2}\frac{e^{ik_0|\bm{r}-\bm{r}'|}}{|\bm{r}-\bm{r}'|},
\end{equation}
%
where $k_0=\frac{\sqrt{2mE}}{\hbar}$.

The Green's function for an electron interacting with the atomic lattice can be written as an expansion
%
\begin{equation}
G=G_0+G_0tG_0+G_0tG_0tG_0+...=G_0+G_0tG,
\end{equation}
%
which leads to the relation
%
\begin{equation}
G=(G_0^{-1}-t)^{-1},
\end{equation}
%
where $t$ is the scattering matrix for electrons on individual atoms of the crystal lattice.
One can also introduce the total multiple scattering matrix for electrons $T$, which is defined by the formula
%
\begin{equation}
G=G_0+G_0TG_0=G_0+G_0(t+tG_0T)G_0,
\end{equation}
%
from which we obtain
%
\begin{equation}
T=(t^{-1}-G_0)^{-1}.
\end{equation}
%
Stationary states, which correspond to solutions of the Schr\'{o}dinger equation, are poles of the matrix $T$
and can be determined as zeros of the determinant
%
\begin{equation}
\det(t^{-1}-G_0)=0.
\end{equation}
%
This equation provides a solution to the problem of multiple scattering of electrons in the muffin-tin potential approximation.
Complete information about electron scattering on a single atomic sphere is contained in the scattering matrix $t_l(E)$, 
which depends only on the energy of the electronic state $E$ and the orbital angular momentum $l$.
Using scattering theory, one can express the scattering matrix as a function of the phase shift of the wave function $\eta_l(E)$
%
\begin{equation}
t_l(E)=-\frac{1}{k_0}e^{i\eta_l(E)}\sin(\eta_l(E)).
\label{fshift}
\end{equation} 
%
The Green's function $G_0$ depends only on the crystal lattice geometry and energy $E$.
Using the expansion of plane waves in the basis of spherical harmonics, the Green's function
can be written in the form
%
\begin{equation}
G_0(E,|\bm{r}-\bm{r}'|)=\sum_{L,L'} i^lj_l(k_0r)Y_L(\hat{\bm{r}})B_{LL'}(E,\bm{R}-\bm{R}')(-i)^{l'}j_{l'}(k_0r')Y^*_{L'}(\hat{\bm{r}}'),
\end{equation} 
%
where $j_l(k_0r)$ are Bessel functions, $B_{LL'}$ are the KKR structure constants, and $L=\{l,m\}$.
The position vectors $\bm{r}$ and $\bm{r}'$ refer to two atomic spheres whose centers
are determined by vectors $\bm{R}$ and $\bm{R}'$. Assuming that scattering at each atomic site is the same,
which corresponds to a lattice composed of one type of atom, we can introduce the dependence of structure constants on the wave vector
% 
\begin{equation}
B_{LL'}(E_{\bm{k}},\bm{k})=\sum_{m} B_{LL'}(E_{\bm{k}},\bm{T}_m)e^{-i\bm{k}\bm{T}_m},
\end{equation}
%
where $\bm{T}_m$ are translation vectors of the crystal lattice, and the energies $E_{\bm{k}}$
are solutions of the equation
%
\begin{equation}
\det[t_l^{-1}(E_{\bm{k}})\delta_{LL'}-B_{LL'}(E_{\bm{k}},\bm{k})]=0.
\end{equation}
%
Using expression (\ref{fshift}), we obtain the basic equation for band structure in the KKR method
%
\begin{equation}
\sum_{L'}[B_{LL'}(E_{\bm{k}},\bm{k})+k_0\cot(\eta_l(E_{\bm{k}}))\delta_{LL'}]a_{L'}(\bm{k})=0.
\label{KKR}
\end{equation}
%
Solutions of this equation allow us to determine wave functions inside atomic spheres
%
\begin{equation}
\psi_{\bm{k}}(\bm{r})=\sum_{L'}a_{L'}(\bm{k})u_l(r,E_{\bm{k}})Y_L(\hat{\bm{r}}),
\end{equation}
%
where $u_l(r,E_{\bm{k}})$ are solutions of the radial equation inside the sphere, discussed in detail in the next section.
Wave functions in the interstitial region are solutions of the following integral equation
%
\begin{equation}
\psi_{\bm{k}}(\bm{r})=-\int d\bm{r}'G_0(E_{\bm{k}},|\bm{r}-\bm{r}'|)V(\bm{r}')\psi_{\bm{k}}(\bm{r}').
\end{equation} 
%
Wave functions in both regions must satisfy boundary conditions on each atomic sphere. 

In the general case, the scattering matrix depends on the atomic position $t_l(E,\bm{R})$
and the equation for the Green's function takes the form
%
\begin{equation}
[G_{LL'}(E,\bm{R},\bm{R}')]^{-1}=\Big[[B_{LL'}(E,\bm{R}-\bm{R}')]^{-1}-t_l(E,\bm{R})\delta_{\bm{R}\bm{R}'}\delta_{LL'}]\Big],
\end{equation}
%
and stationary states are obtained from the condition
%
\begin{equation}
\det\Big[t_l^{-1}(E,\bm{R})\delta_{\bm{R}\bm{R}'}\delta_{LL'}-B_{LL'}(E,\bm{R}-\bm{R}')\Big]=0.
\end{equation}

The Green's function allows determining various physical quantities. For example, the imaginary part of the Green's function is related to the local density of states 
%
\begin{equation}
n_L(E,\bm{R})=-\frac{1}{\pi}\operatorname{Im}G_{LL}(E+i\delta,\bm{R}).
\end{equation}
%
Similarly, the imaginary part of the Fourier transform of the Green's function gives us the spectral density,
i.e., the density of electronic states for a given energy and wave vector
%
\begin{equation}
n_L(E,\bm{k})=-\frac{1}{\pi}\operatorname{Im}G_{LL}(E+i\delta,\bm{k}).
\end{equation}
%

The Green's function method enables the introduction of an effective (coherent) potential that combines the properties of two different atoms.
This is the coherent potential approximation (CPA), which is used to study
metallic alloys or doped systems \cite{CPA1,CPA2}.
The method consists of averaging the scattering properties of two atoms placed near an effective potential.
The condition of equivalence between the weighted average over both atoms and the effective potential leads to a complex,
energy-dependent CPA potential. 


\subsection{LAPW method}

The linearized augmented plane wave (LAPW) method
is a modification of the original augmented plane wave (APW) approach proposed by Slater in 1937 \cite{slater37}.
Similarly to the pseudopotential method, the entire crystal is divided into regions inside spheres surrounding atoms ($r<r_c$)
and the interstitial region ($r>r_c$). Wave functions in the vicinity of the atomic nucleus are characterized by high variability and
approximately have a spherical shape. For this reason, the natural choice of basis is radial functions, which are solutions of the Schr\"{o}dinger equation with
a spherically symmetric potential. In the interstitial region, where the potential changes very slowly, solutions
of the wave function are expanded in a plane wave basis. The wave function in the APW method can be
written as
%
\begin{equation}
\psi_{\bm{k}j}(\bm{r})=\sum_{\bm{G}}c_{\bm{G}j}\phi_{\bm{k}+\bm{G}}(\bm{r}),
\end{equation}
%
where $\bm{G}$ denotes reciprocal lattice vectors. The basis functions can be written in the form 
%
\begin{equation} 
\phi_{\bm{k}+\bm{G}}(\bm{r})=\begin{cases}
        e^{i(\bm{k}+\bm{G})\bm{r}} & r>r_c \\
       \sum_{lm}A_{lm}(\bm{k}+\bm{G})u_l(r,E_l)Y_{lm}(\theta,\varphi) &  r<r_c,
             \end{cases}    
\label{APWbase}                      
\end{equation}
%
where $A_{lm}$ are expansion coefficients, $Y_{lm}(\theta,\varphi)$ are spherical harmonics, and $u_l(r,E_l)$ are solutions of the equation
%
\begin{equation}
[-\frac{d^2}{dx^2}+\frac{l(l+1)}{r^2}+V(r)-E_l]ru_l(r,E_l)=0,
\label{radial}
\end{equation}
%
where $V(r)$ is the potential inside the sphere, and $E_l$ plays the role of a parameter and is not necessarily an eigenvalue. 
In the muffin-tin (MT) potential approximation, in the atomic region it is spherically
symmetric ($V(\bm{r})=V(r)$), while in the interstitial region it has a constant value ($V(\bm{r})=V_0$) or zero. Then wave functions $\psi(\bm{r})$ can be expressed through solutions of the Schr\"{o}dinger equation in individual regions of the crystal, respectively through spherical harmonics around atoms and plane waves between atoms. 
The coefficients $A_{lm}$ are determined so that the continuity condition of the wave function at the sphere boundary is satisfied (the continuity condition for first derivatives is not satisfied). In this way, the coefficients $A_{lm}$ become dependent on the wave vector.  
The coefficients $c_{\bm{G}}$ and numbers $E_l$ are variational parameters of the APW method. Solutions, which are numbered by vectors $\bm{G}$, consisting of single plane waves in the interstitial region and radial solutions matched to them inside the sphere, are called augmented plane waves.

The basis functions inside the sphere depend on energy $E_l$, which causes the corresponding eigenvalue equation for wave functions to be nonlinear. This is the main problem
of the APW approach, preventing easy extension of the applicability of this method to arbitrary potentials. In particular, potentials determined by the self-consistent method within density functional theory.
The solution to this problem was the linearization of APW equations proposed by Andersen in 1975, which leads to the LAPW method \cite{Andersen75}.
In this approach, the basis functions inside the sphere are modified to the form
%
\begin{equation}
\phi_{\bm{k}+\bm{G}}(\bm{r})=\sum_{lm}[A_{lm}(\bm{k}+\bm{G})u_l(r,E_l)Y_{lm}(\theta,\varphi)+B_{lm}(\bm{k}+\bm{G})\dot{u}_l(r,E_l)Y_{lm}(\theta,\varphi)],
\end{equation}    
%
where the expansion coefficients $A_{lm}$ and $B_{lm}$ are determined from the continuity condition of the wave function and its derivative on the sphere, and the derivative $\dot{u}_l(r,E_l)=\partial u_l/\partial E$ satisfies the equation
%
\begin{equation}
[-\frac{d^2}{dx^2}+\frac{l(l+1)}{r^2}+V(r)-E_l]r\dot{u}_l(r,E_l)=ru_l(r,E_l).
\end{equation}
Additionally, the normalization condition for the function $u_l$ is imposed
%
\begin{equation}
\int_0^{r_c}dr[ru_l(r,E_l)]^2=1,
\end{equation}
%
as well as the orthogonality of functions $u_l$ and $\dot{u}_l$
%
\begin{equation}
\int_0^{r_c}drr^2u_l(r,E_l)\dot{u}_l(r.E_l)=0.
\end{equation}

Knowledge of the gradient $\dot{u}_l$ enables determination of the radial function for a given band energy $\varepsilon$, 
taking into account the linear correction
%
\begin{equation}
u_l(r,\varepsilon)=u_l(r,E_l)+(\varepsilon-E_l)\dot{u}_l(r,E_l)+O((\varepsilon-E_l)^2),
\end{equation}
%
where $O((\varepsilon-E_l)^2)$ denotes an error that is of the order of the square of the difference between these two energies.

Within the self-consistent procedure, the full potential is calculated in both regions of the crystal,
using expansions in appropriate bases
%
\begin{equation} 
V(\bm{r})=\begin{cases}
        \sum_{\rm{G}}V_{\bm{G}} e^{i\bm{G}\bm{r}} & r>r_c \\
       \sum_{lm}V_{lm}Y_{lm}(\theta,\phi) &  r<r_c.
             \end{cases}   
\label{fullpot}                       
\end{equation}
%
Similarly, the charge density is calculated inside the sphere using the expansion coefficients of wave functions
in the spherical harmonics basis and in the interstitial region in the plane wave basis.

In contrast to the pseudopotential method, where only valence electrons are considered, in the LAPW method both
valence states and core states are determined.
Since the wave functions of core states are localized close to the atomic nucleus, they are calculated using only 
the centrally symmetric potential. If the range of the core state wave function exceeds the boundary of the atomic zone,
a smooth extension of the centrally symmetric potential beyond this boundary is used. 
To determine core states, a fully relativistic approach is used,
i.e., the Dirac equation is solved instead of the Schr\"{o}dinger equation (\ref{radial}). 
Valence states are determined for the full potential throughout the entire crystal volume.

In some materials, there also exist electronic states having common features of core and valence states, which are called
semi-core states. An example is the high-lying and relatively extended $5d$ states in rare earth metals.
The occurrence of these states requires modification of the LAPW method. In the standard version, the basis is constructed
to describe as accurately as possible electronic states close to energy $E_l$,
and usually this value is chosen close to the center of the valence band.
If additional states occur in a different energy range, the choice of $E_l$ value is not obvious. 
The best approach to describe semi-core states is to extend the basis by introducing additional 
local orbitals (LO) that fit within the atomic sphere. This modification is called the APW+LO method \cite{singh91}. 
Since there is freedom in choosing the basis, the derivative of the radial function $\dot{u}_l$ is removed from the main basis and attached to LO.
Thus, the total basis in this approach consists of the original APW basis (\ref{APWbase})  
and additional orbitals in the form
%
\begin{equation}
\chi^{lo}_L(\bm{r})=[a^{lo}_{lm}u_l(r,E_l)+b^{lo}_{lm}\dot{u}_l(r,E_l)]Y(\theta,\varphi),
\end{equation}
%
where $r<r_c$, and the coefficients $a^{lo}_{lm}$ and $b^{lo}_{lm}$ are chosen so that the LO
vanishes on the sphere. The orbital quantum number is limited in this case to values corresponding to 
physical quantum states ($l\le 3$). In contrast to LAPW, in the APW+LO method there is no restriction on
the values of derivatives of basis functions on the atomic sphere. 
  

\subsection{LMTO method}

In the linearized muffin-tin orbitals (LMTO) method,
the crystal is also divided into regions inside atomic spheres and the interstitial region.
The wave function corresponding to energy $\varepsilon$ can be written in the general form 
%
\begin{equation}
\psi_{\bm{k}}(\varepsilon,\bm{r})=\sum_{lm} a_{lm}(\bm{k}) \phi_{lm}(\varepsilon,\kappa,\bm{r}),
\end{equation}
%
where the basis functions in individual regions have the form
%
\begin{equation}
\phi_{lm}(\varepsilon,\kappa,\bm{r})=i^lY_{lm}(\theta,\phi)\begin{cases}
        u_l(\varepsilon,r) +\kappa cot(\eta_l(\varepsilon))J_l(\kappa,r) & r<r_c \\
       \kappa N_l(\kappa,r) &  r>r_c.
             \end{cases}    
\end{equation}
%
The function $J_l(\kappa,r)$ is constructed so that the basis functions inside the sphere do not depend on energy, 
i.e., the equation is satisfied
%
\begin{equation}
\frac{d}{d\varepsilon}\phi_{lm}(\varepsilon,\kappa,\bm{r})=i^lY_{lm}[\dot{u}_l(\varepsilon,r) +\kappa\frac{d}{d\varepsilon} cot(\eta_l(\varepsilon))J_l(\kappa,r)]=0
\end{equation}
%
for energy $\varepsilon=E_{\nu}$ corresponding to the average energy of a given LMTO orbital.
This condition leads to the formula
%
\begin{equation}
J_l(\kappa,r)=-\frac{\dot{u}_l(E_{\nu},r)}{\kappa\frac{d}{d\varepsilon}cot(\eta_l(E_{\nu}))}.
\end{equation}
%
In the interstitial region, basis functions centered at the position of a given sphere $\bm{R}$ are obtained by expansion in functions $J_l$
associated with neighboring spheres at positions $\bm{R}'$
%
\begin{equation}
N_l(\kappa,\bm{r}-\bm{R})=4\pi\sum_{l',l''}C_{l',l'',l'''}n^*_{l''}(\kappa,\bm{R}-\bm{R'})J_{l'}(\kappa,\bm{r}-\bm{R}').
\end{equation}
%
This construction causes LMTO functions to be a linear combination of functions $u_l$ and $\dot{u}_l$ inside a given sphere
and to be smoothly extended to the interstitial region, joining continuously with functions $\dot{u}_l$ from each
neighboring sphere.

The LMTO method can be simplified by omitting the interstitial region and limiting oneself to optimization of wave functions only inside spheres.
In the approach called the atomic sphere approximation (ASA),
spheres are used that partially overlap and their total volume equals the total volume of the crystal. 
Application of such an approach is justified only for crystals with close-packed atomic structures.

\chapter{Orbital-dependent functionals and potentials}

\section{Problems with local functionals}
\label{sec:mgga}

Density functional theory has achieved many spectacular successes in the study of solid state properties.
However, it has deficiencies that prevent the correct description of the electronic structure of many materials.
These problems arise essentially from the approximations used to calculate the exchange-correlation energy,
whose exact functional form is not known.
The main advantage of the approximations used in DFT, allowing calculations even for large systems, is the local or quasilocal
character of the exchange-correlation potential. The exact potential is usually nonlocal and depends on the wave functions (orbitals), not just the electron density. An example is the exact exchange interaction energy, which is calculated from single-particle orbitals in the Hartree-Fock approximation.
Standard exchange-correlation functionals used in DFT do not depend on the type of occupied orbitals.
More precisely, they do not distinguish states with different quantum number $m$.
All orbitals are treated equally and there is no possibility to distinguish features that determine their unequal occupation.
This possibility often determines the character of the ground state and is particularly important in strongly correlated systems. 

In the LDA and GGA approximations there are two main problems that are closely related.
The first is the lack of discontinuity in the derivative of the total energy functional with respect to electron density, which is equal to the chemical potential.
This discontinuity is a characteristic feature of the exchange-correlation functional, but also appears in the term describing the kinetic energy of electrons.
Since the discontinuity of the chemical potential is associated with the energy gap, its absence results in underestimated values, and even
vanishing of this quantity in insulators and semiconductors.
The problem of the energy gap will be discussed in more detail in chapter~(\ref{sec:insulators}).

The second problem is the occurrence of electron self-interaction, i.e., non-zero interaction energy of an electron
with its own Coulomb field. This is a non-physical effect that results from the imperfect cancellation of the contributions in the Hamiltonian
to the interaction of an electron with its own electric field.
In an exact description, the negative exchange-correlation potential produced by each electron should exactly cancel its positive Hartree potential.
In the case of the Hartree-Fock approximation, self-interaction does not occur because the exchange and Hartree interactions mutually cancel.
In the case of DFT, the Hartree potential is calculated exactly, while the exchange-correlation potential is approximate,
becoming the source of self-interaction.
Even in the case of a one-electron system, the Hartree energy does not cancel with the exchange energy determined in the LDA or GGA approximation.
Using the example of the hydrogen atom, discussed in chapter \ref{sec:GGA}, one can clearly see the effect caused by differences between exact and approximate values.
Since the absolute value of the exchange energy is smaller than the exact value, it does not completely cancel the positive Hartree energy.
Although this difference is partially reduced by the non-zero and negative correlation energy, it remains finite.
This additional energy of electron interaction with its own electric field can cause large errors in calculations.
% **[REVIEW NEEDED]**: The term "self-interaction" is consistently translated; verify terminology matches conventions in English DFT literature.
Depending on the type of material, self-interaction takes very different values. It is negligibly small for extended electronic states,
delocalized over a large region of a given material. Therefore, the influence of self-interaction on electronic states in simple metals,
where valence states of type $s$ and $p$ dominate, can be neglected.
In materials where electronic states tend to localize (e.g., {\it 3d} and {\it 4f} states),
it is particularly strong and often leads to results qualitatively inconsistent with experiment.
In localized states, the interaction of an electron with its own Coulomb field, which is repulsive,
can lead to a significant energy increase. Reduction of this energy is only possible by increasing the delocalization
of the charge and broadening of the electronic bands. This effectively leads to a reduction of the energy gap
obtained in calculations for semiconductors and insulators. In extreme cases, self-interaction errors cause charge delocalization in $3d$ states
and closure of the energy gap, resulting in an incorrect metallic state in materials that are actually Mott insulators.

These problems can be eliminated or partially reduced by using functionals dependent on electronic orbitals~\cite{kummel}.
In the following sections, methods are discussed that take orbital dependence into account in the exchange-correlation functional
or introduce corrections to the total energy dependent on orbital occupation.  

\section{OEP functionals}
\label{sec:mgga}

The approach called the optimized effective potential (OEP) method
was proposed by Sharp and Horton in 1953, even before density functional theory was developed~\cite{Sharp}.
% **[REVIEW NEEDED]**: Verify historical accuracy of Sharp-Horton contribution and year.
This method assumes a functional dependence of the exchange-correlation energy on orbitals $\phi_{j\sigma}$, while maintaining the local character of the potential $V^{OEP}_{\sigma}$. The OEP equation was first solved numerically by Talman and Shadwick~\cite{Talman}.
The Kohn-Sham total energy can be written as a functional of orbitals
%
\begin{equation}
E[\{\phi_{j\sigma}\}]=T[\{\phi_{j\sigma}\}]+\int d\bm{r} V_{ext}(\bm{r})n(\bm{r})+\frac{1}{2}\int \int d\bm{r} d\bm{r}' \frac{n(\bm{r})n(\bm{r}')}{|\bm{r}-\bm{r}'|}+E_{xc}[\{\phi_{j\sigma}\}].
\end{equation}
%
The OEP method has a variational character and is based on two equations. The first defines the condition of minimum (stationarity) of the total energy
with respect to the effective potential
%
\begin{equation}
\frac{\delta E[\{\phi_{j\sigma}\}]}{\delta V^{OEP}_{\sigma}}=0,
\end{equation} 
%
which is equivalent to the Kohn-Sham variational principle $\delta E_\text{tot}/\delta n=0$~\cite{Sahni}.
The second equation has the form of the Kohn-Sham equation with an effective potential dependent on orbitals
%
\begin{equation}
\Big[-\frac{\hbar^2}{2m}\nabla^2+V^{OEP}_{\sigma}[\{\phi_{j\sigma}\}](\bm{r})\Big]\phi_{j\sigma}(\bm{r})=\varepsilon_{j\sigma}\phi_{j\sigma}(\bm{r}).
\end{equation}
%
The part of the potential describing the exchange-correlation interaction can be written as a double integral using properties of functional derivatives
%
\begin{equation}
V^{OEP}_{xc\sigma}(\bm{r})=\frac{\delta E_{xc}[\{\phi_{j\sigma}\}]}{\delta n_{\sigma}(\bm{r})}=\sum_{\nu\mu\i}\int\int d\bm{r}' d\bm{r}''\frac{\delta E_{xc}}{\delta \phi_{i\nu}(\bm{r}')}\frac{\delta \phi_{i\nu}(\bm{r}')}{\delta V^{OEP}_{\mu}(\bm{r}'')}\frac{\delta V^{OEP}_{\mu}(\bm{r}'')}{\delta n_{\sigma}(\bm{r})}.
\label{voep}
\end{equation}
%
The second of the functional derivatives under the integral can be expressed in the first order of perturbation expansion
%
\begin{equation}
\frac{\delta \phi_{i\nu}(\bm{r}')}{\delta V^{OEP}_{\mu}(\bm{r}'')}=\delta_{\nu\mu}\sum_{k\neq i}\frac{\phi^*_{k\mu}(\bm{r}')\phi_{k\mu}(\bm{r}'')}{\varepsilon_{i\mu}-\varepsilon_{k\mu}}\phi_{i\mu}(\bm{r}'')=\delta_{\nu\mu}G^R_{i\mu}(\bm{r}',\bm{r}'')\phi_{i\mu}(\bm{r}''),
\end{equation}
%
where we introduced the Green's function for non-interacting electrons
%
\begin{equation}
G^R_{i\mu}(\bm{r}',\bm{r}'')=\sum_{k\neq i}\frac{\phi^*_{k\mu}(\bm{r}')\phi_{k\mu}(\bm{r}'')}{\varepsilon_{i\mu}-\varepsilon_{k\mu}}.
\label{fgreena}
\end{equation} 
%
The third of the derivatives is the inverse of the linear response function, which we can also express through the Green's function
%
\begin{equation}
\chi_{\sigma}(\bm{r},\bm{r}'')=\delta_{\sigma\mu}\frac{\delta n_{\sigma}(\bm{r})}{\delta V^{OEP}_{\mu}(\bm{r}'')}=\delta_{\sigma\mu}\sum_i G^R_{i\sigma}(\bm{r}'',\bm{r})\phi_{i\sigma}(\bm{r}'')\phi^*_{i\sigma}(\bm{r}).
\label{vchi}
\end{equation}
%
Multiplying equation (\ref{voep}) by $\chi_{\sigma}(\bm{r}',\bm{r})$, integrating with respect to $\bm{r}'$ and using (\ref{vchi}) we obtain
the integral equation of the OEP method
%
\begin{equation}
\sum_i\int d\bm{r}' \phi^*_{i\sigma}(\bm{r})[V^{OEP}_{xc\sigma}(\bm{r})-u^{OEP}_{xci\sigma}(\bm{r})]G^R_{i\sigma}(\bm{r}',\bm{r})\phi_{i\sigma}(\bm{r}) + c.c.=0,
\label{oepint}
\end{equation}
%
where
%
\begin{equation}
u^{OEP}_{xci\sigma}(\bm{r})=\frac{1}{\phi^*_{i\sigma}(\bm{r})}\frac{\delta E_{xc}[\{\phi_{j\sigma}\}]}{\delta \phi_{i\sigma}(\bm{r})}.
\end{equation}
%
If the exchange-correlation functional depends only on density, then $u^{OEP}_{xci\sigma}(\bm{r})=V^{OEP}_{xc\sigma}(\bm{r})$ and equation (\ref{oepint})
is automatically satisfied.
Within the OEP method, the exchange part can be treated exactly, as in the Hartree-Fock approximation, and then the orbital-dependent potential
has the form
%
\begin{equation}
u^{OEP}_{xi\sigma}=-\frac{1}{\phi^*_{i\sigma}(\bm{r})}\sum_j \phi^*_{j\sigma}\int d\bm{r}'\frac{\phi^*_{i\sigma}(\bm{r}')\phi_{j\sigma}(\bm{r}')}{|\bm{r}-\bm{r}'|}.
\end{equation} 
%
Due to the integral character of the OEP equations, determining self-consistent solutions, even with additional approximations, requires very time-consuming calculations~\cite{kummel}. For this reason, OEP potentials are rarely used in practice.
Significantly more effective are orbital-dependent potentials discussed in the following sections. 

\section{Self-interaction correction (SIC)}
\label{sec:sic}

In 1981, Perdew and Zunger proposed the self-interaction correction (SIC) method \cite{PZ}.
This method concerns localized states, so we consider a set of orbitals $\phi_{\alpha\sigma}(\bm{r})$, where $\alpha$ denotes the orbital number,
and $\sigma$ the spin direction. We denote the electron density of a single orbital by
%
\begin{equation}
n_{\alpha\sigma}(\bm{r})=f_{\alpha\sigma}|\phi_{\alpha\sigma}(\bm{r})|^2,
\end{equation}
%
where the number $f_{\alpha\sigma}$ determines the occupation of a given orbital.
The condition for the absence of self-interaction in each orbital is the complete mutual cancellation of the Hartree energy given by formula (\ref{Hartree})
and the exchange-correlation energy
%
\begin{equation}
E_H[n_{\alpha\sigma}]+E_{xc}[n_{\alpha\sigma}]=0,
\label{nosic}
\end{equation}
%
where both energies are functionals of the single orbital density.
For a single electron, the condition of cancellation
of the Hartree energy and the exact exchange energy calculated in the Hartree-Fock approach is also satisfied
%
\begin{equation}
E_H[n_{\alpha\sigma}]+E_{x}[n_{\alpha\sigma}]=0.
\end{equation}
%
Since the correlation energy $E_c=E_{xc}-E_{x}$, from these two conditions it follows that the correlation energy for a single orbital must vanish
%
\begin{equation}
E_c[n_{\alpha\sigma}]=0.
\end{equation}
%
These conditions are not satisfied for the exchange-correlation energy given by the formulas in the LDA approximation (\ref{xclda})
or GGA (\ref{xcgga}), which leads to electron self-interaction. Let us denote generally by $E_{xc}^{DFT}[n_{\uparrow},n_{\downarrow}]$ the exchange-correlation functional determined in one of these approximations. Then the formula for the corrected exchange-correlation energy can be written in the form
%
\begin{equation}
E_{xc}^{SIC}[n_{\alpha\sigma}]=E_{xc}^{DFT}[n_{\uparrow},n_{\downarrow}]-\sum_{\alpha\sigma}\delta_{\alpha\sigma},
\label{xcsic}
\end{equation}
%
where
%
\begin{equation}
\delta_{\alpha\sigma}=E_H[n_{\alpha\sigma}]+E_{xc}^{DFT}[n_{\alpha\sigma}],
\end{equation}
%
and the summation is only over occupied orbitals $\alpha$.
For the exact value of the exchange-correlation energy we would have $\delta_{\alpha\sigma}=0$,
i.e., condition (\ref{nosic}) would be satisfied.
The exchange-correlation energy defined by formula (\ref{xcsic}) is not a functional of electron density,
but a functional of atomic orbitals. This causes the total energy functional (\ref{EKS}) to also become dependent on orbitals
% 
\begin{equation}
E^{SIC}[n_{\alpha\sigma}]=\sum_{\alpha\sigma}\langle\phi_{\alpha\sigma}|-\frac{\hbar^2}{2m}\nabla^2|\phi_{\alpha\sigma}\rangle+E_{ext}[n]+E_H[n]+E_{xc}^{SIC}[n_{\alpha\sigma}].
\label{esic}
\end{equation}
% 
Similarly, as in the case of the Kohn-Sham functional, we can apply the variational method to minimize this energy with respect to
the set of orbitals $\phi_{\alpha\sigma}$, assuming the orthonormality condition
%
\begin{equation}
\langle\phi_{\alpha\sigma}|\phi_{\alpha'\sigma'}\rangle=\delta_{\alpha\alpha'}\delta_{\sigma\sigma'}.
\end{equation}
%
We then obtain single-particle equations analogous to the Kohn-Sham equations
%
\begin{equation}
[-\frac{\hbar^2}{2m}\nabla^2+V_{eff}(n_{\alpha\sigma},\bm{r})]\phi_{\alpha\sigma}(\bm{r})=\varepsilon_{\alpha\sigma}^{SIC}\phi_{\alpha\sigma}(\bm{r}),
\label{eqsic}
\end{equation} 
%
with an effective potential given by the formula
%
\begin{equation}
V_{eff}(n_{\alpha\sigma},\bm{r})=V^{DFT}(\bm{r})-V_H(n_{\alpha\sigma},\bm{r})-V_{xc}(n_{\alpha\sigma},\bm{r}),
\end{equation}
%
where the last two terms are the self-interaction correction to the effective electron potential.
Similarly to the Kohn-Sham states, the following relation is satisfied
%
\begin{equation}
\varepsilon_{\alpha\sigma}^{SIC}=\frac{\partial E^{SIC}}{\partial f_{\alpha\sigma}}.
\end{equation}

Equation (\ref{eqsic}) allows determination of orbitals and eigenvalues of localized electronic states.
However, in real materials, we often deal with coexistence of localized and delocalized states, which means that solutions to this equation may not correspond to the global minimum. Full optimization of wave functions should
take into account both localized (Wannier-type) and delocalized (Bloch-type) states.
In practice, this involves determining different possible configurations of localized and delocalized states,
and then selecting the one with the lowest energy.    

\begin{figure}[h]
\centering
\includegraphics[scale=1.2]{rare-earths.pdf}
\caption{Total energy differences for valence II and III calculated for rare earths (o), compared with experiment (dashed line)
and values for rare earth sulfur compounds (+). Figure from ref. \cite{RE}.}
\label{fig:rare}
\end{figure}


A good example is rare earth metals, where both localized ($4f$) states occur,
as well as delocalized ($5d$ and $6s$) states. Additionally, there are two types of $4f$ electrons. Part of them is localized,
like core electrons, having a decisive influence on the magnetic moment and valence of a given atom.
The remaining ones, as a result of hybridization with $5d$ and $6s$ states, form an electronic band and participate in metallic bonding.
Within the framework of traditional approximations of exchange-correlation energy, one cannot correctly describe such a complex
electronic structure of rare earths. In ref. \cite{RE}, the SIC method was applied to calculate the occupation
of $4f$ states and valence in all rare earth atoms (figure \ref{fig:rare}).
Valence is defined as the number of delocalized states per atom and is calculated from the formula
%
\begin{equation}
N_{val}=Z-N_{core}-N_{SIC},
\end{equation}
%
where $Z$ is the atomic number, $N_{core}$ the number of electrons in the core and $N_{SIC}$ the number of localized $4f$ states,
for which the self-interaction energy was subtracted. For rare earths, valence takes two possible values:
$N_{val}=2$ (divalent atoms, II) or $N_{val}=3$ (trivalent atoms, III).
For these two cases, the calculated differences of their total energies $E_{II}-E_{III}$ are shown in figure \ref{fig:rare}.
The obtained values agree very well with experimental data.
As can be seen, except for Eu and Yb, which are divalent, all other rare earths are trivalent.
Similarly good agreement with experiment was obtained for Wigner-Seitz radii and lattice constants of rare earth crystals \cite{RE}.

Due to the explicit dependence on orbitals, SIC functionals exhibit discontinuity of the derivative with respect to electron density.
Thanks to this, the method significantly improves the values of energy gap and magnetic moments
in strongly correlated systems~\cite{svane1990,temmerman2001}.
On the other hand, the SIC does not provide the systamic improvement in description of molecular
systems~\cite{kummel}.


\section{Hybrid functionals}
\label{sec:hybrid}

The self-interaction problem does not occur in the Hartree-Fock approximation, where for each electron
its own Coulomb interaction is canceled by the exchange interaction.
Therefore, partial inclusion of the exact value of exchange energy in the exchange-correlation functional should
reduce the self-interaction effect and thus improve the total energy of the system.
Such functionals, in which the exchange energy obtained in the LDA or GGA approximation is partially replaced by
the exact value obtained from the Hartree-Fock method, are called hybrid functionals.
The first hybrid functional was proposed by Becke in 1993 \cite{becke93}, justifying its form
based on the so-called adiabatic connection formula.
Let us consider a general Hamiltonian in the form
%
\begin{equation}
H_{\lambda}=T+\lambda V,
\end{equation}
%
where $T$ is the kinetic energy operator, $V$ is the interaction potential between electrons, and $\lambda$ is a parameter that
determines the strength of this interaction ($0\leq\lambda\leq 1$).
The wave functions $\psi_{\lambda}$ and eigenvalues $E_{\lambda}$ of this Hamiltonian depend on the parameter $\lambda$.
For them the following equation is satisfied
%
\begin{equation}
\frac{dE_{\lambda}}{d\lambda}=\langle\psi_{\lambda}|V|\psi_{\lambda}\rangle,
\end{equation} 
%
from which we get
%
\begin{equation}
E_{\lambda=1}=E_{\lambda=0}+\int_0^1 d\lambda \langle\psi_{\lambda}|V|\psi_{\lambda}\rangle.
\end{equation}
%
The energy for $\lambda=0$ corresponds to the kinetic energy, while $\lambda=1$ gives the energy with full electron interaction $V$.
This formula defines precisely the adiabatic connection between the system of non-interacting and interacting electrons.
After applying this formula to the energy functional (omitting the external potential $V_{ext}$) we get
%
\begin{equation}
E[n]=T[n]+\int_0^1 d\lambda \langle\psi_{\lambda}|V|\psi_{\lambda}\rangle.
\end{equation}
%
Taking into account the Kohn-Sham functional (\ref{EKS}), we can write the formula for exchange-correlation energy in the form
%
\begin{equation}
E_{xc}[n]=\int_0^1 d\lambda \langle\psi_{\lambda}|V|\psi_{\lambda}\rangle-E_H[n]=\int_0^1d\lambda E_{xc,\lambda}[n].
\label{xcn}
\end{equation}
%
The above integral can be approximated by considering only the end values. For $\lambda=0$, we get the exchange energy
in the Hartree-Fock approximation, $E_{xc,0}=E_x^{HF}$. Becke proposed that for $\lambda=1$ one should apply one of the approximations used in DFT (LDA or GGA),
$E_{xc,1}=E_{xc}^{DFT}$, and for intermediate values of $\lambda$ use linear interpolation
%  
\begin{equation}
E_{xc,\lambda}[n]=(1-\lambda)E_x^{HF}[n]+\lambda E_{xc}^{DFT}[n].
\end{equation}
%
After substituting this dependence into (\ref{xcn}) and calculating the integral we get the hybrid functional
%
\begin{equation}
E_{xc}^{hyb}[n]=\frac{1}{2}E_x^{HF}+\frac{1}{2}E_{xc}^{DFT}[n].
\label{becke}
\end{equation} 
%
This functional can be improved by refining the approximate integration of $E_{xc,\lambda}[n]$.
For an arbitrary system, one can find a parameter $b$ that best describes the
exchange energy
%
\begin{equation}
E_{xc}^{hyb}[n]=bE_x^{HF}+(1-b)E_{xc}^{DFT}[n].
\end{equation}
In practice, functionals are used in which only the exact and approximate parts
of the exchange energy are linearly mixed, and the correlation part is approximated within LDA or GGA.
The parameter $b$ can be chosen empirically by fitting different quantities, for example atomization
energies, to experimental values for a large group of materials.
Optimal agreement is usually obtained for values from the range $b=[0.15,0.30]$.

The choice of parameter $b$ can be additionally justified using the approach proposed by Perdew, Ernzerhof and Burke in 1996~\cite{PBE0}.
Writing the dependence of exchange-correlation energy on $\lambda$ in the form of Mller-Plesset perturbation expansion,
one obtains the dependence
%
\begin{equation}
E_{xc,\lambda}[n]=E_{xc}^{DFT}[n]+(E_x^{HF}[n]-E_x^{DFT}[n])(1-\lambda)^{m-1},
\end{equation}
%
which leads to the hybrid functional in the form
%
\begin{equation}
E_{xc}^{hyb}[n]=E_{xc}^{DFT}[n]+\frac{1}{m}(E_x^{HF}[n]-E_x^{DFT}[n]).
\end{equation}
%
For $m=1$, the exchange energy equals the exact value $E_x^{HF}$. In this case, adding the approximate value of correlation energy $E_c^{DFT}$
improves results compared to the Hartree-Fock approximation. However, the results are worse than in the LDA or GGA approximations, where the errors of exchange and correlation energy have opposite signs, which causes their partial cancellation. The case $m=2$ corresponds to the functional given by formula~(\ref{becke}).
The optimal choice was recognized as $m=4$~\cite{PBE0}, indicating very good agreement of results obtained within the fourth-order Mller-Plesset perturbation theory with experimental data \cite{pople89}. Moreover, in this case both the values of $E_{xc,\lambda}$ and $E_{xc}^{DFT}$, as well as their first and second derivatives mutually coincide for $\lambda=1$. The parameter $b$ is related to the exponent $m$ by the simple dependence $b=\frac{1}{m}$, which gives $b=0.25$, close to empirical values.

The hybrid functional is a special case of an orbital-dependent functional, in which
the Kohn-Sham potential consists of a local (quasilocal) part and a part
of the Fock potential describing the exact exchange energy.
Exchange interaction has a short-range character and one can include the contribution from the exact value only
within a certain distance range. Taking this effect into account, Heyd, Scuseria and Ernzerhof (HSE) \cite{HSE} proposed a new functional
in the form
%
\begin{equation}
E_{xc}^{hyb}(\mu) = (1-b)E_{x}^{GGA,SR}(\mu)+bE_x^{HF,SR}(\mu) + E_x^{GGA,LR} + E_c^{GGA},
\end{equation}
%
where $E_x^{GGA,SR}$ and $E_x^{GGA,LR}$ correspond to short-range and long-range exchange interaction in the GGA approximation,
$E_x^{HF,SR}$ is the part of the short-range exact exchange interaction, and the parameter $\mu$
determines the range of short-range interaction.


\section{meta-GGA functionals and potentials}
\label{mgga}


The two basic approximations used to describe the exchange-correlation functional only take into account the charge density at a given point
in space (LDA) or additionally its gradient (GGA).
The next step to improve this functional is to take into account its dependence on the gradient of orbitals, i.e.,
the kinetic part of the total energy.

%
\begin{figure}[h]
\centering
\includegraphics[scale=1]{Jacob.jpg}
\caption{Jacob's ladder describing successive levels of accuracy in describing the exchange-correlation functional in DFT.}
\label{fig:jacob}
\end{figure}
%

Such functionals are called meta-GGA and are written in the general form
%
\begin{equation}
E_{xc}[n_{\uparrow},n_{\downarrow}]=\int d\bm{r} n(\bm{r}) \varepsilon_{xc}(n_{\uparrow},n_{\downarrow},\nabla n_{\uparrow},\nabla n_{\downarrow},\tau_{\uparrow},\tau_{\downarrow}),
\label{metaGGA}
\end{equation}
%
where $\tau_{\sigma}$ is the kinetic energy density determined for occupied Kohn-Sham states
%
\begin{equation}
\tau_{\sigma}(\bm{r})= \frac{1}{2}\sum_i |\nabla \psi_{i\sigma}(\bm{r})|^2,
\end{equation}
%
in units $\hbar=m_\text{e}=1$. The justification for including $\tau_{\sigma}$ in the functional is the occurrence of this quantity in the Taylor expansion
of the spherically averaged exchange charge around an electron~\cite{Becke1998}. The second beneficial feature is the possibility of reducing self-interaction
in the correlation part of the functional.


\subsection{Becke-Johnson potential}

Becke and Johnson (BJ) applied an extension of the Slater exchange potential in the form~\cite{Becke2006}
%
\begin{equation}
V^\text{BJ}_{\text{x}\sigma}(\bm{r})=V_{\text{x}\sigma}^\text{Slater}(\bm{r})+\frac{1}{\pi}\sqrt{\frac{5}{12}}\sqrt{\frac{2\tau_{\sigma}(\bm{r})}{n_{\sigma},(\bm{r})}}.
\label{BJ}
\end{equation} 
%
where the Slater potential discussed in chapter (\ref{sec:HF}) is given by the formula
%
\begin{equation}
V_{\text{x}\sigma}^\text{Slater}(\bm{r})=-\frac{e}{2}\int d\mb{r}' \frac{n(\mb{r},\mb{r}')}{|\mb{r}-\mb{r}'|}, 
\label{SlatPot}
\end{equation}
% 
where the exchange charge $n(\mb{r},\mb{r}')$ is described by formula (\ref{EC}). The BJ potential significantly improves the exchange interaction energy
compared to the LDA approximation and gives results comparable to the OEP potential~\cite{Becke2006}.
Tran and Blaha proposed a modification of the BJ exchange potential in the form~\cite{Tran2009}
%
\begin{equation}
V^\text{mBJ}_{\text{x}\sigma}(\bm{r})=cV^\text{BR}_{\text{x}\sigma}(\bm{r})+(3c-2)\frac{1}{\pi}\sqrt{\frac{5}{12}}\sqrt{\frac{2\tau_{\sigma}(\bm{r})}{n_{\sigma}(\bm{r})}},
\label{mBJ}
\end{equation}
%
where instead of the Slater potential, the Becke-Roussel potential appears
%
\begin{equation}
V^\text{BR}_{\text{x}\sigma}(\bm{r})=-\frac{1}{b_{\sigma}(\bm{r})}(1-e^{-x_{\sigma}(\bm{r})}-\frac{1}{2}x_{\sigma}(\bm{r})e^{-x_{\sigma}(\bm{r})}).
\end{equation}
%  
The quantity $x_{\sigma}(\bm{r})$ depends on the electron density and its gradient as well as on $\tau_{\sigma}(\bm{r})$, while
%
\begin{equation}
b_{\sigma}(\bm{r})=[\frac{x^3_{\sigma}(\bm{r})e^{-x_{\sigma}(\bm{r})}}{8\pi n_{\sigma}(\bm{r})}]^{\frac{1}{3}}.       
\end{equation}
%
The parameter $c$ is expressed by the following formula
%
\begin{equation}
c=\alpha+\beta[\frac{1}{V_\text{cell}}\int d\bm{r}'\frac{|\nabla n(\bm{r}')|}{n(\bm{r}')}]^{\frac{1}{2}},
\end{equation}
%
where $\alpha$ and $\beta$ are determined to minimize deviations of calculated energy gaps
from experimental values for a large group of materials.
The mBJ potential (\ref{mBJ}) reduces to the BJ potential (\ref{BJ}) for $c=1$ and approximates well
the LDA exchange potential for constant electron density given by formula (\ref{Vex}),
independently of the value of parameter $c$.
Compared to the LDA or GGA approximations, calculations with the mBJ potential significantly improve the values
of the energy gap in noble gases, semiconductors and insulators~\cite{Tran2009}.
These values are comparable to results obtained using hybrid functionals or the GW method,
which require very time-consuming calculations.
Since in this approach the exchange potential is improved, not the exchange functional, it cannot be applied
to optimize atomic positions and crystal lattice constants.  
  

\subsection{Electron localization function (ELF)}

meta-GGA functionals use the dimensionless parameter
%
\begin{equation}
\alpha=\frac{\tau-\tau^w}{\tau^{u}},
\end{equation}
%
where $\tau^w$ is the Weizscker kinetic energy density
%
\begin{equation}
\tau^w=\frac{|\nabla n|^2}{8n},
\end{equation}
%
which determines the exact value of $\tau$ for a single orbital, and $\tau^u$ is its value for a homogeneous gas
%
\begin{equation}
\tau^u=\frac{3}{10}\Big{(}\frac{3}{\pi^2}\Big{)}^{\frac{2}{3}}n^{\frac{5}{3}}.
\end{equation}
%
The parameter $\alpha$ is used to characterize the electron density distribution and allows distinguishing
systems with slowly varying electron density, typical for metals ($\alpha\approx 1$),
materials with covalent bonds between single orbitals ($\alpha=0$) and weak non-covalent bonds between
closed atomic shells ($\alpha\rightarrow\infty$).
It is directly related to the electron localization function (ELF)~\cite{ELF1}
%
\begin{equation}
\textrm{ELF} = \frac{1}{1+\alpha^2},
\end{equation}     
%
which takes values from the range $[0,1]$ and is used to describe chemical bonds~\cite{ELF2,ELF3}.
$\text{ELF}=1$ corresponds to ideal electron localization, and $\text{ELF}=\frac{1}{2}$ is the value for an electron gas.  


\subsection{SCAN functional}

In the discussed BJ and mBJ potentials, only the part describing the exchange interaction is changed, while
the correlation part remains unchanged and can be determined within the LDA or GGA approximations.
meta-GGA functionals, whose general form is expressed by formula (\ref{metaGGA}), include corrections in both the
exchange and correlation parts. Several versions of meta-GGA functionals have been proposed, whose names are determined by the acronyms
PKZB~\cite{metaGGA}, TPSS~\cite{TPSS}, revTPSS~\cite{revTPSS} or SCAN~\cite{SCAN}.
Here we will briefly discuss the SCAN functional (strongly constrained and appropriately normed), which
satisfies 17 known conditions and norms for the exchange-correlation functional.
One of them is the condition for the coefficient determining the ratio of exchange energy to the corresponding value in LDA, $F_x=E_x/E^{LDA}_x$, which
cannot exceed the value 1.174. It also correctly describes systems for which exact values are known, e.g., the homogeneous electron gas.

The exchange part of the functional can be written in the form
%
\begin{equation}
E_x[n]=\int d\bm{r} n(\bm{r}) \varepsilon_x(n)F_x(s,\alpha),
\end{equation}
%
where $\varepsilon_x(n)$ is the exchange energy for a homogeneous gas per single electron,
$\alpha$ is the parameter defined in the previous section, and $s$ is the dimensionless density gradient
%
\begin{equation}
s=\frac{|\nabla n|}{2(3\pi^2)^{1/3}n^{4/3}}.
\end{equation}
%
Figure~\ref{fig:Fxs} shows the dependence of the coefficient $F_x$ on $s$ for three characteristic values of $\alpha$.
$F_x$ satisfies the appropriate conditions both for small $s\rightarrow0$ and large values $s\rightarrow\infty$.
For $\alpha=1$ and small $s$, $F_x$ coincides with the values for the PBE functional.
The values of $F_x$ for other values of $\alpha$ are obtained by appropriate interpolation between $\alpha=0$ and $\alpha=1$ and extrapolation
to $\alpha\rightarrow\infty$.
%
\begin{figure}[h]
\centering
\includegraphics[scale=0.5]{Fxs.png}
\caption{Coefficient $F_x$ as a function of $s$ for different values of $\alpha$. Figure from ref. \cite{SCAN}.}
\label{fig:Fxs}
\end{figure}
%

Similarly constructed is the total exchange-correlation functional $F_{xc}=F_{x}+F_{c}$, which in the limit
of high densities of unpolarized gas takes the value of exchange energy $F_x$.
For low densities the functional satisfies the Lieb-Oxford bound, $F_{xc}\leq 2.215$.
 

\section{LDA+U method}
\label{sec:ldau}

The LDA+U method was proposed by Anisimov, Zaanen and Andersen in 1991~\cite{anisimov}.
One of its first applications was the calculation of electronic structure for the high-temperature superconductor La$_2$CuO$_4$~\cite{czyzyk}.
This method consists of combining the DFT approach with the Hubbard model, which has been used since the 1960s to describe strongly correlated electron systems~\cite{hubbard}. I will start by discussing this model.

In the most traditional approach, electronic states in a crystal are divided into two groups: localized states, which are located within the atomic core and possess features of atomic orbitals, and delocalized states, which extend throughout the entire crystal space.
The transport properties of a given material are mainly determined by electrons belonging to the second group.
As for magnetic properties, both localized and itinerant electrons can interact by exchange
and determine the type of magnetic ordering. In the first case we speak of localized magnetic moments,
whose interaction can be described within the framework of the Heisenberg model. In the second case we deal with band magnetism, which results
from the interaction between mobile valence electrons, which can be described using Bloch functions.

There are also electronic states that possess features of both these groups. These states form bands while maintaining
features of atomic orbitals. Electron motion in such a situation consists of hopping between local orbitals and the corresponding bands are much narrower than
typical metallic bands. The source of such behavior is correlation effects that prevent free flow of electrons in the crystal.
The best example is states belonging to the unfilled $3d$ shell in transition metals.
According to the Pauli exclusion principle, each orbital can contain only two electrons with opposite spin directions.
If there is strong, local Coulomb interaction between charges, then quantum states in which two electrons
are in the same orbital are energetically unfavorable. Therefore, electron motion is very difficult and for sufficiently large Coulomb interaction
electrons become localized. Materials in which such a localization mechanism occurs are Mott insulators.

Hubbard proposed a model to describe electronic states that possess features of localized atomic orbitals,
resulting from electron correlations~\cite{hubbard}.
This is an example of a tight-binding model with Wannier orbitals, which is described in chapter~\ref{sec:wannier}.
In the simplest case, we consider single $s$-type orbitals, localized at atomic sites. Strong correlations of electrons located
in the same orbital can be accounted for by adding to the Hamiltonian a local Coulomb interaction of fixed energy $U$.
The Hubbard model Hamiltonian is written using second quantization formalism
%
\begin{equation}
H=\sum_{i,j,\sigma}t_{ij}c^{\dagger}_{i\sigma}c_{j\sigma}+U\sum_i n_{i\uparrow}n_{i\downarrow},
\label{hubbard}
\end{equation}
%
where $c^{\dagger}_{i\sigma}$ and $c_{i\sigma}$ are creation and annihilation operators of an electron with spin $\sigma$ in the localized Wannier orbital $w(\bm{r}-\bm{R}_i)$,
and the hopping integrals are given by the formula
%
\begin{equation}
t_{ij}=\int d\bm{r} w^*(\bm{r}-\bm{R}_i)H_0w(\bm{r}-\bm{R}_j).
\end{equation}
%
$H_0$ is the single-particle Hamiltonian composed of kinetic energy and effective atomic potential.
Most often only hopping integrals between nearest neighbors are taken into account.
The particle number operator with spin $\sigma$ at site $i$ is given by the expression $n_{i\sigma}=c^{\dagger}_{i\sigma}c_{i\sigma}$.
The Coulomb interaction energy of two electrons in the same orbital can be calculated from the formula
%
\begin{equation}
U=\int d\bm{r}d\bm{r}' |w(\bm{r}-\bm{R}_i)|^2\frac{e^2}{|\bm{r}-\bm{r}'|}|w(\bm{r}-\bm{R}_i)|^2.
\end{equation}
%
If we perform the Fourier transform of the creation and annihilation operators,
the first term of the Hamiltonian (\ref{hubbard}) takes the form $\sum_{\bm{k}\sigma}\varepsilon_{\bm{k}}n_{\bm{k}\sigma}$,
where $\varepsilon_{\bm{k}}$ describes the band structure in the tight-binding model,
and $n_{\bm{k}\sigma}=c^{\dagger}_{\bm{k}\sigma}c_{\bm{k}\sigma}$ is the occupation number operator in state $\bm{k}$ and spin $\sigma$.

Several formulations of the LDA+U method have been proposed \cite{anisimov,orbital1,dudarev}, which differ in the description of local
electronic interactions. The general scheme used to calculate the total energy has the form
%
\begin{equation}
E_\text{tot}=E_\text{DFT}+E_U-E_\text{dc},
\label{eldau}
\end{equation}
%
where $E_\text{DFT}$ is the energy of the system obtained within the DFT method (in the LDA or GGA approximation), $E_U$ is the energy of local electronic interactions,
and $E_\text{dc}$ corresponds to the Coulomb interaction energy in the mean field approximation.
This last term is necessary to subtract the approximate electron interaction energy, which is included in $E_\text{DFT}$.
In ref. \cite{orbital1}, a generalized form of energy $E_U$ was proposed, which takes into account the orbital dependence of electronic interactions
%
\begin{multline}
E_U=\frac{1}{2}\sum_{i,\{m\},\sigma}[\langle m,m''|V_{ee}|m',m'''\rangle n_{i\sigma}^{mm'}n_{i-\sigma}^{m''m'''}
\\+(\langle m,m''|V_{ee}|m',m'''\rangle - \langle m,m''|V_{ee}|m''',m'\rangle  )n_{i\sigma}^{mm'}n_{i\sigma}^{m''m'''}],
\end{multline}  
%
where $i$ numbers the lattice sites, $\{m\}=(m, m',m'', m''')$ are magnetic quantum numbers,
and the matrix elements of the Coulomb interaction are given by the formula
%
\begin{equation}
\langle m,m''|V_{ee}|m',m'''\rangle=\int d\bm{r} \int \bm{r}' \phi_{lm}^*(\bm{r})\phi_{lm'}(\bm{r})\frac{e^2}{|\bm{r}-\bm{r}'|}\phi_{lm''}^*(\bm{r}')\phi_{lm'''}(\bm{r}').
\label{integral}
\end{equation}
%
The atomic wave functions appearing under the integral are determined for the orbital quantum number $l$, which defines the range of magnetic quantum numbers $-l\le \{m\} \le l$. The occupation numbers of atomic orbitals form a second-rank tensor, whose elements are determined by projecting the Kohn-Sham wave functions $\psi_{\bm{k}j}^{\sigma}$ onto atomic orbitals
%
\begin{equation}
n_{i\sigma}^{mm'}=\sum_{\bm{k},j} f_{\bm{k}j}^{\sigma}\langle\psi_{\bm{k}j}^{\sigma}|\phi_{lm'}\rangle\langle\phi_{lm}|\psi_{\bm{k}j}\rangle, 
\end{equation}
%
where the coefficients $f_{\bm{k}j}^{\sigma}$ determine the occupation of states $j$ with wave vector $\bm{k}$ and spin $\sigma$.
The integral (\ref{integral}) can be represented as a sum of products of angular and radial parts
%
\begin{equation}
\langle m,m''|V_{ee}|m',m'''\rangle=\sum_p a_p(m,m',m'',m''')F^p,
\label{vee}
\end{equation}
%
where $p$ is an even number from the range $0\le p \le 2l$. The angular part $a_p$ is calculated using products of Clebsch-Gordan coefficients
%
\begin{equation}
a_p(m,m',m'',m''')=\frac{4\pi}{2p+1}\sum_{q=-p}^p \langle lm|Y_{pq}|lm'\rangle\langle lm''|Y_{pq}^*|lm'''\rangle.
\end{equation}
%
$F^p$ are called Slater integrals and are determined from the formula
%
\begin{equation}
F^p=e^2\int d\bm{r}\int d\bm{r}' r^2 r'^2 R_{nl}^2(\bm{r})\frac{r_1^p}{r_2^{p+1}} R_{nl}^2(\bm{r}'),
\end{equation}
%
where $R_{nl}(\bm{r})$ is the radial part of the atomic wave function.
For $d$ states, three Slater integrals $F^0$, $F^2$ and $F^4$ are needed, and for $f$ states additionally $F^6$, to determine the matrix elements
of the Coulomb potential (\ref{vee}).
Effective parameters that determine the local Coulomb ($U$) and exchange ($J$) interactions can be expressed using Slater integrals
%
\begin{eqnarray}
U&=&\frac{1}{(2l+1)^2}\sum_{m.m'} \langle m,m'|V_{ee}|m,m'\rangle=F^0,\\
J&=&\frac{1}{2l(2l+1)}\sum_{m\ne m'} \langle m,m'|V_{ee}|m',m\rangle=\frac{F^2+F^4}{14}.
\label{HundJ}
\end{eqnarray} 
%
Using these parameters, we can write the last term in formula (\ref{eldau}) in the following form
%
\begin{equation}
E_{dc}=\frac{1}{2}\Big[\sum_i Un_i(n_i-1)-J[n_{i\uparrow}(n_{i\uparrow}-1)+n_{i\downarrow}(n_{i\downarrow}-1)]\Big],
\end{equation}
%
where $n_{i\sigma}=\Tr(n_{i\sigma}^{mm'})$ and $n_i=n_{i\uparrow}+n_{i\downarrow}$ is the total occupation of orbitals at site $i$.
The parameters $U$ and $J$ determined in this way refer to isolated atoms. Effective values of the Coulomb parameter $U$,
used for a given type of atom, take into account electron screening effects and depend on the type of material.
It can be determined within the linear response method by calculating the change in electronic state occupation at a selected atom
under the influence of an applied local potential \cite{coco1,coco2}.
The second parameter $J$, called the Hund exchange energy, depends much less weakly on the type of material and often its atomic value (\ref{HundJ}) is used. 


\chapter{Insulators and semiconductors}
\label{sec:insulators}

\section{Energy gap}
\label{sec:bandgap}

The fundamental energy gap is defined as the difference between the ionization energy ($I$), i.e., the process of removing an electron from a given material, 
and the electron affinity ($A$), i.e., the energy obtained from adding an electron
%
\begin{eqnarray}
E_g=I-A&=&[E(N-1)-E(N)]-[E(N)-E(N+1)] \nonumber \\ 
       &=&E(N+1)+E(N-1)-2E(N),
\label{energygap}       
\end{eqnarray}
%
where $E(N)$, $E(N-1)$, and $E(N+1)$ are the total energies determined respectively for the neutral system consisting of $N$ electrons and
systems with a removed and added electron. Each of these energies can be determined as the ground state energy of the system with the appropriate number
of electrons. The gap value can also be expressed using Kohn-Sham state energies 
%
\begin{equation}
E_g=E(N+1)-E(N)-[E(N)-E(N-1)]=\varepsilon_{N+1}(N+1)-\varepsilon_N(N),
\label{truegap}
\end{equation}
%
where $\varepsilon_N(N)$ is the energy of the highest level of the valence band in the system with $N$ electrons,
and $\varepsilon_{N+1}(N+1)$ is the energy of the lowest state of the conduction band in the system with $N+1$ electrons.
Thus, the value of the energy gap is theoretically attainable within DFT, 
provided that the exact dependence $E(N)$ is known. Using the LDA and GGA functionals, we can obtain from formula (\ref{truegap}) only approximate values of the fundamental gap. 
   
Usually, we perform calculations for a system with a fixed number of electrons $N$ and obtain a gap in the Kohn-Sham energy spectrum, 
which is
%
\begin{equation}
\Delta_{KS}=\varepsilon_{N+1}(N)-\varepsilon_N(N).
\label{ksgap}
\end{equation}
%
Comparing formulas (\ref{truegap}) and (\ref{ksgap}), we obtain the relationship between these two gaps
%
\begin{equation}
E_g=\Delta_{KS}+\varepsilon_{N+1}(N+1)-\varepsilon_{N+1}(N)=\Delta_{KS}+\Delta_{xc},
\end{equation}
%
where the difference between them $\Delta_{xc}$ results from the change in the slope of the linear function $E(N)$ at integer electron numbers \cite{pardew82}.
This discontinuity has its origin in the exchange-correlation potential, whose derivative changes abruptly when the number of electrons changes
%
\begin{equation}
\Delta_{xc}=\frac{\delta E_{xc}[n]}{\delta n(\bm{r})}|_{N+\delta}-\frac{\delta E_{xc}[n]}{\delta n(\bm{r})}|_{N-\delta},
\label{deltaxc}
\end{equation}
%
where the functional derivatives are determined for electron densities $n(\bm{r})$, whose integrals over the entire space are equal to $N+\delta$ and $N-\delta$, in the limit $\delta\rightarrow 0$. 

The occurrence of this discontinuity is a fundamental feature of DFT, but in the LDA and GGA approximations, which are characterized by an analytical dependence
of energy on electron density, these discontinuities do not occur. The approximate character of the single-particle state energies,
from which the value of $\Delta_{KS}$ is determined, combined with the lack of discontinuity, causes the energy gaps determined in the LDA approximation to be on average underestimated by $40\%$. In GGA, these values are usually corrected, but also significantly deviate from experimental values. 

\section{Band insulators and semiconductors}

In most semiconductors and insulators, the energy gap results from the existence of completely filled valence bands
and empty conduction bands. The distinction between semiconductors and insulators is not unambiguously defined.
Usually, semiconductors have a smaller energy gap and their electrical conductivity shows a significant dependence
on temperature due to the occurrence of thermally induced current carriers in the conduction band.
In these materials, electronic correlations are usually not strong, but despite this, the energy gap determined within standard DFT approximations
is significantly underestimated. This results from the lack of inclusion of many-body effects that occur
when exciting an electron from the valence band to the conduction band. An example is the electron-hole interaction
occurring for excited states.
In the case of these materials, the LDA+U method is not effective and SIC methods and hybrid functionals are more suitable,
as well as many-body methods of the GW type.
In the SIC method, the total energy depends on the occupation of atomic orbitals, which provides the possibility of reproducing the discontinuity
of the derivatives of the exchange-correlation functional (\ref{deltaxc}) and improving the value of the energy gap.
SIC gives good results for insulators with a large gap such as noble gas crystals \cite{PZ} or ionic crystals. For example, for NaCl the energy gap is $E_g^{SIC}=9.2$~eV \cite{norman83}, which agrees well with the experimental value $E_g^{exp}=8.97$~eV.  

Hybrid functionals, which partially include the exact value of exchange interaction and thereby reduce the electron self-interaction error, 
also improve the value of the energy gap. Figure~\ref{fig:gaphyb} compares experimental energy gap values
with those calculated using four hybrid functionals for a selected group of semiconductors and transition metal oxides (FeO, CoO, NiO, MnO, and VO$_2$)~\cite{Gap-hyb}. Two of these functionals contain 20\% of the exact exchange energy value (B3PW91 and B3LYP), and the other two 25\% (PBE0 and HSE). For most materials 
with a gap smaller than 5 eV, the agreement with experiment is very good for all functionals. At the same time, we see that the selected functionals significantly underestimate the gap values for three semiconductors with a large gap (NaCl, LiCl, and LiF).
Detailed error analysis showed that the best agreement was obtained for the HSE functional, which has a tendency to slightly underestimate the gap value (on average by -0.24 eV). Two functionals B3PW91 and B3LYP slightly overestimate the gap (average errors are 0.14 eV and 0.13 eV). The largest deviation is observed for the PBE0 functional, which overestimates the gap value by an average of 0.43 eV.

\begin{figure}[t!]
\centering
\includegraphics[scale=0.5]{gap-hyb.pdf}
\caption{Comparison of experimental energy gap values with those calculated for different hybrid functionals. Figure from \cite{Gap-hyb}.}
\label{fig:gaphyb}
\end{figure}

Table~\ref{gap} presents energy gap values for selected materials, calculated using different methods
and compared with experimental data. LDA and GGA in all cases significantly underestimate the gap value.
This applies to both semiconductors, especially germanium, where the gap is equal to zero, and insulators.
Large discrepancies compared to experiment are seen for the last three materials, classified as Mott insulators.
Application of the HSE hybrid functional improves the gap values and for most semiconductors the agreement with experiment is very good.
For insulators, this agreement is better or worse depending on the material.
Table~\ref{gap} also shows results obtained using the GW method and its simplified version G$_0$W$_0$, which also give
better gap values. The GW method, which includes many-body interactions within a perturbative expansion, will be the subject of one of
the following chapters. 

\begin{table}[h!]
\caption{Energy gap values calculated using different methods and compared with experimental data.}
\label{gap}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
 Materia & LDA & PBE & HSE & G$_0$W$_0$ & GW & Eksperyment \\ \hline
  C & 4.14 & 4.17  & 4.94 & 5.50 & 6.18 & 5.50 \\
  Si & 0.60 & 0.71  & 1.11 & 1.12 & 1.41 & 1.17 \\
  Ge & 0.00 &  & 0.83 & 0.66 & 0.95 & 0.74 \\
  MgO & 4.70 & 4.74  & 6.46 & 7.25 & 9.16 & 7.90 \\
  GaAs & 0.30 & 0.53  & 1.41 & 1.30 & 1.85 & 1.52 \\
  SiC & 1.35 &    & 2.40 & 2.27 & 2.88 & 2.40 \\ 
  GaP & 1.53 & 1.69 & 2.09 &   &   & 2.35  \\
  CdS & 0.96 & 1.23 & 2.27 &   &   & 2.48 \\
  InP & 0.50 & 0.72 & 1.52 &   &   &  1.42 \\
  BN  & 4.42 & 4.53 & 5.39 &   &   &  6.20 \\
  NaCl & 4.70 & 5.08 & 6.42 &  &   & 8.97  \\
  LiF  & 8.84 & 9.04 & 11.4 &  &   & 13.6  \\  
  MnO & 0.76 &    & 2.80 &  & 3.50 & 3.90 \\ 
  FeO & 0 &    & 2.2 &  &  & 2.4 \\ 
  NiO & 0.42 &    & 4.2 & 1.10 & 4.80 & 4.30 \\ \hline 
\end{tabular}
\end{center}
\end{table}

\section{Mott insulators}

A special class of materials are Mott insulators, whose electronic properties result from strong Coulomb interactions between electrons.
In this case, the characteristic quantity describing the discontinuity calculated within standard approximations $\Delta_{KS}$ is equal to zero 
or is a very small quantity. The energy gap essentially results from the discontinuity of the energy functional ($\Delta_{xc}>0$), arising from changes in orbital state occupation. 
This discontinuous energy change is proportional to the Coulomb interaction energy $U$. For $d$ states in transition metals, the parameter $U$ can be defined
as the energy associated with electron transfer between two atoms with initial occupation $d^n$,
which leads to an increase in the number of electrons on one atom $d^{n+1}$ and a decrease on the other $d^{n-1}$
%
\begin{equation}
U=E(d^{n+1})+E(d^{n-1})-2E(d^n),
\end{equation} 
%
where $E(d^n)$ is the total energy of the system in which a single atom has occupation $d^n$.
This relation means that the energy gap itself given by formula (\ref{energygap}) should be a linear function of $U$.
This is confirmed by calculations performed using the LDA+U method.

As an example, I will discuss the results of calculations of electronic density of states for the Mott insulator Fe$_2$SiO$_4$, obtained by the GGA+U method \cite{Mariana}.
Figure 6.2 shows the results for the antiferromagnetic (AFM) state.
For $U=0$ we get an incorrect metallic state ($\Delta_{KS}=0$) with the Fermi energy crossing the $t_{2g}$ band. 
This band is occupied by electrons with the minority spin direction (direction opposite to the magnetic moment of the given atom). 
Calculations for $U=4.5$ eV give the correct electronic state with an energy gap equal to about 2 eV,
which separates the $t_{2g}$ band into two parts: the occupied lower Hubbard band and the unoccupied upper Hubbard band.

\begin{figure}[h!]
\centering
\includegraphics[scale=0.21]{Fe2SiO4-2.pdf}
\caption{Electronic density of states in Fe$_2$SiO$_4$ for $U=0$ (upper panel) and for $U=4.5$~eV (lower panel). Figure from \cite{Mariana}.}
\label{fig:mott}
\end{figure}

\begin{figure}[t!]
\centering
\includegraphics[scale=0.18]{Fe2SiO4-1.pdf}
\caption{Dependence of the energy gap on the Coulomb interaction parameter $U$ in Fe$_2$SiO$_4$ for the antiferromagnetic state (red circles)
and ferromagnetic state (blue squares). Figure from \cite{Mariana}.}
\label{fig:gap}
\end{figure}

The value of the energy gap depends on the exact value of the parameter $U$, as shown in Figure 6.3.
For small values $U\leq 2$ eV, the energy gap is equal to zero. This follows from the criterion that states that in Mott insulators, 
a nonzero gap forms for values of Coulomb interaction energy greater than the width
of the electronic band, $U>W$. Indeed, from Figure 6.2 it follows that the width of the $t_{2g}$ band is equal with good approximation to $W=2$ eV.
When the Coulomb interaction energy $U$ exceeds $W$, the energy gap grows practically linearly with its value. 
As can be seen from Figure 6.3, the gap values depend on the type of magnetic ordering and for the AFM state are larger than for the FM state.

\chapter{Electric polarization}

\section{Berry phase theory}

Electric polarization plays an important role in many physical phenomena occurring in dielectrics. 
Determining the value of electric polarization in periodic materials such as crystals posed a major theoretical problem. 
In first-principles calculations, due to periodic boundary conditions, such systems are treated as infinite
and the influence of the material surface is usually not taken into account. 
In a finite system, electric polarization can be determined by calculating the total dipole moment composed of ionic
and electronic parts
%
\begin{equation}
\bm{P}=\frac{e}{\Omega}\sum_jZ_j\bm{R}_j+\frac{1}{\Omega}\int d\bm{r} n(\bm{r}) \bm{r},
\label{polaryzacja}
\end{equation}
% 
where both the summation over all ions with charge $Z_je$ and the integration of electron density $n(\bm{r})$ 
is performed over the entire volume $\Omega$. From this same formula, one can calculate the change in polarization $\Delta \bm{P}$
induced by a change in the electron density distribution $\Delta n(\bm{r})$, for example, as a result of atomic displacements. 

In periodic systems, the properties of the entire crystal depend on the arrangement of atoms in the primitive cell.
It seems that the total dipole moment of the crystal and electric polarization can be determined by applying formula (\ref{polaryzacja})
to a single cell. However, such an approach is only possible in limiting cases of ionic
or molecular crystals and corresponds to the classical Clausius-Mossotti description, in which isolated electric dipoles occur.
Electron density is a continuous quantity and it is not possible to divide the entire crystal region in a unique way.  
Moreover, covalent bonds that occur in ferroelectrics have a quantum nature and a proper description of electric polarization
requires a quantum formalism. 

The starting point that enables the determination of polarization in periodic systems is 
the fundamental relationship between the local value of electronic polarization and the flowing current
%
\begin{equation}
\bm{P}_e(\bm{r},t)=\int_{t_0}^t dt' j_e(\bm{r},t').
\label{delP}
\end{equation}
%
This formula also enables the measurement of the change in polarization $\Delta \bm{P}$ by determining the flowing current.
For example, by measuring changes in polarization as a function of crystal deformation, one can determine the piezoelectric constant.
The breakthrough in theory came with works showing the relationship of electric polarization with the geometric Berry phase~\cite{berry1,berry2}. 
In calculations, instead of time, a parameter $\lambda\in [0,1]$ is introduced, which  
describes the adiabatic transformation of the system generating the change in polarization
%
\begin{equation}
\Delta\bm{P}_e = \int_0^1 d\lambda \frac{\partial\bm{P}_e}{\partial\lambda}. 
\end{equation}
%
For example, the parameter $\lambda$ can be a coordinate that determines the position of an atom in the crystal lattice.  
Using an expression from perturbation theory, one can relate the derivative of polarization to the electronic structure 
%
\begin{equation}
\frac{\partial\bm{P}_e}{\partial\lambda}=-i\frac{e\hbar}{\Omega m_e}\sum_{\bm{k}}\sum_{n=1}^{occ}\sum_{m=1}^{emp}\frac{\langle\psi^{\lambda}_{\bm{k}n}|\bm{p}
|\psi^{\lambda}_{\bm{k}m}\rangle\langle\psi^{\lambda}_{\bm{k}m}|\partial V^{\lambda}_{\text{KS}}/\partial\lambda|\psi^{\lambda}_{\bm{k}n}\rangle}{(\varepsilon^{\lambda}_{\bm{k}n}-\varepsilon^{\lambda}_{\bm{k}m})^2}+c.c.,
\label{partialP}
\end{equation}
%
where the summation is performed over all occupied and empty states from the first Brillouin zone. 
Matrix elements of the momentum operator can be expressed by the relation
%
\begin{equation}
\langle\psi^{\lambda}_{\bm{k}n}|\bm{p}|\psi^{\lambda}_{\bm{k}m}\rangle=\frac{m_e}{\hbar}\langle u^\lambda_{\bm{k}n}|[\nabla_{\bm{k}},H^\lambda_{\bm{k}}]|u^\lambda_{\bm{k}m}\rangle,
\end{equation}
%
in which $u^\lambda_{\bm{k}m}$ is the periodic part of the Bloch function, and the Hamiltonian is given by the expression
%
\begin{equation}
H^\lambda_{\bm{k}}=\frac{1}{2m_e}(-i\hbar\nabla+\hbar\bm{k})^2+V^\lambda_\text{KS}.
\end{equation}
%
Similarly, one can express the matrix elements of the derivative of the Kohn-Sham potential
%
\begin{equation}
\langle\psi^{\lambda}_{\bm{k}n}|\frac{\partial V^{\lambda}_{\text{KS}}}{\partial\lambda}|\psi^{\lambda}_{\bm{k}m}\rangle=\frac{m_e}{\hbar}\langle u^\lambda_{\bm{k}n}|[\frac{\partial}{\partial\lambda},H^\lambda_{\bm{k}}]|u^\lambda_{\bm{k}m}\rangle.
\end{equation}
%
After inserting the matrix elements into (\ref{partialP}), we obtain
%
\begin{equation}
\Delta \bm{P}_e=\frac{-ie}{8\pi^3}\sum_{n=1}^{occ}\int_\text{BZ}d\bm{k}\int_0^1d\lambda[\langle\nabla u^\lambda_{\bm{k}n}|                  
\frac{\partial u^\lambda_{\bm{k}n}}{\partial\lambda}\rangle-\langle\frac{\partial u^\lambda_{\bm{k}n}}{\partial\lambda}|                  
\nabla_{\bm{k}} u^\lambda_{\bm{k}n}\rangle].
\end{equation}
Performing integration by parts and using the periodicity of the function $u_{\bm{k}n}$, we obtain
%
\begin{equation}
\Delta \bm{P}_e=\bm{P}^{\lambda=1}_e-\bm{P}^{\lambda=0}_e,
\label{pol1}
\end{equation}
%
gdzie
%
\begin{equation}
\bm{P}^\lambda_e=\frac{ie}{8\pi^2}\sum_{n=1}^{occ}\int_\text{BZ}d\bm{k}\langle u^\lambda_{\bm{k}n}|\nabla_{\bm{k}}|u^\lambda_{\bm {k}n}\rangle.
\label{pol2}
\end{equation}
%
The integral appearing in this formula is directly related to the Berry phase of electronic states~\cite{Zak}.
The vector quantity $\bm{A}(\bm{k})=i\langle u^\lambda_{\bm{k}n}|\nabla_{\bm{k}}|u^\lambda_{\bm {k}n}\rangle$
is called the gauge potential or Berry connection, and the integral of this quantity
over a closed region is the Berry phase, which for a given band $n$ and direction $j$ can be written in the form
%
\begin{equation}
\phi^\lambda_{nj}=\frac{i}{\Omega_\text{BZ}}\int_\text{BZ} d\bm{k}\langle u^\lambda_{\bm{k}n}|\bm{G}_j\nabla_{\bm{k}}|u^\lambda_{\bm {k}n}\rangle,
\end{equation}
%
where $\bm{G}_j$ is a reciprocal lattice vector. 
The polarization associated with band $n$ is expressed by the formula
%
\begin{equation}
\bm{P}^\lambda_n=\frac{e}{2\pi\Omega}\sum_j\phi^\lambda_{nj}\bm{R}_j.
\end{equation}
%
The obtained result, which shows the relationship of electric polarization with the phase of the wave function, is not surprising.
In quantum mechanics, the phase of the wave function is directly related to the electric current
and according to formula (\ref{delP}) also determines the electric polarization. 
% **[REVIEW NEEDED]**: Consider the precise wording of "modulo a constant value" in this context.
Like any phase, electric polarization is also not a uniquely defined value, but only defined {\it modulo}
a constant value. To determine this value, we assume that the initial state ($\lambda=0$) and final state ($\lambda=1$) are described
by the same Hamiltonian. Then the wave functions for these states can differ only by the value of the phase
%
\begin{equation}
u^{\lambda=1}_{\bm{k}n}(\bm{r})=e^{i\theta_{\bm{k}n}}u^{\lambda=0}_{\bm{\bm{k}n}}(\bm{r}).
\end{equation}
%
The change in phase can be written in the general form
%
\begin{equation}
\theta_{\bm{k}n}=\beta_{\bm{k}n}+\bm{k}\bm{R}_n,
\end{equation}
%
where $\beta_{\bm{k}n}$ is a periodic function in $\bm{k}$. According to formula (\ref{pol2}), the change in polarization in this case is
%
\begin{equation}
\Delta\bm{P}_e=-\frac{e}{8\pi^3}\sum_{n=1}^{occ}\int_\text{BZ}d\bm{k}\nabla_{\bm{k}}\theta_{\bm{k}n}=\frac{e}{\Omega}\sum_{n=1}^{occ}\bm{R}_n=\frac{e}{\Omega}\bm{R}.
\end{equation}
%
For each crystal lattice, one can determine the smallest value $e\bm{R}_1/\Omega$, 
which defines the polarization quantum, associated with the translational symmetry of the electronic potential, $V(\bm{r})=V(\bm{r}-\bm{R}_1)$.
Due to the periodicity of the crystal, the absolute value of polarization does not make much sense and what matters is the change in polarization between two states.
Atomic displacements that are typically considered are much smaller than distances between atoms, and the calculated change in polarization
is much smaller than the polarization quantum, $\Delta\bm{P}_e\ll e\bm{R}_1/\Omega$. This allows one to eliminate the ambiguity in the value of polarization
in practical applications.  

Electric polarization can also be expressed in the representation of Wannier functions,
which are Fourier transforms of Bloch functions
%
\begin{equation}
\psi^{\lambda}_{\bm{k}j}=e^{i\bm{k}{r}}u^\lambda_{\bm{k}n}(\bm{r})=\frac{1}{\sqrt{N}}\sum_je^{i\bm{k}\bm{R}_j}w^\lambda_n(\bm{r}-\bm{R}_j),
\end{equation}
%
where $\bm{R}_j$ are crystal lattice vectors. Calculating $u^\lambda_{\bm{k}n}$ from this relation and inserting it into formula (\ref{pol2}), we obtain 
%
\begin{equation}
\Delta\bm{P}_e=-\frac{e}{\Omega}\sum_{n=1}^{occ} [\int d\bm{r} \bm{r}|w^{\lambda=1}_n(\bm{r})|^2-\int d\bm{r} \bm{r}|w^{\lambda=0}_n(\bm{r})|^2].
\end{equation}
%
This formula shows that the change in polarization is proportional to the shift of the center of gravity of the charge density distribution,
localized on Wannier orbitals, induced by an adiabatic change in the electronic potential.


\section{Effective charges}

According to formula (\ref{polaryzacja}), the total change in polarization along direction $\alpha$
consists of ionic and electronic parts
%
\begin{equation}
(\Delta\bm{P})_\alpha=(\Delta\bm{P}_\text{ion})_\alpha+(\Delta\bm{P}_e)_\alpha.
\label{pol3}
\end{equation}
% 
The electronic part of polarization is given by expressions (\ref{pol1}) and (\ref{pol2}), while the ionic part is calculated from the formula
%
\begin{equation}
(\Delta\bm{P}_\text{ion})_\alpha=\frac{e}{\Omega}Z_\text{ion}u_\alpha,
\label{pol4}
\end{equation}
%
where $Z_{ion}$ is the atomic core charge, and $u_\alpha$ is the value of atomic displacement.
The change in total polarization can be written in the form
%
\begin{equation}
(\Delta\bm{P})_\alpha = \frac{\partial P_\alpha}{\partial u_\beta}u_\beta = \frac{e}{\Omega}Z^*_{\alpha\beta} u_\beta,
\label{pol5}
\end{equation}
%
where $Z^*_{\alpha\beta}$ is the Born effective charge tensor.
The number of independent and nonzero components of the tensor depends on the crystal symmetry and the number of inequivalent atomic positions. 
All components of the tensor $Z^*_{\alpha\beta}$ can be determined using formula (\ref{pol5}), by calculating
the change in polarization for atomic displacements in different directions. 

Effective charges take nonzero values in all insulators and play an important role in describing
lattice dynamics. Ion displacements associated with longitudinal optical modes (LO) at the center of the Brillouin zone ($\bm{k}=0$), which are active in the infrared ({\it infrared modes}), generate macroscopic electric polarization and thus modify interatomic forces.
These additional forces cause the energy of LO modes near the $\Gamma$ point to be larger than that of transverse optical modes (TO).
This causes the LO-TO splitting, which can be calculated if we know the effective charges of ions and the dielectric constant of the material~\cite{PCM}.

 
\section{Ferroelectrics}

Ferroelectrics belong to a separate group of insulators in which electric polarization spontaneously appears under specific
thermodynamic conditions. The practical use of ferroelectrics stems from the possibility of switching the direction of polarization
after applying an electric field. In metals, electronic currents are induced that screen the electric field 
and therefore electron localization is a necessary condition for the occurrence of macroscopic electric polarization.  
In insulators, electrons cannot move freely in the crystal, but they participate in polarization currents, 
related to the local value of electric polarization.  
In ferroelectrics, covalent bonds and hybridization between different electronic states play an important role, 
enabling charge transfer between ions.
% **[REVIEW NEEDED]**: Consider whether "structural phase transition" or "structural phase transformation" is preferred terminology.
The most basic mechanism for the formation of the ferroelectric phase is associated with a structural phase transition. 
In the paraelectric phase, which usually occurs at higher temperatures, the crystal lattice has centrosymmetric symmetry,
in which the average polarization $\bm{P}=0$. For spontaneous polarization to arise, there must be a transformation of the system
to a structure without a center of symmetry, that is, one that is not invariant with respect to the operation ($\bm{r}\rightarrow -\bm{r}$).
This is a necessary condition for the occurrence of the ferroelectric phase, where $\bm{P}\neq 0$.

\begin{figure}[h!]
\centering
\includegraphics[scale=1]{BaTiO3.pdf}
\caption{Deformation of the crystal lattice of a ferroelectric with perovskite structure ABO$_3$.}
\label{fig:batio3}
\end{figure}

An example of ferroelectrics are materials with the perovskite structure ABO$_3$, shown in Figure (\ref{fig:batio3}).
This group includes barium titanate BaTiO$_3$ and many other oxides containing transition metals.
At the corners of the cell are cations A, while the cation B located in the center is surrounded by an octahedron of anions O.
At high temperatures, the crystal has centrosymmetric cubic symmetry. Upon lowering the temperature, lattice instability appears in the material, associated with the occurrence of a soft phonon mode whose energy approaches zero as the phase transition is approached.
Atomic displacements in the soft mode, shown schematically in Figure (\ref{fig:batio3}), lead to static 
lattice deformation below the critical temperature. In the tetragonal structure, centrosymmetric symmetry is broken 
and nonzero electric polarization appears, whose source is the relative displacement of anions (O)
relative to cations (A and B). The change in polarization is caused not only by the rigid displacement of charges localized on ions,
but also, as explained in previous chapters, by the flow of electronic currents along covalent bonds. 
 
The value of electric polarization in ferroelectrics can be calculated starting from the initial state ($\lambda=0$), which corresponds to ion positions in the centrosymmetric structure ($\bm{P}=0$).
Then the change in polarization (\ref{pol3}), induced by displacing ions to positions in the non-centrosymmetric structure,
corresponds to the value of spontaneous polarization that appears as a result of the phase transition.
The value of polarization calculated for the ferroelectric KNbO$_3$ is 0.35 C/m$^2$~\cite{resta1993}
and agrees very well with the experimentally determined value of 0.37 C/m$^2$. 
 
In ferroelectrics, particularly large values of effective charges occur, often significantly exceeding the static charges of ions. 
For example, in the cubic structure of BaTiO$_3$, the effective charges of ions located at four inequivalent positions take the values: 
$Z^*_\text{Ba}=2.75$, $Z^*_\text{Ti}=7.06$, $Z^*_\text{O1}=-5.83$, and $Z^*_\text{O2}=-2.11$~\cite{zhong1994}.
The significantly elevated values of effective charges of Ti and O1 ions result from strong hybridization between $3d$ and $2p$ states 
in the covalent Ti-O1 bond. A change in the distance between these ions generates charge transfer (polarization current)
and a change in polarization according to formula (\ref{delP}). The total change in polarization consists of the ionic part, dependent on static charges~(\ref{pol4}),
and the electronic part, which causes an increase in the value of effective charges.
Large effective charges cause the LO-TO splitting to take very large values in ferroelectrics~\cite{zhong1994}.

 
\chapter{Oddziaywanie van der Waalsa}
\label{sec:vdw}

\section{Podstawowe wasnoci}

Oddziaywanie van der Waalsa (vdW) nazywane rwnie dyspersyjnym jest efektem korelacji elektronowych, ktre nie s uwzgldnione
w standardowych funkcjonaach wymienno-korelacyjnych.
Jest to oddziaywanie przycigajce odgrywajce wan role w krysztaach molekularnych, takich jak
krysztay gazw szlachetnych, w ktrych atomy maj zamknite powoki elektronowe,
oraz materiay skadajce si z neutralnych czsteczek. 
Wane jest te w ukadach biologicznych, np. ma duy wpyw na prawidowy ksztat i dziaanie biaek.
rdem tego oddziaywania s fluktacje kwantowe dipola elektrycznego na jednym atomie (molekule), ktre indukuj dipol elektryczny na innym atomie (molekule).
Wzajemne oddziaywanie tych dipoli prowadzi do sabego przycigania atomw lub moleku. 
W klasycznym opisie, pole elektryczne wytworze przez moment dipolowy $p_1$ w odlegoci $R$ mona wyrazi wzorem 
%
\begin{equation}
E=\frac{p_1}{R^3}.
\end{equation}
% 
Jeeli pole elektryczne oddziauje na czsteczk o polaryzowalnoci $\alpha$ to indukuje moment dipolowy
%
\begin{equation}
p_2=\frac{\alpha p_1}{R^3}.
\end{equation}
%
rednia energia oddziaywania tych dwch dipoli wynosi
%
\begin{equation}
U=-\frac{\alpha p_1^2}{R^6}.
\end{equation}
%
Uwzglednienie korelacji elektronowych w ramach teorii perturbacyjneje prowadzi do takiej samej zaleno oddziaywania 
od odlegoci $\sim R^{-6}$, ale poprawne wyznaczenie polaryzowalnoci i siy oddziaywania wymaga wyjcia poza najprostsze 
przyblienie faz przypadkowych ({\it ang. random-phase approximation} - RPA).   
 
\section{Poprawki do funkcjonau energii}
 
\subsection{Metody D2 i D3}  
 
W obliczeniach DFT mona uwzldni przyblion warto energii oddziaywania vdW jako poprawk do cakowitej energii ukadu
%
\begin{equation}
E_\text{tot}=E_\text{KS}+E_\text{vdW}
\end{equation}
%
gdzie $E_\text{KS}$ jest wyznaczonym w procedurze samozgodnej funkcjonaem Kohna-Shama.
W takim podejciu oddziaywanie vdW nie wpywa bezporednio na struktur elektronow, 
jedynie poprzez modyfikacj odlegoci midzy atomami.
 
W wersji, ktr zaproponowa Grimme~\cite{grimme2004,grimme2006}, zaleno energii vdW od odlegoci midzy atomami $R_{ij}$
ma posta
%
\begin{equation}
E_\text{vdW}=-\frac{1}{2}\sum_{i,j}f_\text{d}(R_{ij})\frac{C_{6ij}}{R_{ij}^6},
\end{equation}
% 
gdzie $f_\text{d}$ jest funkcj tumic, ktra okrela asymptotyczne zachowanie dla $R_{ij}\rightarrow 0$  
i wyklucza podwjne uzwgldnianie efektw korelacyjnych przy porednich odlegociach.
Jej rol jest zapewnienie, e oddziaywanie vdW ograniczone jest do odlegoci wikszych ni 
dugoci typowych wiza, poprawnie opisywanych w ramach standardowych funkcjonaw.
Wspczynniki dyspersyjne $C_{6ij}$ zdefiniowane s dla kadej pary atomw
jako rednie geometryczne parametrw atomowych
%
\begin{equation}
C_{6ij}=\sqrt{C_{6i}C_{6j}}.
\end{equation}
%
Dla kadego atomu okrela si parametr $C_6=0.05NI_\text{p}\alpha$, gdzie $I_\text{p}$ jest potencjaem jonizujcym, $\alpha$ jest
statyczn polaryzowalnocia dipolow, a $N=2, 10, 18, 36, 54$ dla kolejnych rzdw ukadu okresowego pierwiastkw.  
Wspczynnik skalujcy wyznaczonony jest tak, aby zreprodukowa odlegoci midzyatomowe i energie wizania
w odpowiedniej grupie pierwiastkw. Funkcj tumic mona zapisa w formie \cite{grimme2006}
%
\begin{equation}
f_\text{d}(R_{ij})=\frac{s_6}{1+e^{-d(R_{ij}/R_{0ij}-1)}},
\label{damping}
\end{equation}
%
gdzie $s_6$ jest wspczynnikiem okrelonym dla danego funkcjonau DFT, np. $s_6=0.75$ dla PBE,
$d$ jest wspczynnikim tumienia, ktrego typowa warto wynosi 20, a $R_{0ij}=R_{0i}+R_{0j}$ jest promieniem odcicia
i wyraa si sum promieni vdW dla danych atomw. 
Parametry $C_{6i}$ i $R_{0i}$ s zdefiniowane dla wszystkch atomw i nie zale od rodzaju materiau. 
Dodatkowo w obliczeniach okrela si maksymalny zasig oddziaywania vdW. 
Opisany schemat (DFT-D2) umoliwia poprawienie wyliczanych si i odlegoci midzyatomowych w krysztaach gazw szlachetnych oraz
ukadach molekularnych~\cite{bucko2010}. Oddziaywanie vdW odgrywa rwnie wan rol w materiaach warstwowych,
dla ktrych standardowe obliczenia DFT daj zwykle zanion warto siy wicej midzy warstwami. 
Przykadowo, staa sieci $c$ w graficie, ktrej warto w przyblieniu PBE ($c=8.84$~\AA)
jest znacznie zawyona w porwnaniu do wartoci eksperymentalnej ($6.71$~\AA), wyliczona z poprawk D2 wynosi $6.45$~\AA~\cite{bucko2010}.     

W kolejnym podejciu (D3), Grimme uwzgldni dodatkowo drugi wyraz w wzorze na energi oddziaywania proporcjonalny do $R^{-8}$~\cite{grimme2010}
%
\begin{equation}
E_\text{vdW}=-\frac{1}{2}\sum_{i,j}[f_{\text{d},6}(R_{ij})\frac{C_{6ij}}{R_{ij}^6}+f_{\text{d},8}(R_{ij})\frac{C_{8ij}}{R_{ij}^8}].
\end{equation}
%
Wspczynniki dyspersyjne $C_{6ij}$ wyznaczane s ze wzoru Casimira-Poldera 
%
\begin{equation}
C_{6ij}=\frac{3}{\pi} \int d\omega \alpha_i(\omega)\alpha_j(\omega), 
\label{CP}
\end{equation}
%
gdzie $\alpha_i(\omega)$ jest redni polaryzowalnoci dipolow dla atomu $i$.
Wspczynniki $C_{8ij}$ wyliczane s z zalenoci $C_{8ij}=3C_{6ij}\sqrt{Q_iQ_j}$, gdzie $Q_i=s\sqrt{Z_i}\langle r^4\rangle_i/\langle r^2\rangle_i$.
Funkcje tumice maj posta
%
\begin{equation}
f_{\text{d},n}(R_{ij})=\frac{s_n}{1+6(R_{ij}/(s_{R,n}R_{0ij}))^{-\alpha_n}}.
\end{equation}
%
W tym wzorze optymalizowane s parametry $s_6$, $s_8$ i $s_{R,6}$, a pozostae maj ustalone wartoci ($s_{R,8}=1$, $\alpha_6=14$, $\alpha_8=16$). 
Alternatywnie mona zastosowa funkcj tumic Becke-Johnsona (BJ) w postaci
%
\begin{equation}
f_{\text{d},n}(R_{ij})=\frac{s_nR_{ij}^n}{R_{ij}^n+(a_1R_{0ij}+a_2)^n},
\end{equation}
%
gdzie $s_n$, $a_1$ i $a_2$ sa parametrami dopasowania. Promie odcicia mona wyznaczy znajc wspczynniki dyspersyjne
$R_{0ij}=\sqrt{C_{8ij}/C_{6ij}}$. Analiza porwnawcza przeprowadzona dla duej grupy materiaw
pokazaa niewielki wpyw rodzaju funkcji tumicej na wyliczone odlegoci midzy atomami i troch lepsz dokadno 
przy zastosowaniu funkcji BJ do wasnoci termodynamicznych~\cite{grimme2011}. 

\subsection{Metoda TS}

W metodzie zaproponowanej przez Tkatchenko i Schefflera (TS)~\cite{tkatchenko2009} bierze si pod uwag tylko wyraz proporcjonalny do $R^{-6}$, ale
uwzgldnia si zaleno wspczynnikw dyspersyjnych i promienia odcici od gstoci adunku.
Wprowdzamy przyblion zaleno polaryzowalnoci od czstoci
%
\begin{equation}
\alpha_i(\omega)=\frac{\alpha^0_i}{1-(\omega/\eta_i)^2},
\label{alpha}
\end{equation}
%
gdzie $\alpha^0_i$ jest statyczn polaryzowalnoci i $\eta_i$ jest efektywn czstoci dla atomu $i$.
Po wstawieniu (\ref{alpha}) do (\ref{CP}) otrzymujemy formu Londona
%
\begin{equation}
C_{6ij}=\frac{3\eta_i\eta_j}{2(\eta_i+\eta_j)}\alpha_i^0\alpha_j^0.
\end{equation}
%
Dla jednakowych atomw ($i=j$) otrzymujemy wzr
%
\begin{equation}
\eta_i=\frac{4C_{6i}}{3(\alpha_i^0)^2},
\end{equation}
%
ktry prowadzi do zalenoci
%
\begin{equation}
C_{6ij}=\frac{2C_{6i}C_{6j}}{\frac{\alpha^0_j}{\alpha^0_i}C_{6i}+\frac{\alpha^0_i}{\alpha^0_j}C_{6j}}.
\end{equation}
%
Wspczynniki dyspersyjne dla poszczeglnych atomw znajdujcych si wewntrz czsteczek lub cia staych
wyznacza si z wartoci dla izolowanych atomw uywajc nastpujcej formuy $C_{6i}=\nu_i^2C^{free}_{6i}$, gdzie $\nu_i$
okrela efektywn objto atomu (podzia Hirshfelda)
%
\begin{equation}
\nu_i=\frac{V_i^{eff}}{V_i^{free}}=\frac{\int d\bm{r} r^3 w_i(\bm{r}) n(\bm{r})}{\int d\bm{r} r^3 n_i^{free}(\bm{r})},
\end{equation}
%
z wagami Hirshfelda, ktre wyliczane s dla urednionych sferycznie gstoci elektronowych w izolowanych atomach
%
\begin{equation}
w_i(\bm{r})=\frac{n_i^{free}(\bm{r})}{\sum_j n_i^{free}(\bm{r})}.
\end{equation}
%
Podobnie znajc wartoci polaryzowalnoci i promieni vdW dla izolowanych atomw, mona wyznaczy te wartoci
dla atomw w czsteczkach i krysztaach: $\alpha_i=\nu_i\alpha^{free}$ i $R_{0i}=\nu_i^{\frac{1}{3}}R_{0i}^{free}$.
Promienie vdW su do wyznaczenia promienia odcicia $R_{0ij}$ i funkcji tumiacej $f_{\text{d},n}$ (\ref{damping}).

W omwionych podejciach zakada si jedynie oddziaywania dwuciaowe, nie biorc pod uwag modyfikacji oddziaywania vdW przez otaczajce atomy lub molekuy. 
W udoskonalonej wersji metody TS uwzglednia si dalekozasigowe ekranowanie elektryczne w sposb samozgodny ({\it ang. self-consistent screening} - SCS)~\cite{tkatchenko2012}. Odpowiednie rwnanie samozgodne pozwalajce wyznaczy zmodyfikowan polaryzowalno ma posta
%
\begin{equation}
\alpha_i^\text{SCS}(\omega)=\alpha_i(\omega)-\alpha_i(\omega)\sum_{i\neq j}\tau_{ij}\alpha_i^\text{SCS}(\omega),
\end{equation}
%
gdzie $\tau_{ij}$ jest tensorem oddziaywania dipol-dipol. Energi dyspersyjn wyznacza si z tych samych rwna co w metodzie TS
z odpowiednio zmodyfikowanymi wspczynnikami dyspersyjnymi i promieniami odcicia
%
\begin{equation}
C_{6i}=\frac{3}{\pi}\int_0^\infty d\omega[\alpha^\text{SCS}_i(\omega)]^2,
\end{equation}
%
\begin{equation}
R_{0i}^\text{SCS}=\Big{(}\frac{\alpha_i^\text{SCS}}{\alpha_i}\Big{)}^{\frac{1}{3}}R_{0i}.
\end{equation}

%\subsection{Metoda MBD}

\chapter{Efekty wielociaowe i stany wzbudzone}

\section{Funkcje Greena i energia wasna}

Dokadny opis stanw elektronowych wymaga wyjcia poza przyblienie niezalenych czstek.   
Stosujc formalizm drugiego kwantowania, zapiszemy hamiltonian ukadu oddziaujcych elektronw 
w oglnej formie
%
\begin{equation}
H=\int d^3r \psi^\dagger(\bm{r},t) h_0(\bm{r}) \psi(\bm{r},t) +\frac{1}{2}\int d^3rd^3r' \psi^\dagger(\bm{r},t)\psi^\dagger(\bm{r}',t)v(\bm{r}-\bm{r}') \psi^\dagger(\bm{r}',t)\psi^\dagger(\bm{r},t),
\end{equation}
%  
gdzie $h_0(x)$ opisuje energi kinetyczn oraz oddziaywanie elektronw z zewntrznym polem, $v(\bm{r}-\bm{r}')$ jest
potencjaem oddziaywania kulombowskiego midzy elektronami, a $\psi(\bm{r},t)$ jest operatorem pola w obrazie Heisenberga 
%
\begin{equation}
\psi(\bm{r},t)=e^{\frac{i}{\hbar}Ht}\psi(\bm{r})e^{-\frac{i}{\hbar}Ht}.
\label{field}
\end{equation}
%
Operatory pola $\psi^\dagger(\bm{r})$ i $\psi(\bm{r})$ opisuj kreacje i anihilacj elektronu w punkcie $\bm{r}$.

Stan podstawowy $|\Phi_N\rangle$ ukadu $N$ oddziaujcych elektronw spenia rwnanie 
%
\begin{equation}
H|\Phi_N\rangle=E|\Phi_N\rangle.
\end{equation}
%
Dalej zakadamy, e stan podstawowy jest unormowany $\langle\Phi_N|\Phi_N\rangle=1$.

W kwantowej teorii ukadw wielu czastek mona powiza spektrum wzbudze z jednoczstkowymi funkcjami Greena, 
zwanymi rwnie propagatorami, ktre definiujemy
%
\begin{equation} 
iG(x,x')=\langle \Phi_N|T\psi(x)\psi^\dagger(x')|\Phi_N\rangle=\begin{cases}
        \langle \Phi_N|\psi(x)\psi^\dagger(x')|\Phi_N\rangle & t>t',\\
        -\langle \Phi_N|T\psi^\dagger(x')\psi(x)|\Phi_N\rangle & t'>t,
             \end{cases}    
\label{greenf}                      
\end{equation}
% 
gdzie wprowadzono oznaczenie $x=(\bm{r},t)$, a $T$ jest operatorem uporzdkowania w czasie. 
Funkcja Greena jest amplitud prawdopodobiestwa propagacji elektronu z punktu $x'$ do punktu $x$ dla $t>t'$ 
lub dziury z punktu $x$ do $x'$ dla $t'>t$. Te dwa przypadki opisuj odpowiednio proces fotoemisji i odwrotnej fotoemisji.
Funkcje Greena dla elektronw s macierzami ze wzgldu na spinowe stopnie swobody. Dla uproszczenia zapisu pomijamy
tutaj wskaniki numerujce stany spinowe.
Zajomo funkcji Green pozwala wyznaczy energi stanu podstawowego, wartoci oczekiwanego jednoczstkowych operatorw
w stanie podstawowym oraz jednoelektronowe spektrum wzbudze.
Funkcje Greena speniaja rwnanie ruchu
%
\begin{equation}
[i\frac{\partial}{\partial t}-H_0(x))]G(x,x')-\int dx''\Sigma(x,x'')G(x'',x')=\delta(x-x'),
\end{equation}
%
gdzie $H_0 =h_0+V_H$ ($V_H$ jest potencjaem Hartree), a $\Sigma$ nosi nazw energii wasnej i opisuje oddziaywania wymienno-korelacyjne.

Dla ukadu jednorodnego o objtoci $V$, funkcj Greena moemy zapisa w formie transformaty Fouriera
%
\begin{equation}
G(x,x')=\sum_{\bm{k}}\int\frac{d\omega}{2\pi V}e^{i\bm{k}(\bm{r}-\bm{r}')}e^{-i\omega(t-t')}G(\bm{k},\omega).
\label{fourier}
\end{equation}
%
$G(\bm{k},\omega)$ jest funkcj Greena, ktra opisuje propagacj elektronu o zdefiniowanym wektorze falowym $\bm{k}$.
Rozwamy na pocztku ukad $N$ nieodziaujcych elektronw. Operatory pola mona zapisa
%
\begin{equation}
\psi(\bm{r})=\frac{1}{V}\sum_{\bm{k}}e^{-i\bm{k}\bm{r}}c_{\bm{k}},
\label{free}
\end{equation}
%
gdzie $c_{\bm{k}}$ jest operatorem anihilacji electronu, dla ktrego $c_{\bm{k}}|\Phi_N\rangle=0$.
Odpowiednio $c^\dagger_{k}$ jest operatorem kreacji elektronu o wektorze falowym $\bm{k}$.
Mona przedefiniowa operatory kreacji i anihilacji wprowadzajc osobne oznaczenia dla czstek i dziur
%
\begin{equation}
c_{\bm{k}}=\begin{cases}
a_{\bm{k}} & k>k_F,\\
b^\dagger_{-\bm{k}} & k<k_F,\end{cases}
\end{equation}
%
gdzie $k_F$ jest wektorem falowym Fermiego. Hamiltonian w tej reprezentacji przyjmuje posta
%
\begin{equation}
H_0=\sum_{\bm{k}}\hbar\omega_{\bm{k}} c^\dagger_{\bm{k}}c_{\bm{k}}=\sum_{\bm{k}>\bm{k}_F}\hbar\omega_{\bm{k}} a^\dagger_{\bm{k}}a_{\bm{k}}-\sum_{\bm{k}<\bm{k}_F}\hbar\omega_{\bm{k}} b^\dagger_{\bm{k}}b_{\bm{k}}+\sum_{\bm{k}<\bm{k}_F}\hbar\omega_{\bm{k}}.
\end{equation}
%
Wykorzystujc wzory (\ref{free}) i (\ref{field}) otrzymujemy zaleno dla funkcji Greena swobodnych elektronw
%
\begin{equation}
iG_0(x,x')=\frac{1}{(2\pi)^3}\int d^3k e^{i\bm{k}(\bm{r}-\bm{r}')}e^{-i\omega_{\bm{k}}(t-t')}[\theta(t-t')\theta(k-k_F)-\theta(t'-t)\theta(k_F-k)].
\end{equation}
%
gdzie sumowanie po stanach $\bm{k}$ zostao zamienione na cak.
Funkcj schodkow $\theta(t-t')$  mona zapisa przy pomocy wzoru
%
\begin{equation}
\theta(t-t')=-\int_{-\infty}^{\infty}\frac{d\omega}{2\pi i}\frac{e^{-i\omega(t-t')}}{\omega+i\eta}=\begin{cases}1 & t>t',\\0 & t<t',\end{cases}
\end{equation}
% 
gdzie $\eta$ jest infinitezymalnie ma liczb. Zastosowanie tego wyraenie po prostych przeksztaceniach
prowadzi do wzoru
%
\begin{equation}
G_0(x,x')=\frac{1}{(2\pi)^4}\int d^3k e^{i\bm{k}(\bm{r}-\bm{r}')}e^{-i\omega(t-t')}\Big{[}\frac{\theta(k-k_F)}{\omega-\omega_{\bm{k}}+i\eta}+\frac{\theta(k_F-k)}{\omega-\omega_{\bm{k}}-i\eta}\Big{]}.
\end{equation}
%
Porwnujce ten wzr z (\ref{fourier}) dostajemy wyraenie na funkcj Greena swobodnych elektronw
w przestrzeni pdw
%
\begin{equation}
G_0(\bm{k},\omega)=\frac{\theta(k-k_F)}{\omega-\omega_{\bm{k}}+i\eta}+\frac{\theta(k_F-k)}{\omega-\omega_{\bm{k}}-i\eta},
\label{G0}
\end{equation}
%
Wystpujce w tym wzorze dwa wyrazy odpowiadaj odpowiednio propagacji elektronu dla wektora falowego $k$
wikszego do wektor falowego Fermiego $k_F$ i dziury dla $k<k_F$. 

Funckj Greena dla oddziaujcych elektronw mona zapisa w postaci szeregu perturbacyjnego
%
\begin{equation}
G(\bm{k},\omega)=G_0(\bm{k},\omega)+G_0(\bm{k},\omega)\Sigma_{\bm{k}}(\omega)G_0(\bm{k},\omega)+G_0(\bm{k},\omega)\Sigma_{\bm{k}}(\omega) G_0(\bm{k},\omega)\Sigma_{\bm{k}}(\omega) G_0(\bm{k},\omega)+...
\end{equation}
%
gdzie $\Sigma_{\bm{k}}(\omega)$ jest transformat Fouriera energii wasnej. 
Szereg ten mona zapisa w formie rwnania Dysona
%
\begin{equation}
G(\bm{k},\omega)=G_0(\bm{k},\omega)+G_0(\bm{k},\omega)\Sigma_{\bm{k}}(\omega)G(\bm{k},\omega),
\end{equation}
%
lub po przeksztaceniu
%
\begin{equation}
\Sigma_{\bm{k}}(\omega)=G_0^{-1}(\bm{k},\omega)-G^{-1}(\bm{k},\omega).
\end{equation}
%
czc ten wzr z wyraeniem (\ref{G0}) dla swobodnych elektronw ($k>k_F$)
dostajemu wzr na funkcj Greena
%
\begin{equation}
G(\bm{k},\omega)=\frac{1}{\omega-\omega_{\bm{k}}-\Sigma_{\bm{k}}(\omega)}.
\end{equation}
%
Z tego wzoru wynika, e jednoczstkowe stany o energii $\omega_{\bm{k}}$ s modyfikowane zarwno
przez rzeczywist cz energii wasnej, ktra przesuwa wartoci energii, jak rwnie przez
jej cz urojon. 

Znajc funkcj Greena mona wyznaczy funkcj spektraln, ktra opisuje widmo energetyczne elektronw w funkcji wektora falowego,
wyznaczane w pomiarach metod ktowo-rozdzielczej spektroskopii fotoemisyjnej (ARPES).
Funkcja spektralna wyznaczana jest czci urojonej funkcji Greena
%
\begin{equation}
A_{\bm{k}}(\omega)=\frac{1}{\pi}|\text{Im} G_{\bm{k}}(\omega)|=\frac{1}{\pi}\frac{|\text{Im} \Sigma_{\bm{k}}(\omega)|}{[\omega-\omega_{\bm{k}}-\text{Re} \Sigma_{\bm{k}}(\omega)]^2+[\text{Im} \Sigma_{\bm{k}}(\omega)]^2}.
\end{equation}
%
Dla ukadu nieoddziaujcych elektronw ($\Sigma=0$) funkcja spektralna skada si z delt Diraca w pooeniach,
ktre odpowiadaj energiom $\omega_{\bm{k}}$.
Cz rzeczywista energii wasnej powoduje przesunicie energii elektronw
%
\begin{equation}
\varepsilon_{\bm{k}}=\omega_{\bm{k}}+\Sigma_{\bm{k}}(\varepsilon_{\bm{k}}),
\label{e_k}
\end{equation}
%
natomiast cz urojona powoduje poszerzenie pikw, co zwizane jest z redukcj czasu ycia stanw elektronowych.
Jeeli cz urojona powoduje tylko niewielkie zaburzenie, istnieje jednoznaczna relacja midzy stanami
elektronw swobodnych i elektronw oddziaujcych. Takie stany elektronowe lub dziurowe, ktre wystpuj blisko energii Fermiego nazywamy {\it kwasiczstkami}.
Przy zblianiu si do poziomu Fermiego czas ycia stanw elektronw ronie ze wzgldu na zmniejszajac si ilo dostpnych stanw do ktrych elektron
moe si rozproszy. 

Blisko energii Fermiego cz rzeczywista energii wasnej zaley liniowo od energii i mona j rozwin do liniowego wyrazu
%
\begin{equation}
\text{Re} \Sigma_{\bm{k}}(\omega)=\text{Re} \Sigma_{\bm{k}}(\omega_{\bm{k}})+(\omega-\omega_{\bm{k}})\frac{\partial\text{Re}\Sigma_{\bm{k}}(\omega)}{\partial\omega}\Big{|}_{\omega=\omega_{\bm{k}}}.
\end{equation}
%
Wprowadzajc czynnik renormalizacyjny, ktry jest miar charakteryzujc spektrum kwasiczstek
%
\begin{equation}
Z_{\bm{k}}=\frac{1}{1-\frac{\partial\text{Re}\Sigma_{\bm{k}}(\omega)}{\partial\omega}\Big{|}_{\omega=\omega_{\bm{k}}}}
\end{equation}
%
moemy zapisa wzr na energi (\ref{e_k}) w postaci
%
\begin{equation}
\varepsilon_{\bm{k}}=\omega_{\bm{k}}+Z_{\bm{k}}\text{Re}\Sigma_{\bm{k}}(\omega_{\bm{k}}).
\end{equation}
%
Rwnie gsto spektraln kwasiczstek mona przybliy wzorem
%
\begin{equation}
A_{\bm{k}}(\omega)=Z_{\bm{k}}\frac{Z_{\bm{k}}\text{Im}\Sigma_{\bm{k}}(\varepsilon_{\bm{k}})}{(\omega-\varepsilon_{\bm{k}})^2+[Z_{\bm{k}}\text{Im}\Sigma_{\bm{k}}(\varepsilon_{\bm{k}})]^2},
\end{equation}
% 
ktra ma ksztat linii Lorentza w pooeniu $\varepsilon_{\bm{k}}$, szerokoci $Z_{\bm{k}}\text{Im}\Sigma_{\bm{k}}(\varepsilon_{\bm{k}})$
i amplitudzie $Z_{\bm{k}}$, nazywanej rwnie wag sprektralna kwasiczastek. $Z_{\bm{k}}$ okrela m.in. natenie (amplitud) rozpraszania fotoemisyjnego,
zmian masy efektywnej kwaziczstek, jak rwnie skok w obsadzeniu stanw na powierzchni Fermiego. 
Dla ukadu, w ktrym cz rzeczywista energii wasnej nie zaley od energii $Z_{\bm{k}}=1$, ta niecigo pokrywa si z rozkadem Fermiego-Diraca dla $T=0$.
Energie kwasiczastek, ktre s funkcjami wektorw falowych, okrelaj struktur pasmow materiau.
W ukadach silnie skorelowanych cz gstoci spektralnej przekazywana jest do stanw lecych dalej od poziomu Fermiego
i pojawiaj si dodatkowe struktury (satelity), ktrych nie da si zinterpretowa jako wzbudzenia kwasiczstek.

\section{Teoria perturbacyjna}

Podstawowe podejcie stosowane w teorii pola opiera si na rozwiniciu perturbacyjnym funkcji Greena~\cite{AGD}.
Najwygodniejszym jest tutaj obraz oddziaywania, w ktrym hamiltonian zapisany jest w formie
%
\begin{equation}
H(t)=H_0+V_\text{I}(t),
\end{equation}
%
gdzie pierwszy wyraz opisuje ukad swobodnych elektronw, a drugi jest zalenym od czasu operatorem oddziaywania
%
\begin{equation}
V_\text{I}(t)=\frac{1}{2}\int d\bm{r}\int d\bm{r}'\psi_\text{I}^\dagger(\bm{r},t)\psi_\text{I}^\dagger(\bm{r}',t)v(\bm{r},\bm{r}')
\psi_\text{I}(\bm{r}',t)\psi_\text{I}(\bm{r},t).
\end{equation}
%
Wystpujace w tym wyraeniu operatory pola otrzymujemy przez transformacj
%
\begin{equation}
\psi_\text{I}(\bm{r},t)=e^{iH_0(t-t_0)}\psi(\bm{r})e^{-iH_0(t-t_0)}.
\end{equation}
%
W obrazie oddziaywania, ewolucja stanw opisana jest zalenoci
%
\begin{equation}
|t\rangle=U_\text{I}(t,t_0)|t_0\rangle,
\end{equation}
gdzie operator ewolucji moe by zapisany w postaci szeregu
%
\begin{equation}
U_\text{I}=1+\sum_{n=1}^{\infty}\frac{(-1)^n}{n!}\int_{t_0}^tdt_1...\int_{t_0}^tdt_nT\Big{[}V_\text{I}(t_1)...V_\text{I}(t_n)\Big{]}.
\end{equation}
%
Wykorzystujc ten operator i wprowadzajc oznaczenie $S=U_\text{I}(\infty,-\infty)$
moemy zapisa funkcj Greena w postaci rozwinicia
%
\begin{equation}
G(x,x')=-i\frac{\langle\Phi_0|T[\psi(x)\psi^{\dagger}(x')S]|\Phi_0\rangle}{\langle\Phi_0|S|\Phi_0\rangle},
\end{equation}
%
gdzie $|\Phi_0\rangle$ jest stanem podstawowym dla ukadu nieoddziaujcych elektronw opisanego hamiltonianem $H_0$. 
Wystpujce w tym szeregu wyrazy mona wyrazi przy pomocy funkcji Greena i wyrazw opisujcych oddziaywania kulombowskie.
Prowadzi to do wzoru, ktry mona zapisa w zwartej formie przy pomocy sumy wyznacznikw
%
\begin{equation}
G(x,x')=\sum_{n=0}^\infty i^n\int v(x_1,x_1')...v(x_n,x'_n)\begin{vmatrix}
G_0(x,x') &  G_0(x,x_1)  & \dots & G_0(x,x'_n) \\ 
G_0(x_1,x') & G_0(x_1,x^+_1) & \dots & G_0(x,x'_n) \\
\dots                &  \dots                 &       &\dots \\
G_0(x'_n,x') & G_0(x'_n,x')  & \dots & G_0(x'_n,x'^+_n) \\
\end{vmatrix}.
\end{equation}
%  
Kady z wyrazw rozwinicia mona otrzyma stosujc metod diagramw Feynmana opisan szczegowo w wielu podrcznikach \cite{AGD,FW,martin2}.





\section{Metoda GW}
\label{sec:gw}

Energi wasn mona powiza z funkcj Greena
%
\begin{equation}
\Sigma(x_1,x_2)=i\int dx_3dx_4 G(x_1,x_3)W(x_1,x_4)\Lambda(x_3,x_2,x_4).
\end{equation}
%
$W$ jest ekranowanym potencjaem kulombowskim
%
\begin{equation}
W(x_1,x_2)=\int dx_3\epsilon^{-1}(x_1,x_3)V(\bm{r}_3-\bm{r}_2),
\end{equation}
%
\begin{equation}
\epsilon^{-1}(x_1,x_2)=\frac{\delta V(x_1)}{\delta \phi(x_2)},
\end{equation}
%
gdzie $V$ jest sum potencjau Hartree $V_H$ i potencjau zewntrznego $\phi$.
$\Lambda$ jest funkcj wierzchokow
%
\begin{equation}
\Lambda(x_1,x_2,x_3) = -\frac{\delta G^{-1}(x_1)}{\delta V(x_3)}.
\end{equation}
%



%\section{Teoria dynamicznego redniego pola (DMFT)}
%\label{sec:dmft}

%\section{Kwantowe Monte Carlo (QMC)}
%\label{sec:qmc}

%\bibliographystyle{acm}
%\bibliography{biblio.bib}



\thebibliography{500}


\bibitem{Schrodinger} E. Schr\"{o}dinger, {\it An undulatory theory of the mechanics of atoms and molecules}, Phys. Rev. {\bf 28}, 1049 (1926).

\bibitem{HL} W. Heitler and F. London, {\it Wechselwirkung neutraler Atome und homopolare Bindung nach der Quantenmechanik},
Zeitschrift fr Physik {\bf 44}, 455 (1927). 

\bibitem{hartree28} D. Hartree, {\it The wave mechanics of an atom with a non-coulomb central field. Part I. Theory and methods}, Proc. Cambridge Philos. Soc. {\bf 24}, 89 (1928).

\bibitem{mulliken} R. S. Mulliken, {\it The assignment of quantum numbers for electrons in molecules}, 
Phys. Rev. {\bf 32}, 186 (1928).

\bibitem{JC} H. M. James and A. S. Coolidge, {\it The ground state of the hydrogen molecule}, J. Chem. Phys. {\bf 1}, 825 (1933).

\bibitem{fermi26} E. Fermi, {\it Zur Quantelung des idealen einatomigen Gases}, Z. Physik {\bf 36}, 902 (1926).

\bibitem{Dirac26} P. A. M. Dirac, {\it On the theory of quantum mechanics}, Proc. Roy. Soc. Lond. A {\bf 112}, 661 (1926).

\bibitem{Pauli25} W. Pauli, Z. Physik {\bf 31}, 765 (1925).
 
\bibitem{Bloch} F. Bloch, {\it ber die Quantenmechanik der Elektronen in Kristallgittern}, Z. Phys. {\bf 52}, 555 (1928).

\bibitem{peierls} R. Peierls, {\it Zur Theorie der galvanomagnetischen Effekte}, Z. Phys. {\bf 53}, 255 (1929). 

\bibitem{Wilson} A. H. Wilson, {\it The theory of electronic semi-conductors}, Proc. R. Soc. Lond. A {\bf 133}, 458 (1931). 

\bibitem{fock30} V. Fock, {\it Naherungsmethode zur Losung des quantenmechanischen Mehrkorperproblems}, Z. Physik {\bf 61}, 126 (1930).
  
\bibitem{slater30} J. C. Slater, {\it Note on Hartree's method}, Phys. Rev. {\bf 35}, 210 (1930).

\bibitem{slater51} J. C. Slater, {\it A simplification of the Hartree-Fock method}, Phys. Rev. {\bf 81}, 385 (1951).

\bibitem{wigner34} E. P. Wigner, {\it On the interactions of electrons in metals}, Phys. Rev. {\bf 46}, 1002 (1934).

\bibitem{GB} M. Gellman and K. A. Brueckner, {\it Correlation energy of an electron gas at high-density},
Phys. Rev. {\bf 106}, 364 (1957).

\bibitem{wigner33} E. Wigner and F. Seitz, {\it On the constitution of metallic sodium}, Phys. Rev. {\bf 43}, 804 (1933).

\bibitem{slater37} J. C. Slater, {\it Wave functions in a periodic potential}, Phys. Rev. {\bf 51}, 846 (1937).

\bibitem{K47} J. Korringa, {\it On the calculation of the energy of a Bloch wave in a metal}, Physica {\bf 13}, 392 (1947).

\bibitem{KR54} W. Kohn and N. Rostoker, {\it Solution of the Schr\"{o}dinger equation in periodic
lattices with an application to metallic lithium}, Phys. Rev. {\bf 94}, 1111 (1954).

\bibitem{herring40} C. Herring, {\it A new method for calculating wave functions in crystals}, Phys. Rev. {\bf 57}, 250 (1940).

\bibitem{Antoncik} E. Antoncik, {\it A new formulation of the method of nearly free electrons}, Czech. J. Phys. {\bf 4}, 439 (1954).

\bibitem{KP} J. C. Philips and L. Kleiman, {\it New method for calculating wave functions in crystals and molecules}, Phys. Rev. B {\bf 116}, 287 (1959).

\bibitem{kohn64} P. Hohenberg and W. Kohn, {\it Inhomogeneous electron gas}, Phys. Rev. {\bf 136}, 864 (1964).

\bibitem{kohn65} W. Kohn and L. J. Sham, {\it Self-consistent equations including exchange and correlation effects}, Phys. Rev. {\bf 140}, 1133 (1965).

\bibitem{CeperleyAlder80} D. M. Ceperley and B. J. Alder, {\it Ground state of the electron gas by a stochastic method},
Phys. Rev. Lett. {\bf 45}, 566 (1980).

\bibitem{PZ} J. P. Perdew and A. Zunger, {\it Self-interaction correction to density-functional approximations for many-electron systems},
Phys. Rev. B {\bf 23}, 5048 (1981).

\bibitem{VWN} S. Vosko, L. Wilk, and M. Nusair, {\it Accurate spin-dependent electron liquid correlation energies for local spin density calculations: a critical analysis}, Can. J. Phys. {\bf 58}, 1200 (1983).

\bibitem{Langreth83} D. C. Langreth and M. J. Mehl, {\it Beyond the local-density approximation in calculations of ground-state electronic properties}, Phys. Rev. B {\bf 28}, 1809 (1983).

\bibitem{Pardew86} J. P. Perdew and Y. Wang, {\it Accurate and simple density functional for the electronic exchange energy: generalized gradient approximation}, Phys. Rev. B {\bf 33}, 8800 (1986).

\bibitem{Becke88} A. D. Becke, {\it Density-functional exchange-energy approximation with correct asymptotic behavior},
Phys. Rev. A {\bf 38}, 3098 (1988).

\bibitem{Andersen75} O. K. Andersen, {\it Linear methods in band theory}, Phys. Rev. B {\bf 12}, 3060 (1975).

\bibitem{HSC} D. R. Hamann, M. Schl\"{u}ter, and C. Chiang, {\it Norm-conserving pseudopotentials}, Phys. Rev. Lett. {\bf 43}, 1494 (1979).

\bibitem{BHS} G. B. Bachelet, D. R. Hamann, and M. Schl\"{u}ter, {\it Pseudopotentials that work: from H to Pu}, Phys. Rev. B {\bf 26}, 4199 (1982). 

\bibitem{Vanderbilt90} D. Vanderbilt, {\it Soft self-consistent pseudopotentials in a generalized eigenvalue formalism}, Phys. Rev. B {\bf 41}, 7892 (1990).

\bibitem{jones} R. O. Jones and O. Gunnarsson, {\it The density functional formalism, its applications and prospects}, Rev. Mod. Phys. {\bf 61}, 689 (1989).

\bibitem{payne} M. C. Payne, M. P. Teter, D. C. Allan, T. A. Arias, 
                and J. D. Joannopoulos, {\it Iterative minimization techniques for ab initio total-energy calculations: molecular dynamics and conjugate gradients},   
                Rev. Mod. Phys. {\bf 64}, 1045 (1992).
                
\bibitem{parlinski} K. Parlinski, Z. Q. Li, and Y. Kawazoe, {\it First-principles determination of the soft mode in cubic ZrO$_2$}, 
                    Phys. Rev. Lett. {\bf 78}, 4063 (1997).                
                
\bibitem{baroni}  S. Baroni, S. Gironcoli, A. Dal Corso, and P. Giannozzi, {\it Phonons and related crystal properties from density-functional perturbation theory}, 
                  Rev. Mod. Phys. {\bf 73}, 515 (2001).

\bibitem{martin} R. M. Martin, {\it Electronic structure. Basic theory and practical methods}, Cambridge University Press, 2010.

\bibitem{peierls} N. F. Mott and R. Peierls, {\it Discussion of the paper by de Boer and Verwey}, Proc. Phys. Soc. (London) {\bf A49}, 72 (1937).
               
\bibitem{mott} N. F. Mott, {\it The basis of the electron theory of metals, with special reference to the transition metals}, Proc. Phys. Soc. (London) {\bf A62}, 416 (1949).

\bibitem{hubbard} J. Hubbard, {\it Electron correlations in narrow energy bands}, Proc. Roy. Soc. (London) {\bf 276}, 238 (1963).

\bibitem{terakura} K. Terakura, T. Oguchi, A. R. Williams, and J. K\"{u}bler, {\it Band theory of insulating transition-metal monoxides: Band-structure calculations},
                  Phys. Rev. B {\bf 30}, 4734 (1984).

\bibitem{becke93} A. D. Becke, {\it A new mixing of Hartree-Fock and local density-functional theories}, J. Chem. Phys. {\bf 98}, 1372 (1993).                   
    
              
\bibitem{anisimov} V. I. Anisimov, J. Zaanen, and O. K. Andersen, {\it Band theory and Mott insulators: Hubbard U instead of Stoner I},
                   Phys. Rev. B {\bf 44}, 943 (1991).

\bibitem{czyzyk} M. T. Czy\.{z}yk and G. A. Sawatzky, {\it Local-density functional and on-site correlations: The electronic structure of La$_2$CuO$_4$ and LaCuO$_3$}, Phys. Rev. B {\bf 49}, 14211 (1994).

\bibitem{orbital1} A. I. Liechtenstein, V. I. Anisimov, and J. Zaanen, {\it Density-functional theory and strong interactions: orbital ordering in Mott-Hubbard insulators}, Phys. Rev. B {\bf 52}, R5467 (1995).
                  
\bibitem{orbital2} T. Mizokawa and A. Fujimori, {\it Electronic structure and orbital ordering in perovskite-type 3d transition-metal oxides studied by Hartree-Fock band-structure calculations}, Phys. Rev. B {\bf 54}, 5368 (1996).

\bibitem{orbital3} V. I. Anisimov, F. Aryasetiawan and A. I. Lichtenstein, {\it First-principles calculations of the electronic structure and spectra of strongly correlated systems: the LDA+U method}, J. Phys.: Cond. Mat. {\bf 9}, 767 (1997).

\bibitem{dudarev} S. L. Dudarev, G. A. Botton, S. Y. Savrasov, C. J. Humphreys, A. P. Sutton, {\it Electron-energy-loss spectra and the structural stability of nickel oxide: an LSDA+U study}, Phys. Rev. B {\bf 57}, 1505 (1998).

%\bibitem{Pu-LDAU} S. Y. Savrasov and G. Kotliar, {\it Ground state theory of $\delta$Pu}, Phys. Rev. Lett. {\bf 84}, 3670 %(2000).                                     

\bibitem{Georges} A. Georges, G. Kotliar, W. Krauth, and M. J. Rozenberg, {\it Dynamical mean-field theory of strongly correlated fermion systems and the limit of infinite dimensions}, Rev. Mod. Phys. {\bf 68}, 13 (1996).

\bibitem{BO} M. Born and J. R. Oppenheimer, {\it On the quantum theory of molecules}, Ann. Physik {\bf 84}, 457 (1927).    

\bibitem{Koopman} T. Koopmans, Physica {\bf 1}, 104 (1934).

\bibitem{GTO} S. F. Boys, {\it Electron wave functions I. A general method for calculation for the stationary states of any molecular system}, Proc. Roy. Soc. London {\bf 200}, 542 (1950).

\bibitem{MP} H. J. Monkhorst and J. D. Pack, {\it Special points for Brillouin-zone integrations}, Phys. Rev. B {\bf 13}, 5188 (1976).

\bibitem{thomas} L. H. Thomas, {\it The calculations of atomic fields}, Proc. Cambridge Phil. Roy. Soc. {\bf 23}, 542 (1927). 

\bibitem{fermi1927} E. Fermi, {\it Un metodo statistico per la determinazione di alcune priopriet dell'atomo}, Rend. Accad. Naz. Lincei. {\bf 6}, 602 (1927).

\bibitem{dirac} P. A. M. Dirac, {\it Note on exchange phenomena in the Thomas-Fermi atom}, Proc. Cambridge Phil. Roy. Soc. {\bf 26}, 376 (1930). 

\bibitem{janak} J. F. Janak, {\it Proof that $\partial E/\partial n_i=\varepsilon_i$ in density-functional theory}, Phys. Rev. B {\bf 18}, 7165 (1977).

\bibitem{PW91} J. P. Perdew and Y. Wang, {\it Accurate and simple representation of the electron-gas
correlation energy}, Phys. Rev. B {\bf 45}, 13244 (1992). 

\bibitem{Pardew92} J. P. Perdew, J. A. Chevary, S. H. Vosko, K. A. Jackson, M. R. Pederson, D. J. Singh, and C. Fiolhais,
{\it Atoms, molecules, solids, and surfaces: Applications of the generalized gradient approximation for exchange and correlation},
Phys. Rev. B {\bf 46}, 6671 (1992).

\bibitem{PBE}   J. P. Perdew, K. Burke, and M. Ernzerhof, {\it Generalized gradient approximation made simple},
                   Phys. Rev. Lett.  {\bf 77}, 3865 (1996). 
                   
\bibitem{Hellmann} H. Hellmann, {\it Einfhrung in die Quantenchemie}, Leipzig, Franz Deuticke, 1937.

\bibitem{Feynman} R. Feynman, {\it Forces in molecules}, Phys. Rev. {\bf 56}, 340 (1939).


\bibitem{Blochl} P. E. Bl\"{o}chl, {\it Projector augmented-wave method}, Phys. Rev. B {\bf 50}, 17953 (1994). 

\bibitem{Vasp}  G. Kresse and J. Furthm\"{u}ller, {\it Efficiency of ab-initio total energy calculations for metals and semiconductors using a plane-wave basis set}, Comput. Mater. Sci. {\bf 6}, 15 (1996).


\bibitem{PawVasp}  G. Kresse and J. Joubert, {\it From ultrasoft pseudopotentials to the projector augmented-wave method}, Phys. Rev. B {\bf 59}, 1758 (1999).
                               
\bibitem{FeSe} A. Ptok, K. J. Kapcia, P. Piekarz, and A. M. Ole, {\it The ab initio study of unconventional
superconductivity in CeCoIn$_5$ and FeSe}, New, J. Phys. {\bf 19}, 063039 (2017).

\bibitem{QE} P. Giannozzi {\it et al.}, J. Phys.: Condens. Matter {\bf 21}, 395502 (2009).

\bibitem{STO1} J. C. Slater, {\it Atomic shielding constants}, Phys. Rev. {\bf 36}, 57 (1930).

\bibitem{STO2} J. C. Slater, {\it Analytic atomic wave function}. Phys. Rev. {\bf 42}, 33 (1932).

\bibitem{Moruzzi77} V. L. Moruzzi, A. R. Williams, and J. F. Janak, {\it Local density theory of metallic cohesion}, Phys. Rev. B {\bf 15}, 2854 (1977).

\bibitem{CPA1} G. M. Stocks, W. M. Temmerman, and B. L. Gyorffy, {\it Complete solution of the Korringa-Kohn-Rostocker coherent-potential-approximation equations: Cu-Ni alloys}, Phys. Rev. Lett. {\bf 41}, 339 (1978).

\bibitem{CPA2} J. S. Faulkner and G. M. Stocks, {\it Calculating properties with the coherent-potential approximation}, Phys. Rev. B {\bf 21}, 3222 (1980).

\bibitem{singh91} D. Singh, {\it Ground-state properties of lanthanum: Treatment of extended-core states}, Phys. Rev. B 43, 6388 (1991).

\bibitem{kummel} S. K\"{u}mmel and L. Kronik, Rev. Mod. Phys. {\bf 80}, 3 (2008).

\bibitem{Sharp} R. T. Sharp and G. K. Horton, {\it A variational approach to the unipotential many-electron problem}, Phys. Rev. {\bf 90}, 317 (1953).

\bibitem{Talman} J. D. Talman and W. F. Shadwick, {\it Optimized effective atomic central potential}, Phys. Rev. A {\bf 14}, 36 (1976). 

\bibitem{Sahni} V. Sahni, J. Gruenebaum, and J. P. Perdew, Phys. Rev. B {\bf 26}, 4371 (1982).

\bibitem{RE} P. Strange, A. Svane, W. M. Temmerman, Z. Szotek, and H. Winter, {\it Understanding the valency of rare earths from first-principles theory}, Nature {\bf 399}, 756 (1999).

\bibitem{svane1990} A. Svane and O. Gunnarsson, Phys. Rev. Lett. {\bf 65}, 1148 (1990).

\bibitem{temmerman2001} W. M. Temmerman, H. Winter, Z. Szotek, and A. Svane, Phys. Rev. Lett. {\bf 86}, 2435 (2001).

\bibitem{PBE0}  J. P. Perdew, M. Ernzerhof, and K. Burke, {\it Rationale for mixing exact exchange with density functional approximations},  
                   J. Chem. Phys {\bf 105}, 9982 (1996).         
  
\bibitem{pople89} J. A Pople, M. Head-Gordon, D. J. Fox, K. Raqhavachari, and L. A. Curtiss, {\it Gaussian-1 theory: a general procedure for prediction of molecular energies}, J. Chem. Phys. {\bf 90}, 5622 (1989).  
                   
\bibitem{HSE} J. Heyd, G. E. Scuseria, and M. Ernzerhof, {\it Hybrid functionals based on a screened Coulomb potential}, J. Chem. Phys. {\bf 118}, 8207 (2003).

\bibitem{Becke1998} A. D. Becke, {\it A new inhomogeneity parameter in density-functional theory}, J. Chem. Phys. {\bf 109}, 2092 (1998).

\bibitem{Becke2006} A. D. Becke and E. R. Johnson, {\it A simple effective potential for exchange}, J. Chem. Phys. {\bf 124}, 221101 (2006). 

\bibitem{Tran2009} F. Tran and P. Blaha, {\it Accurate band gaps of semiconductors and insulators with a semilocal exchange-correlation potential}, 
Phys. Rev. Lett. {\bf 102}, 226401 (2009). 

\bibitem{ELF1} A. D. Becke and K. E. Edgecombe, {\it A simple measure of electron localization in atomic and molecular systems}, J. Chem. Phys. {\bf 92}, 5397 (1990).

\bibitem{ELF2} B. Silvi and A. Savin, {\it Classification of chemical bonds based on topological analysis of electron localization functions}, Nature {\bf 371}, 683 (1994). 

\bibitem{ELF3} J. Sun, B. Xiao, Y. Fang, R. Haunschild, P. Hao, A. Ruzsinszky, G. I. Csonka, G. E. Scuseria, and J. P. Perdew, {\it Density Functionals that Recognize Covalent, Metallic, and Weak Bonds}, Phys. Rev. Lett. {\bf 111}, 106401 (2013). 

\bibitem{metaGGA} J. P. Perdew, S. Kurth, A. Zupan, and P. Blaha, {\it Accurate Density Functional with Correct Formal Properties: A Step Beyond the Generalized Gradient Approximation}, Phys. Rev. Lett. 82, 2544 (1999). 

\bibitem{TPSS} J. Tao, J. P. Perdew, V. N. Staroverov, and G. E. Scuseria, {\it Climbing the density functional ladder: nonempirical metageneralized gradient
approximation designed for molecules and solids}, Phys. Rev. Lett. {\bf 91}, 146401 (2003).


\bibitem{revTPSS} J. P. Perdew, A. Ruzsinszky, G. I. Csonka, L. A. Constantin, and J. Sun, {\it Workhorse semilocal density functional for condensed matter physics and quantum chemistry}, Phys. Rev. Lett. {\bf 103}, 026403 (2009).

\bibitem{SCAN} J. Sun, A. Ruzsinszky, and J. P. Perdew, {\it Strongly constrained and appropriately normed semilocal density functional}, Phys. Rev. Lett. {\bf 115}, 036402 (2015).

\bibitem{Becke1989} A. D. Becke and M. R. Roussel, Phys. Rev. A {\bf 39}, 3761 (1989).

\bibitem{coco1} M. Cococcioni and S. de Gironcoli, {\it Linear response approach to the calculation of the effective interaction parameters
in the LDA+U method}, Phys. Rev. B {\bf 71}, 035105 (2005).

\bibitem{coco2} B. Himmetoglu, A. Floris, S. de Gironcoli, and M. Cococcioni, {\it Hubbard-corrected DFT energy functionals: the LDA+U
description of correlated systems}, Int. J. Quant. Chem. {\bf 114}, 14 (2014).

\bibitem{pardew82} J. P. Perdew, R. G. Parr, M. Levy, and J. L. Balduz, {Density-functional theory for fractional particle number: derivative discontinuities of the energy}, Phys. Rev. Lett. {\bf 49}, 1691 (1982).
                   
\bibitem{norman83} M. R. Norman and J. P. Perdew, {\it Simplified self-interaction correction applied to the energy bands of neon and sodium chloride},
Phys. Rev. B {\bf 28}, 2135 (1983).                   

\bibitem{Gap-hyb} A. J. Garza and G. E. Scuseria, {\it Predicting band gaps with hybrid density functionals}, J. Phys. Chem. Lett. {\bf  7}, 4165 (2016).

\bibitem{Mariana} M. Derzsi, P. Piekarz, P. T. Jochym, J. aewski, M. Sternik, A. M. Ole, and K. Parlinski, {\it Effects of Coulomb interaction on the electronic structure and lattice dynamics of the Mott insulator Fe2SiO4 spinel}, Phys. Rev. B {\bf 79}, 205105 (2009).

\bibitem{berry1} R. D. King-Smith and D. Vanderbilt, {\it Theory of polarization of crystalline solids}, Phys. Rev. B {\bf 47}, 1651 (1993).

\bibitem{berry2} R. Resta, {\it Macroscopic polarization in crastalline dielectrics: the geometric phase approach}, Rev. Mod. Phys. {\bf 66}, 899 (1994).

\bibitem{Zak} J. Zak, {\it Berrys phase for energy bands in solids}, Phys. Rev. Lett. {\bf 62}, 2747 (1989).

\bibitem{PCM} R. M. Pick, M. H. Cohen, and R. M. Martin, {\it Microscopic theory of force constants in the adiabatic approximation},
Phys. Rev. B {\bf 1}, 910 (1970).

\bibitem{resta1993} R. Resta, M. Posternak, A. Baldereschi, {\it Towards a quantum theory of polarization in ferroelectrics: 
The case of KNbO$_3$}, Phys. Rev. Lett. {\bf 70}, 1010 (1993).

\bibitem{zhong1994} W. Zhong, R. D. King-Smith, and D. Vanderbilt, {\it Giant LO-TO splittings in perovskite ferroelectrics},
Phys. Rev. Lett. {\bf 72}, 3618 (1994).

\bibitem{grimme2004} S. Grimme, {\it Accurate description of van der Waals complexes by density functional theory including empirical corrections}, 
J. Comp. Chem. {\bf 25}, 1463 (2004). 

\bibitem{grimme2006} S. Grimme, {\it Semiempirical gga-type density functional constructed with a long-range dispersion correction}, J. Comp. Chem. {\bf 27}, 1787 (2006). 

\bibitem{bucko2010} T. Bucko, J. Hafner, S. Lebegue, and J. G. Angyan, {\it Improved description of the structure of molecular and layered crystals: ab initio DFT
calculations with van der Waals corrections}, J. Phys. Chem. A {\bf 114}, 11814 (2010).

\bibitem{grimme2010} S. Grimme, J. Antony, S. Ehrlich, and S. Krieg, {\it A consistent and accurate ab initio parametrization of density functional dispersion correction (DFT-D) for the 94 elements H-Pu}, J. Chem. Phys. {\bf 132}, 154104 (2010). 

\bibitem{grimme2011} S. Grimme, S. Ehrlich, and L. Goerigk, {\it Effect of the damping function in dispersion corrected density functional theory}, J. Comp. Chem. {\bf 32}, 1456 (2011). 

\bibitem{tkatchenko2009} A. Tkatchenko and M. Scheffler, {\it Accurate molecular van der Waals interactions from ground-state electron density and free-atom reference data}, Phys. Rev. Lett. {\bf 102}, 073005 (2009).

\bibitem{tkatchenko2012} A. Tkatchenko, R. A. Di Stasio, R. Car, and M. Scheffler, {\it Accurate and efficient method for many-body van der waals interactions}, Phys. Rev. Lett. {\bf 108}, 236402 (2012).
                       
\bibitem{AGD} A. A. Abrikosov, L. P. Gor'kov, and I. Y. Dzyaloshinskii, {\it Quantum Field Theoretical Methods in Statistical Physics}, Pergamon Press, 1965.                       

\bibitem{FW} A. L. Fetter and J. D. Walecka, {\it Quantum Theory of Many-Prticle Systems}, McGraf-Hill Book Company.
                       
\bibitem{martin2} R. M. Martin, L. Reining, and D. M. Ceperley, {\it Interacting Electrons. Theory and Computational Approaches},  Cambridge University Press, 2016.                        
                                          
\end{document}
		     





